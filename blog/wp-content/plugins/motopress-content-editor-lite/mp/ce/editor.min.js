(function(v){function s(){var m={},d={};["content","motopresscodecontent","motopresscecontent"].forEach(function(a){var b=v.Deferred(),c=b.promise();m[a]=b;d[a]=c});if("4"===tinyMCE.majorVersion)tinyMCE.on("AddEditor",function(a){a.editor.on("init",function(b){b=a.editor.id;var c=a.editor;m.hasOwnProperty(b)&&m[b].resolve(c)})});else tinyMCE.onAddEditor.add(function(a,b){b.onInit.add(function(a){var b=a.editorId;m.hasOwnProperty(b)&&m[b].resolve(a)})});return d}window.CE=window.CE||{};window.IframeCE=
{};window.MP={Loader:function(){var m=[],d={};return{add:function(a,b){m.push(b);d[a]=m.length-1},execSingle:function(a){if(void 0!==d[a])m[d[a]]()},execAll:function(){for(var a=m.length,b=0;b<a;b++)if("function"===typeof m[b])m[b]()}}}(),Error:{terminate:function(){jQuery("html").css({overflow:"",paddingTop:32});jQuery("body > #wpadminbar").prependTo("#wpwrap > #wpcontent");var m=jQuery("#motopress-content-editor");m.siblings(".motopress-hide").removeClass("motopress-hide");jQuery("#wpwrap").height("");
var d=jQuery("#motopress-preload");d.hide();d=d.children("#motopress-error");d.find("#motopress-system").prevAll().remove();d.hide();m.hide();jQuery(window).trigger("resize");window.location.href=motopressCE.postData.viewUrl},log:function(m,d){d=void 0!==d&&d;console.group("CE error");console.warn("Name: "+m.name);console.warn("Message: "+m.message);m.hasOwnProperty("fileName")&&console.warn("File: "+m.fileName);m.hasOwnProperty("lineNumber")&&console.warn("Line: "+m.lineNumber);console.warn("Browser: "+
navigator.userAgent);console.warn("Platform: "+navigator.platform);console.log(m);console.groupEnd();var a=jQuery("#motopress-preload > #motopress-error"),b=m.name+": "+m.message+".";m.hasOwnProperty("fileName")&&(b+=" "+m.fileName);m.hasOwnProperty("lineNumber")&&(b+=":"+m.lineNumber);a.find("#motopress-system").before(jQuery("<p />",{text:b}));a.show();d&&jQuery("#motopress-preload").stop().show()}}};jQuery(document).ready(function(m){m("#motopress-knob").knob({draw:function(){var d=this.angle(this.cv),
a=this.startAngle,b=this.startAngle,c=b+d;this.g.lineWidth=this.lineWidth;this.o.cursor&&(b=c-.3)&&(c+=.3);this.o.displayPrevious&&(d=this.startAngle+this.angle(this.v),this.o.cursor&&(a=d-.3)&&(d+=.3),this.g.beginPath(),this.g.strokeStyle=this.pColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,a,d,!1),this.g.stroke());this.g.beginPath();this.g.strokeStyle=this.o.fgColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,b,c,!1);this.g.stroke();this.g.lineWidth=2;this.g.beginPath();this.g.strokeStyle=
this.o.fgColor;this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+1+2*this.lineWidth/3,0,2*Math.PI,!1);this.g.stroke();return!1}});m("#motopress-system").children("#motopress-browser").text("Browser: "+navigator.userAgent).end().children("#motopress-platform").text("Platform: "+navigator.platform);m("#motopress-terminate").on("click",function(){MP.Error.terminate()});m("#motopress-preload").show();motopressCE.tinyMCEInited=s();mpceRunEditor()})})(jQuery);
function mpceRunEditor(){try{(function(){function s(d,a,b){a in d?Object.defineProperty(d,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[a]=b;return d}function m(d){m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return m(d)}(function(d){CE.EventDispatcher={};var a=[],b=[],c=[],e=function(){var a=[],b={};return{add:function(c,e){this.exists(c)||
a.push(c);b[c]=e},exists:function(b){return-1!==d.inArray(b,a)},getByName:function(a){return b[a]}}}(),f=function(a,b){var c=a[0],d=a[1];"undefined"===typeof b&&(b=e.getByName(c));can.isFunction(d)&&d(b)};CE.EventDispatcher.Dispatcher=can.Construct.extend({addSubscriber:function(b){a.push(b);return b},deleteSubscriber:function(b){b=a.indexOf(b);0<=b&&a.splice(b,1)},addListener:function(a,c){var d=[a,c];e.exists(a)?f(d):b.push(d);return d},deleteListener:function(a){a=b.indexOf(a);0<=a&&b.splice(a,
1)},dispatch:function(c,e){if(!(e instanceof CE.EventDispatcher.Event))throw Error("event must be type of CE.EventDispatcher.Event");this.isPrevented(c)?this.removeFromPrevented(c):(can.each(a,function(a){if(void 0!==a){a=a.getSubscribedEvents();for(var b=0;b<a.length;b++)for(var f=d.makeArray(a[b][0]),r=d.makeArray(a[b][1]),l=0;l<f.length;l++)if(f[l]===c)for(var p=0;p<r.length;p++)if(can.isFunction(r[p]))r[p](e)}}),can.each(b,function(a){a&&a[0]===c&&f(a,e)}))},dispatchOnce:function(a,b){this.dispatch(a,
b);e.add(a,b)},prevent:function(a){-1===d.inArray(a,c)&&c.push(a)},isPrevented:function(a){return-1!==d.inArray(a,c)},removeFromPrevented:function(a){c=d.grep(c,function(b){return b!==a})},clearPrevents:function(){c=[]}},{})})(jQuery);(function(d){CE.EventDispatcher.Subscriber=can.Construct.extend({},{getSubscribedEvents:function(){throw Error("Must be implemented in sub-class!");}})})(jQuery);(function(d){CE.EventDispatcher.Event=can.Construct.extend({NAME:null},{getEventName:function(){return this.constructor.NAME}})})(jQuery);
(function(d){var a=[],b=[];CE.IframeEventStorage=can.Construct.extend({storeSubscriber:function(b){a.push(b)},storeListener:function(a){b.push(a)},getSubscribers:function(){return a},getListeners:function(){return b}},{})})(jQuery);(function(d){can.Construct("MP.Editor",{myThis:null,eventPrefix:"MPCE-",on:function(a,b){a=this.prepareEventName(a);d(window).on(a,b)},one:function(a,b){a=this.prepareEventName(a);d(window).one(a,b)},onIfr:function(a,b){a=this.prepareEventName(a);CE.Iframe.window.jQuery(CE.Iframe.window).on(a,
b)},oneIfr:function(a,b){a=this.prepareEventName(a);CE.Iframe.window.jQuery(CE.Iframe.window).one(a,b)},trigger:function(a,b){a=this.prepareEventName(a);d(window).trigger(a,b)},triggerIfr:function(a,b){a=this.prepareEventName(a);CE.Iframe.window.jQuery(CE.Iframe.window).trigger(a,b)},triggerEverywhere:function(a,b){this.trigger(a,b);this.triggerIfr(a,b)},prepareEventName:function(a){return a.split(" ").map(function(a){return MP.Editor.eventPrefix+a}).join(" ")}},{loaded:!1,opened:!1,preloader:null,
flash:null,utils:null,settings:null,lang:null,iframeControl:null,init:function(){MP.Editor.myThis=this;new MP.Preloader(d("#motopress-preload"));new MP.Flash(d("#motopress-flash"));new MP.Utils;new MP.Settings;new MP.Language;new CE.PresetSaveModal(d("#motopress-ce-save-preset-modal"));new CE.SaveObjectModal(d("#motopress-ce-save-object-modal"));new CE.Panels.Navbar(d(".motopress-content-editor-navbar"),{PageSettings:CE.Settings.Page});new CE.PreviewDevice(d("#motopress-content-editor-preview-device-panel"));
new CE.StyleModeSwitcher(CE.StyleModeSwitcher.DESKTOP);new CE.ResponsiveSwitcher(d("#mpce-responsive-switcher"),{switcher:CE.StyleModeSwitcher});new CE.ImageLibrary;new CE.WPGallery;new CE.WPMedia;new CE.WPAudio;new CE.WPVideo;this._initIframe();new CE.CodeModal(d("#motopress-code-editor-modal"));MP.Preloader.myThis.load(MP.Editor.shortName);d(window).on("beforeunload",this.proxy("beforeunload"));this.open()},_initIframe:function(){MP.Editor.one("SceneInited",this.onSceneInited);var a=d("<iframe />",
{src:motopressCE.postData.ceUrl,id:"motopress-content-editor-scene","class":"motopress-content-editor-scene mpce-device-mode-desktop",name:"motopress-content-editor-scene",style:"min-width: 100% !important;"});CE.Panels.Navbar.myThis.editorWrapperEl.html(a);this.iframeControl=new CE.Iframe(a)},onSceneInited:function(){new CE.WidgetsLibrary({library:motopressCE.settings.library});new CE.ObjectTemplatesLibrary(motopressCE.settings.objectTemplatesLibrary);new CE.Panels.DialogsManager;new CE.Panels.SettingsDialog(d("#motopress-dialog"));
new CE.Panels.LayoutChooserDialog(d("#mpce-layout-chooser"),{layouts:motopressCE.settings.rowLayouts});new CE.Panels.TemplateChooserDialog(d("#mpce-template-chooser"),{});new CE.Panels.WidgetsDialog(d("#mpce-widgets-panel"),{library:d.extend({},CE.WidgetsLibrary.myThis.getLibrary()),grid:d.extend({},CE.WidgetsLibrary.myThis.getGrid())});new CE.Panels.PageDialog(d("#mpce-page-dialog"),{});new CE.Panels.HistoryDialog(d("#mpce-history-dialog"),{})},load:function(){this.loaded=!0;MP.Editor.triggerEverywhere("EditorLoad")},
unload:function(){this.loaded=!1;MP.Editor.trigger("EditorUnLoad")},reloadScene:function(a){CE.Iframe.window.MPCESceneStatus="pending";this.iframeControl.destroy();var b=CE.Iframe.window.location.href,b=MP.Utils.removeParamFromUrl(b,"_wpnonce"),b=MP.Utils.addParamToUrl(b,"_wpnonce",a);CE.Iframe.window.location.href=b;this.iframeControl=new CE.Iframe(d("#motopress-content-editor-scene"))},open:function(){this.opened=!0;d("body").addClass("motopress-editor-open");MP.Editor.trigger("EditorOpen")},close:function(){var a;
a="draft"===CE.Settings.Page.attr("status")?motopressCE.postData.previewUrl:motopressCE.postData.viewUrl;window.location.href=a},redirect:function(a){MP.Preloader.myThis.show();window.location.href=a},isOpen:function(){return this.opened},beforeunload:function(){if(IframeCE.SceneState&&IframeCE.SceneState.isContentChanged())return!0}})})(jQuery);CE.Settings={};CE.Settings.Page=new can.Map({title:motopressCE.postData.settings.page.title,hideTitle:motopressCE.postData.settings.page.hideTitle,template:motopressCE.postData.settings.page.template,
status:motopressCE.postData.settings.page.status});(function(d){MP.Preloader=can.Control.extend({myThis:null},{stages:{Navbar:!1,Language:!1,Iframe:!1,DragDrop:!1,Editor:!1},loaded:0,step:null,knob:null,init:function(){MP.Preloader.myThis=this;this.step=Math.round(100/Object.keys(this.stages).length*100)/100;this.knob=this.element.find("#motopress-knob");this.set()},reopen:function(){for(var a in this.stages)"Navbar"===a||"Language"===a?delete this.stages[a]:this.stages[a]=!1},show:function(){this.loaded=
0;this.set();this.element.stop().show()},hide:function(){this.element.fadeOut("slow");this.loaded=100;MP.Flash.showMessage()},load:function(a){this.stages.hasOwnProperty(a)&&!this.stages[a]&&(this.stages[a]=!0,this.loaded+=this.step,this.set())},set:function(){this.knob.val(this.loaded).trigger("change")}})})(jQuery);(function(d){var a={};MP.Flash=can.Control.extend({myThis:null,setFlash:function(a,c,e){e||(e=parent.MP.Utils.uniqid());var d=MP.Flash.myThis.create();"undefined"===typeof c&&(c="warning");
var g="";switch(c){case "info":g="alert-info";break;case "success":g="alert-success";break;case "error":g="alert-error"}g.length&&d.addClass(g);a.length&&d.children("span").html(a);d.attr("data-id",e);return e},showMessage:function(){MP.Flash.myThis.element.children(".alert:not([data-shown])").each(function(){var b=d(this),c=b.attr("data-id");b.show().mpalert();b.attr("data-shown","");MP.Flash.closeAlert(c);var e=setTimeout(function(){MP.Flash.closeAlert(c)},1E4);a[c]={element:b,t_id:e}})},closeAlert:function(b){var c=
void 0!==a[b]?a[b]:null;c&&(c.element.mpalert("close"),clearTimeout(c.t_id),delete a[b])}},{alertEl:d("<div />",{"class":"alert fade in",style:"display: none;"}),closeEl:d("<div />",{"class":"motopress-close motopress-icon-remove","data-dismiss":"alert"}),messageEl:d("<span />"),create:function(){return this.alertEl.clone().append(this.closeEl.clone(),this.messageEl.clone()).appendTo(this.element)},init:function(){MP.Flash.myThis=this}})})(jQuery);(function(d){MP.Utils=can.Construct({validationError:d("<div />",
{"class":"motopress-validation-error"}),tbStyle:null,wpFrontEndEditorEvents:[],strtr:function(a,b,c){if("object"===m(b)){c="";for(var e=0;e<a.length;e++)c+="0";var d=0,d=-1,e="",g;for(g in b)for(d=0;-1!=(d=a.indexOf(g,d));)if(0!=parseInt(c.substr(d,g.length)))d+=1;else{for(var h=0;h<b[g].length;h++)e+="1";c=c.substr(0,d)+e+c.substr(d+g.length,c.length-(d+g.length));a=a.substr(0,d)+b[g]+a.substr(d+g.length,a.length-(d+g.length));d=d+b[g].length+1;e=""}return a}for(g=0;g<b.length;g++)a=a.replace(new RegExp(b.charAt(g),
"g"),c.charAt(g));return a},uniqid:function(a,b){"undefined"==typeof a&&(a="");var c,e=function(a,b){a=parseInt(a,10).toString(16);return b<a.length?a.slice(a.length-b):b>a.length?Array(1+(b-a.length)).join("0")+a:a};this.php_js||(this.php_js={});this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random()));this.php_js.uniqidSeed++;c=a+e(parseInt((new Date).getTime()/1E3,10),8);c+=e(this.php_js.uniqidSeed,5);b&&(c+=(10*Math.random()).toFixed(8).toString());return c},version_compare:function(a,
b,c){this.php_js=this.php_js||{};this.php_js.ENV=this.php_js.ENV||{};var e=0,d=0,g=0,h={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},e=function(a){a=(""+a).replace(/[_\-+]/g,".");a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return a.length?a.split("."):[-8]},k=function(a){return a?isNaN(a)?h[a]||-7:parseInt(a,10):0};a=e(a);b=e(b);d=Math.max(a.length,b.length);for(e=0;e<d;e++)if(a[e]!=b[e])if(a[e]=k(a[e]),b[e]=k(b[e]),a[e]<b[e]){g=-1;break}else if(a[e]>b[e]){g=1;break}if(!c)return g;
switch(c){case ">":case "gt":return 0<g;case ">=":case "ge":return 0<=g;case "<=":case "le":return 0>=g;case "==":case "=":case "eq":return 0===g;case "<>":case "!=":case "ne":return 0!==g;case "":case "<":case "lt":return 0>g;default:return null}},inObject:function(a,b){var c=!1,e;for(e in b)if(b[e].toLowerCase()==a.toLowerCase()){c=!0;break}return c},removeByValue:function(a,b){return-1!==b.indexOf(a)?(b.splice(b.indexOf(a),1),!0):!1},doSortSelectByText:function(a){if(a.children("optgroup").length)a.children("optgroup").each(function(){var a=
d.makeArray(d(this).children("option")).sort(function(a,b){return d(a).text()>d(b).text()?1:d(a).text()<d(b).text()?-1:0});d(this).empty().html(a)});else{var b=d.makeArray(a.children("option")).sort(function(a,b){return d(a).text()>d(b).text()?1:d(a).text()<d(b).text()?-1:0});a.empty().html(b)}},addParamToUrl:function(a,b,c){var e=a.indexOf("?"),d=a.indexOf("#");e==a.length-1&&(a=a.substring(0,e),e=-1);return(0<d?a.substring(0,d):a)+(0<e?"&"+b+"="+c:"?"+b+"="+c)+(0<d?a.substring(d):"")},removeParamFromUrl:function(a,
b){var c=a.match(new RegExp(b+"\\=([a-z0-9]+)","i"));c&&(c=c[0],0<=a.search("&"+c)?a=a.replace("&"+c,""):0<=a.search("\\?"+c+"&")?a=a.replace("?"+c+"&",""):0<=a.search("\\?"+c)&&(a=a.replace("?"+c,"")));return a},showValidationError:function(a,b){var c=b.next(".motopress-validation-error");c.length&&c.remove();this.validationError.clone().text(a).insertAfter(b)},getScrollbarWidth:function(){var a=window.browserScrollbarWidth;if("undefined"===typeof a){var b=d('<div style="width: 50px; height: 50px; position: absolute; left: -100px; top: -100px; overflow: auto;"><div style="width: 1px; height: 100px;"></div></div>');
d("body").append(b);a=b[0].offsetWidth-b[0].clientWidth;b.remove()}return a},getSpanClass:function(a){for(var b=new RegExp("^("+parent.CE.Iframe.myThis.gridObj.span["class"]+")\\d{1,2}$","i"),c="",e=0;e<a.length;e++)if(b.test(a[e])){c=a[e];break}return c},getSpanNumber:function(a){a=a.match(/\d{1,2}/i);return null!==a?parseInt(a):0},isTheSameElement:function(a,b){return null!==b&&a[0]===b[0]},calcSpanNumber:function(a,b){var c=(a.hasClass("motopress-row-edge")?a:a.find(".motopress-row-edge").first()).children(".motopress-clmn"),
e=0;c.length&&c.each(function(){if(!MP.Utils.isTheSameElement(d(this),b)){var a=MP.Utils.getSpanNumber(MP.Utils.getSpanClass(d(this).prop("class").split(" ")));e+=a}});return e},getEdgeSpan:function(a){a=a.hasClass("motopress-clmn-edge")?a:a.find(".motopress-clmn-edge").first();return a.length?a:null},getEdgeRow:function(a){a=a.hasClass("motopress-row-edge")?a:a.find(".motopress-row-edge").first();return a.length?a:null},detectSpanNestingLvl:function(a){return a.closest(".motopress-row").parent(".motopress-content-wrapper").length?
1:2},detectRowNestingLvl:function(a){return a.parent(".motopress-content-wrapper").length?1:2},setup:function(){var a=navigator.userAgent.toLowerCase();this.Browser={Version:(a.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],Chrome:/chrome/.test(a),Safari:/webkit/.test(a),Opera:/opera/.test(a),IE:/msie/.test(a)&&!/opera/.test(a),Mozilla:/mozilla/.test(a)&&!/(compatible|webkit)/.test(a)}},getEditorActiveMode:function(a){for(var b=/^(tmce|html)-active$/i,c=null,e=0;e<a.length;e++)b.test(a[e])&&(c=
a[e]);return c},addWindowFix:function(){"function"===typeof tb_show&&"function"===typeof tb_remove&&(this.tbStyle=d("<style />",{type:"text/css",text:"#TB_overlay {z-index: 1051;} #TB_window {z-index: 1052;}"}).appendTo("head"))},removeWindowFix:function(){null!==this.tbStyle&&this.tbStyle.remove()},base64_decode:function(a){var b,c,e,d,g,h=0,k=0;d="";var n=[];if(!a)return a;a+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),
d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),e=b<<18|c<<12|d<<6|g,b=e>>16&255,c=e>>8&255,e&=255,64==d?n[k++]=String.fromCharCode(b):64==g?n[k++]=String.fromCharCode(b,c):n[k++]=String.fromCharCode(b,c,e);while(h<a.length);d=n.join("");return d=this.utf8_decode(d)},base64_encode:function(a){var b,c,e,d,g=0,h=0,k="",k=[];if(!a)return a;a=this.utf8_encode(a+"");
do b=a.charCodeAt(g++),c=a.charCodeAt(g++),e=a.charCodeAt(g++),d=b<<16|c<<8|e,b=d>>18&63,c=d>>12&63,e=d>>6&63,d&=63,k[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d);while(g<a.length);k=k.join("");a=a.length%3;return(a?k.slice(0,a-3):
k)+"===".slice(a||3)},utf8_decode:function(a){var b=[],c=0,e=0,d=0,g=0,h=0;for(a+="";c<a.length;)d=a.charCodeAt(c),128>d?(b[e++]=String.fromCharCode(d),c++):191<d&&224>d?(g=a.charCodeAt(c+1),b[e++]=String.fromCharCode((d&31)<<6|g&63),c+=2):(g=a.charCodeAt(c+1),h=a.charCodeAt(c+2),b[e++]=String.fromCharCode((d&15)<<12|(g&63)<<6|h&63),c+=3);return b.join("")},utf8_encode:function(a){if(null===a||"undefined"===typeof a)return"";a+="";var b="",c,e,d=0;c=e=0;for(var d=a.length,g=0;g<d;g++){var h=a.charCodeAt(g),
k=null;128>h?e++:k=127<h&&2048>h?String.fromCharCode(h>>6|192)+String.fromCharCode(h&63|128):String.fromCharCode(h>>12|224)+String.fromCharCode(h>>6&63|128)+String.fromCharCode(h&63|128);null!==k&&(e>c&&(b+=a.slice(c,e)),b+=k,c=e=g+1)}e>c&&(b+=a.slice(c,d));return b},nl2br:function(a,b){return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(b||"undefined"===typeof b?"<br />":"<br>")+"$2")},br2nl:function(a){return a.replace(/<br[^>]*>\s*\r*\n*/g,"\n")},addWpFrontEndEditorFix:function(){var a=
d("#post-preview").data("events");"undefined"!==typeof a&&a.hasOwnProperty("click")&&(a=a.click.slice(),d.each(a,function(a,c){-1!==c.handler.toString().indexOf("wp_fee_redirect")&&(MP.Utils.wpFrontEndEditorEvents.push(c),d("#post-preview").data("events").click.splice(d("#post-preview").data("events").click.indexOf(c),1))}))},removeWpFrontEndEditorFix:function(){this.wpFrontEndEditorEvents.length&&(d.merge(d("#post-preview").data("events").click,this.wpFrontEndEditorEvents),this.wpFrontEndEditorEvents.length=
0)},getTinyMCEVersion:function(){return"undefined"!==typeof tinyMCE?tinyMCE.majorVersion+"."+tinyMCE.minorVersion:!1},fixTabsBaseTagConflict:function(a,b,c){b=d("undefined"===typeof b?document:b);c="undefined"===typeof c?location:c;b.find("base").length&&a.find("ul li a").each(function(){d(this).attr("href",c.href.toString()+d(this).attr("href"))})},getObjectChanges:function(a){function b(b,e){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(a,b){var c=
{},e;for(e in b)if(!a||a[e]!==b[e])if(d.isPlainObject(b[e])){var f=getObjectChanges(a[e],b[e]);d.isEmptyObject(f)||(c[e]=f)}else c[e]=b[e];return c}),moveArrayElement:function(a,b,c){a.splice(c,0,a.splice(b,1)[0])},getEntityTypeByElement:function(a){return MP.EntityType.initByEntity(a)},isSpanWrapper:function(a){return 0!==parent.MP.Utils.getEdgeSpan(a).children(".motopress-row").length},convertClassesToSelector:function(a){return a.split(/\s+/).map(function(a){return"."+a}).join("")},generateUuid:function(){return mpceGenerateUUID4()},
replaceClassInString:function(a,b,c){return c.replace(new RegExp("(^|\\s)("+a+")(\\s|$)","i"),"$1"+b+"$3")},validateCSSClass:function(a){return/^[a-z0-9][-_a-z0-9]*$/.test(a)},getObjectTag:function(a){return a.is("[data-motopress-shortcode]")?a:a.closest("[data-motopress-shortcode]")},findRows:function(a){"undefined"===typeof a&&(a=IframeCE.Scene.myThis.contentWrapper);return a.find(".motopress-row").not('[data-motopress-group]:not([data-motopress-group="mp_grid"]) .motopress-row')}},{})})(jQuery);
(function(d){"object"===("undefined"===typeof exports?"undefined":m(exports))&&"undefined"!==typeof module?module.exports=d():"function"===typeof define&&define.amd?define([],d):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).mpceGenerateUUID4=d()})(function(){return function(){function d(a,b,c){function e(g,k){if(!b[g]){if(!a[g]){var n="function"==typeof require&&require;if(!k&&n)return n(g,!0);if(f)return f(g,!0);n=Error("Cannot find module '"+
g+"'");throw n.code="MODULE_NOT_FOUND",n;}n=b[g]={exports:{}};a[g][0].call(n.exports,function(b){return e(a[g][1][b]||b)},n,n.exports,d,a,b,c)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<c.length;g++)e(c[g]);return e}return d}()({1:[function(d,a,b){var c=[];for(d=0;256>d;++d)c[d]=(d+256).toString(16).substr(1);a.exports=function(a,b){var d=b||0;return[c[a[d++]],c[a[d++]],c[a[d++]],c[a[d++]],"-",c[a[d++]],c[a[d++]],"-",c[a[d++]],c[a[d++]],"-",c[a[d++]],c[a[d++]],"-",c[a[d++]],
c[a[d++]],c[a[d++]],c[a[d++]],c[a[d++]],c[a[d++]]].join("")}},{}],2:[function(d,a,b){var c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(c){var e=new Uint8Array(16);a.exports=function(){c(e);return e}}else{var f=Array(16);a.exports=function(){for(var a=0,b;16>a;a++)0===(a&3)&&(b=4294967296*Math.random()),f[a]=b>>>((a&3)<<3)&255;return f}}},
{}],3:[function(d,a,b){var c=d("./lib/rng"),e=d("./lib/bytesToUuid");a.exports=function(a,b,d){d=b&&d||0;"string"==typeof a&&(b="binary"===a?Array(16):null,a=null);a=a||{};a=a.random||(a.rng||c)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(b)for(var k=0;16>k;++k)b[d+k]=a[k];return b||e(a)}},{"./lib/bytesToUuid":1,"./lib/rng":2}]},{},[3])(3)});(function(d){MP.EntityType=can.Construct({initByEntity:function(a){return 1<a.length&&a.hasClass("motopress-row")?new this(IframeCE.Grid.ENTITIES.PAGE):a.hasClass("motopress-row")?
new this(IframeCE.Grid.ENTITIES.ROW):a.hasClass("motopress-clmn")?new this(IframeCE.Grid.ENTITIES.COLUMN):new this(IframeCE.Grid.ENTITIES.WIDGET)}},{is_row:!1,is_clmn:!1,is_widget:!1,name:"",init:function(a){switch(a){case IframeCE.Grid.ENTITIES.WIDGET:this.is_widget=!0;break;case IframeCE.Grid.ENTITIES.COLUMN:this.is_clmn=!0;break;case IframeCE.Grid.ENTITIES.ROW:this.is_row=!0;break;case IframeCE.Grid.ENTITIES.PAGE:this.is_row=!0}this.name=a}})})(jQuery);(function(d){function a(a){a=MP.Utils.strtr(motopressCE.settings.translations.CEPostLockedTakeOver,
{"%userName%":a,"%sendback%":motopressCE.settings.sendbackText});confirm(a)?(wp.heartbeat.enqueue("mpceForcePostLock",!0),wp.heartbeat.connectNow()):MP.Editor.myThis.redirect(motopressCE.settings.sendback)}d(document).on({"heartbeat-send":function(a,c){c.mpcePostLock=motopressCE.postID},"heartbeat-tick":function(b,c){c.lockingUser&&a(c.lockingUser)}});d(window).one("MPCE-EditorLoad",function(){motopressCE.settings.lockingUser&&a(motopressCE.settings.lockingUser)})})(jQuery);(function(d){CE.ShortcodeAtts=
can.Construct.extend({getAttrsFromElement:function(a){var b={closeType:a.attr("data-motopress-close-type"),id:a.attr("data-motopress-shortcode"),group:a.attr("data-motopress-group"),resize:a.attr("data-motopress-resize")},c=a.attr("data-motopress-parameters");"undefined"!==typeof c&&(b.parameters=c);c=a.attr("data-motopress-styles");"undefined"!==typeof c&&(b.styles=c);a=a.attr("data-motopress-content");"undefined"!==typeof a&&(b.content=a);return new this(b)},setAttsToEl:function(a,b){a.attr({"data-motopress-close-type":b.closeType,
"data-motopress-shortcode":b.id,"data-motopress-group":b.group,"data-motopress-resize":b.resize});b.hasOwnProperty("parameters")&&a.attr("data-motopress-parameters",b.parameters);b.hasOwnProperty("styles")&&a.attr("data-motopress-styles",b.styles);b.hasOwnProperty("content")&&a.attr("data-motopress-content",b.content)}},{id:null,group:null,closeType:null,parameters:{},styles:{},resize:null,content:"",init:function(a){this.id=a.id;var b=CE.WidgetsLibrary.myThis.getObjectById(this.id);b&&(this.group=
b.groupId,this.closeType=b.closeType,this.resize=b.resize);a.hasOwnProperty("parameters")&&(this.parameters=a.parameters);a.hasOwnProperty("styles")&&(this.styles=a.styles);a.hasOwnProperty("content")&&(this.content=a.content)},isGrid:function(){return CE.Shortcode.isGrid(this.group)}})})(jQuery);(function(d){var a=!0,b=[];can.Control("CE.Iframe",{myThis:null,window:null,$window:null,$:null,contents:null,runAndSetAsDependent:function(a){this.runDependentCallback(a);b.push(a)},runDependentCallback:function(a){a(this)},
runDependentCallbacks:function(){if(!a)for(var c=0;c<b.length;c++)this.runDependentCallback(b[c])}},{minWidth:null,gridObj:null,grid:d("<div />",{id:"motopress-ce-grid","class":"mp-container"}),divDisablePlugin:d("<div />",{"class":"motopress-disable-plugin"}),isHeadwayTheme:null,$topBody:d("body"),body:null,sceneContent:null,sceneContainer:null,rowExample:null,wpAttachmentDetails:[],$form:d("form#mpce-form"),init:function(b){CE.Iframe.myThis=this;CE.Iframe.window=this.element[0].contentWindow;a&&
b.addClass("motopress-tmp-iframe-width");CE.Iframe.myThis.gridObj=parent.motopressCE.settings.library.grid;switch(this.detectSceneStatus()){case "pending":this.$topBody.one("MPCESceneDocError",b,CE.Iframe.myThis.proxy(function(a,b){this.showErrorMessage(b)}));this.$topBody.one("MPCESceneDocReady",b,CE.Iframe.myThis.proxy(function(){this.onReady()}));break;case "ready":this.onReady();break;case "error":this.showErrorMessage(CE.Iframe.window.MPCESceneStatus.errorType)}},detectSceneStatus:function(){var a=
"pending";"undefined"!==typeof CE.Iframe.window.MPCESceneStatus&&CE.Iframe.window.MPCESceneStatus.hasOwnProperty("status")&&(a=CE.Iframe.window.MPCESceneStatus.status);return a},destroy:function(){a=!1;try{d(CE.Iframe.window).off("beforeunload.CE.Iframe"),d(parent.window).off("beforeunload.CE.Iframe"),this.deleteEventListeners(),IframeCE.Resizer.myThis._destroy(),IframeCE.InlineEditor._destroy(),CE.Panels.SettingsDialog.myThis._destroy(),CE.Panels.Navbar.myThis._destroy()}catch(b){MP.Settings.debug&&
console.error(b)}this._super()},showErrorMessage:function(a,b){var d={};switch(b){case "nonce":d={name:localStorage.getItem("editorNonceErrorName"),message:localStorage.getItem("editorNonceErrorMessage")};break;default:d={name:localStorage.getItem("editorAccessErrorName"),message:localStorage.getItem("editorAccessErrorMessage")}}MP.Error.log(d)},onReady:function(){CE.Iframe.contents=this.element.contents();CE.Iframe.$=CE.Iframe.window.jQuery;CE.Iframe.$window=CE.Iframe.$(CE.Iframe.window);this.body=
CE.Iframe.contents.find("body");this.$entryContent=this.body.find("#mpce-editable-content-marker").parent();CE.Iframe.$(this.$entryContent).html(decodeURIComponent(this.body.find("#mpce-post-content-template").html()+""));CE.Iframe.contents.find('link[href*="js_composer"]').remove();MP.Utils.addWpFrontEndEditorFix();CE.Iframe.myThis.wpAttachmentDetails=CE.Iframe.window.mpce_wp_attachment_details;this.sceneContent=this.body.find(".motopress-content-wrapper");this.contentSectionExists=this.sceneContent.length;
CE.Panels.Navbar.myThis.onIframeLoad(this.element);this.preventUnload();this.body.find("#wp-motopress-tmp-editor-wrap").hide();this.sceneContent.length||(this.body.append(this.divDisablePlugin),this.isHeadwayTheme?MP.Flash.setFlash(localStorage.getItem("CENeedHeadwayThemeGrid"),"error"):MP.Flash.setFlash(localStorage.getItem("CENeedContentOutput"),"error"));this.element.removeClass("motopress-tmp-iframe-width");var a=this.sceneContent.width();this.body.addClass("motopress-body");this.sceneContent.find("script").remove();
this.sceneContent.wrap('<div class="'+CE.Iframe.myThis.gridObj.span.fullclass+'" />').parent().wrap('<div class="'+CE.Iframe.myThis.gridObj.row["class"]+" "+CE.Iframe.myThis.gridObj.row.edgeclass+' motopress-row" />').parent().wrap('<div id="motopress-container" class="mp-container" />');this.sceneContainer=this.sceneContent.closest("#motopress-container");this.rowExample=this.sceneContainer.children(".motopress-row");var b=this.sceneContainer.parents(),f=b.length-3;b.each(function(a){d(this).addClass("motopress-overflow-visible");
return a<f});b=parseFloat(this.rowExample.css("margin-left"));this.rowExample.attr("data-margin-left",b);this.sceneContent.find("."+CE.Iframe.myThis.gridObj.span.minclass+".motopress-clmn").addClass("motopress-clmn-min");this.setSceneWidth(a);this.unwrapGrid();this.body.prepend(this.grid);this.$topBody.hide(0,this.proxy(function(){this.$topBody.show()}));CE.Iframe.window.mpceRunScene();MP.Editor.triggerIfr("ParentEditorReady")},setSceneWidth:function(a){this.sceneContainer.css("max-width","");a="undefined"!==
typeof a?a:this.sceneContent.width();var b=CE.Iframe.contents.width(),d=parseFloat(this.rowExample.css("margin-left")),g=parseFloat(this.rowExample.css("margin-right"));a=a-d-g;a>b&&(a=b+(d+g));this.sceneContainer.css("max-width",a);this.grid.css("max-width",a)},unwrapGrid:function(a){a&&a.length||(a=this.body);a.find('div[data-motopress-group="mp_grid"]:not(.ce_controls,.motopress-empty)').addBack('div[data-motopress-group="mp_grid"]:not(.ce_controls,.motopress-empty)').each(function(){var a=d(this),
b=a.attr("data-motopress-group"),c=a.attr("data-motopress-shortcode"),h=a.attr("data-motopress-parameters"),k=a.attr("data-motopress-styles"),a=a.children("div");a.attr("data-motopress-group",b);a.attr("data-motopress-shortcode",c);h.length&&a.attr("data-motopress-parameters",h);k.length&&a.attr("data-motopress-styles",k);a.unwrap()})},appendScript:function(a,b){a.appendChild(b)},prependScript:function(a,b){a.insertBefore(b,a.firstChild)},wpLinkCloseCallback:function(a){d(document).on("wplink-close.motopress",
function(b){d(document).off("wplink-close.motopress");a()})},preventUnload:function(){this.body.find("a").on("click",function(a){a.preventDefault()});this.body.find("form").on("submit",function(a){a.preventDefault()});var a=!1;d(window).on("beforeunload.CE.Iframe",function(){a=!0});d(CE.Iframe.window).on("beforeunload.CE.Iframe",function(){if(!a)return localStorage.getItem("postSaveAlert");a=!1})},resizeWindow:function(){IframeCE.Utils.triggerWindowEvent("resize")},setMinWidth:function(){this.element.css("min-width",
this.minWidth)},unsetMinWidth:function(){this.element.css("min-width","")},getRowSlug:function(a){return parent.CE.Iframe.myThis.gridObj.row[1===a?"shortcode":"inner"]},getClmnSlug:function(a,b){var d,g="";parent.CE.Iframe.myThis.gridObj.span.type&&"multiple"===parent.CE.Iframe.myThis.gridObj.span.type?d=parent.CE.Iframe.myThis.gridObj.span[1===a?"shortcode":"inner"][b-1]:(g=" "+parent.CE.Iframe.myThis.gridObj.span.attr+'="'+b+'"',d=parent.CE.Iframe.myThis.gridObj.span[1===a?"shortcode":"inner"]);
return{slug:d,attr:g}},deleteEventListeners:function(){var a=CE.IframeEventStorage.getSubscribers(),b=CE.IframeEventStorage.getListeners(),d;for(d=0;d<a.length;d++)CE.EventDispatcher.Dispatcher.deleteSubscriber(a[d]);for(d=0;d<b.length;d++)CE.EventDispatcher.Dispatcher.deleteListener(b[d])},getContentRootElement:function(){return CE.Iframe.contents.find("body .motopress-content-wrapper:eq(0)")}})})(jQuery);CE.Libraries={};(function(d){CE.Libraries.Events={};CE.Libraries.Events.WidgetTemplateSaved=
parent.CE.EventDispatcher.Event.extend({NAME:"libraries.widget_template_saved"},{widgetTemplate:null,init:function(a){this.widgetTemplate=a},getWidgetTemplate:function(){return this.widgetTemplate}});CE.Libraries.Events.RowTemplateSaved=parent.CE.EventDispatcher.Event.extend({NAME:"libraries.row_template_saved"},{rowTemplate:null,init:function(a){this.rowTemplate=a},getRowTemplate:function(){return this.rowTemplate}});CE.Libraries.Events.PageTemplateSaved=parent.CE.EventDispatcher.Event.extend({NAME:"libraries.page_template_saved"},
{pageTemplate:null,init:function(a){this.pageTemplate=a},getPageTemplate:function(){return this.pageTemplate}})})(jQuery);(function(d){can.Construct("CE.WidgetsLibrary",{myThis:null},{library:null,grid:null,init:function(a){CE.WidgetsLibrary.myThis=this;var b=a.library;this.initWidgets(b.groups);this.grid=d.extend(!0,{},b.grid);this.initLibraryStyles();CE.Iframe.runAndSetAsDependent(this.proxy(function(a){d.isPlainObject(b.globalPredefinedClasses)&&!d.isEmptyObject(b.globalPredefinedClasses)&&(IframeCE.Style.globalPredefinedClasses=
b.globalPredefinedClasses);d.isArray(b.tinyMCEStyleFormats)&&!d.isEmptyObject(b.tinyMCEStyleFormats)&&(IframeCE.InlineEditor.styleFormats=b.tinyMCEStyleFormats)}))},initWidgets:function(a){this.library=d.extend(!0,{},a);d.each(this.library,function(a,c){c.hasOwnProperty("objects")&&d.each(c.objects,function(a,b){b.groupId=c.id})})},initLibraryStyles:function(){var a=this,b;d.each(motopressCE.settings.library.groups,function(c,e){e.hasOwnProperty("objects")&&d.each(e.objects,function(e,g){a.library[c].objects[e].styles=
d.extend(!0,{},IframeCE.Style.props,a.library[c].objects[e].styles);IframeCE.Shortcode.isGrid(c)?(a.library[c].objects[e].styles.margin.sides.splice(2),a.library[c].objects[e].styles.margin["default"].splice(2)):a.library[c].objects[e].styles.margin.regExp=new RegExp("^"+a.library[c].objects[e].styles.margin.classPrefix+"(?:|("+a.library[c].objects[e].styles.margin.sides.join("|")+")-)("+a.library[c].objects[e].styles.margin.values.slice(1).join("|")+")$","i");g.styles.hasOwnProperty("mp_custom_style")&&
g.styles.mp_custom_style.hasOwnProperty("limitation")&&(b=g.styles.mp_custom_style.limitation,d.each(b,function(b,d){a.library[c].objects[e].styles.mp_custom_style.parameters.hasOwnProperty(d)&&delete a.library[c].objects[e].styles.mp_custom_style.parameters[d]}))})})},getLibrary:function(){return this.library},getGrid:function(){return this.grid},getObject:function(a,b){var c;(a=this.getGroup(a))&&a.objects.hasOwnProperty(b)&&(c=a.objects[b]);return c},getObjectById:function(a){var b;d.each(this.library,
function(c,e){d.each(e.objects,function(c,d){if(d.id==a)return b=d,!1});if(b)return!1});return b},getGroup:function(a){var b;this.library.hasOwnProperty(a)&&(b=this.library[a]);return b},getStyleAttrs:function(a,b){return d.extend(!0,{},this.library[a].objects[b].styles)},getPrivateStyleAttrs:function(a,b){return this.getStyleAttrs(a,b).mp_custom_style.parameters},getParametersAttrs:function(a,b){return d.extend(!0,{},this.library[a].objects[b].parameters)},getShortcodeLabel:function(a,b){return this.library[a].objects[b].name},
setAttrs:function(a,b,c,e){"undefined"===typeof e&&(e=!0);a.attr({"data-motopress-close-type":c.closeType,"data-motopress-shortcode":c.id,"data-motopress-group":b,"data-motopress-resize":c.resize});c.hasOwnProperty("content")&&a.attr("data-motopress-content",c.content);if(e){e=c.parameters;if(!d.isEmptyObject(e)){var f={};d.each(e,function(a){f[a]={}});a.attr("data-motopress-parameters",JSON.stringify(f))}b=this.getStyleAttrs(b,c.id);d.extend(!0,b,c.styles,b);if(!d.isEmptyObject(b)){var g={};d.each(b,
function(a){g[a]={}});a.attr("data-motopress-styles",JSON.stringify(g))}}else a.attr("data-motopress-parameters",JSON.stringify(c.parameters)),a.attr("data-motopress-styles",JSON.stringify(c.styles))},getAttrs:function(a,b){var c=this.getObject(a,b),e={closeType:c.closeType,id:c.id,group:a,resize:c.resize},c=c.parameters;if(!d.isEmptyObject(c)){var f={};d.each(c,function(a){f[a]={}});e.parameters=JSON.stringify(f)}c=this.getStyleAttrs(a,e.id);d.extend(!0,c,e.styles,c);if(!d.isEmptyObject(c)){var g=
{};d.each(c,function(a){g[a]={}});e.styles=JSON.stringify(g)}return e},getActualAtts:function(a){var b={closeType:a.attr("data-motopress-close-type"),group:a.attr("data-motopress-group"),id:a.attr("data-motopress-shortcode"),resize:a.attr("data-motopress-resize"),wrapRender:null,parameters:null,styles:null,content:null};"undefined"!==typeof a.attr("data-motopress-wrap-render")&&(b.wrapRender=a.attr("data-motopress-wrap-render"));if("undefined"!==typeof a.attr("data-motopress-parameters")){var c=a.attr("data-motopress-parameters");
b.parameters=JSON.parse(c)}"undefined"!==typeof a.attr("data-motopress-styles")&&(c=a.attr("data-motopress-styles"),b.styles=JSON.parse(c));"undefined"!==typeof a.attr("data-motopress-content")&&(b.content=a.attr("data-motopress-content").replace(/\[\]/g,"["));return b}})})(jQuery);(function(d){can.Construct("CE.ObjectTemplatesLibrary",{myThis:null},{library:{widgets:{list:new can.List,categories:[]},rows:{list:[],categories:[]},pages:{list:[],categories:[]}},init:function(a){CE.ObjectTemplatesLibrary.myThis=
this;this.initLibrary(a)},saveWidget:function(a){a.setId(this.library.widgets.list.length);this.library.widgets.list.push(a);parent.CE.EventDispatcher.Dispatcher.dispatch(CE.Libraries.Events.WidgetTemplateSaved.NAME,new CE.Libraries.Events.WidgetTemplateSaved(a));return this._save()},saveRow:function(a){a.setId(this.library.rows.list.length);this.library.rows.list.push(a);parent.CE.EventDispatcher.Dispatcher.dispatch(CE.Libraries.Events.RowTemplateSaved.NAME,new CE.Libraries.Events.RowTemplateSaved(a));
return this._save()},savePage:function(a){a.setId(this.library.pages.list.length);this.library.pages.list.push(a);parent.CE.EventDispatcher.Dispatcher.dispatch(CE.Libraries.Events.PageTemplateSaved.NAME,new CE.Libraries.Events.PageTemplateSaved(a));return this._save()},addWidgetCategory:function(a){return this.library.widgets.categories.push(a)-1},getWidgets:function(){return this.library.widgets.list},getWidgetCategories:function(){return this.library.widgets.categories},getWidgetById:function(a){return this.library.widgets.list.attr(a)},
addRowCategory:function(a){return this.library.rows.categories.push(a)-1},getRowCategories:function(){return this.library.rows.categories},getRows:function(){return this.library.rows.list},getRowById:function(a){return this.library.rows.list[a]},getPages:function(){return this.library.pages.list},getPageById:function(a){return this.library.pages.list[a]},addPageCategory:function(a){return this.library.pages.categories.push(a)-1},getPageCategories:function(){return this.library.pages.categories},initLibrary:function(a){d.each(a.widgets.list,
this.proxy(function(a,c){c.id=a;var d=CE.WidgetsLibrary.myThis.getObjectById(c.shortcodeId);if(!d)return!0;c.atts=new CE.ShortcodeAtts({id:d.id,group:d.group,content:c.atts.content,parameters:c.atts.parameters,styles:c.atts.styles,closeType:d.closeType,resize:d.resize});this.library.widgets.list.push(new CE.ObjectTemplatesLibrary.WidgetTemplate(c))}));d.each(a.rows.list,this.proxy(function(a,c){c.id=a;this.library.rows.list.push(new CE.ObjectTemplatesLibrary.RowTemplate(c))}));d.each(a.pages.list,
this.proxy(function(a,c){c.id=a;this.library.pages.list.push(new CE.ObjectTemplatesLibrary.PageTemplate(c))}));this.library.widgets.categories=a.widgets.categories;this.library.rows.categories=a.rows.categories;this.library.pages.categories=a.pages.categories},prepareLibraryToSave:function(){return{widgets:{list:d.map(this.library.widgets.list.attr(),function(a){return a.prepareToSave()}),categories:this.library.widgets.categories},rows:{list:d.map(this.library.rows.list,function(a){return a.prepareToSave()}),
categories:this.library.rows.categories},pages:{list:d.map(this.library.pages.list,function(a){return a.prepareToSave()}),categories:this.library.pages.categories}}},_save:function(){var a=new d.Deferred;d.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"html",data:{action:"motopress_ce_save_object_templates",nonce:parent.motopressCE.nonces.motopress_ce_save_object_templates,postID:parent.motopressCE.postID,library:this.prepareLibraryToSave()},success:function(){a.resolve()},error:function(){a.reject()}});
return a.promise()}})})(jQuery);(function(d){can.Construct("CE.ObjectTemplatesLibrary.WidgetTemplate",{},{id:"",name:"",category:"",content:"",shortcodeId:"",groupId:"",icon:"",atts:"",init:function(a){a.hasOwnProperty("id")&&(this.id=a.id);this.name=a.name;this.category=a.category;this.shortcodeId=a.shortcodeId;this.atts=a.atts;var b=CE.WidgetsLibrary.myThis.getObjectById(this.shortcodeId);b&&(this.groupId=b.groupId,this.icon=b.icon);this.content=a.content},prepareToSave:function(){return{name:this.name,
category:this.category,shortcodeId:this.shortcodeId,content:this.content,atts:{content:this.atts.content,parameters:this.atts.parameters,styles:this.atts.styles}}},setId:function(a){this.id=a}})})(jQuery);(function(d){can.Construct("CE.ObjectTemplatesLibrary.RowTemplate",{},{id:"",name:"",category:"",content:"",icon:"",styles:{},init:function(a){a.hasOwnProperty("id")&&(this.id=a.id);this.name=a.name;this.category=a.category;var b=parent.CE.WidgetsLibrary.myThis.getGrid().row.shortcode;this.icon=
CE.WidgetsLibrary.myThis.getObjectById(b).icon;this.styles=a.styles;this.content=a.content},prepareToSave:function(){return{name:this.name,category:this.category,content:this.content,styles:this.styles}},setId:function(a){this.id=a}})})(jQuery);(function(d){can.Construct("CE.ObjectTemplatesLibrary.PageTemplate",{},{id:"",name:"",category:"",content:"",icon:"",styles:{},init:function(a){a.hasOwnProperty("id")&&(this.id=a.id);this.name=a.name;this.category=a.category;this.icon="";this.styles=a.styles;
this.content=a.content},prepareToSave:function(){return{name:this.name,category:this.category,content:this.content,styles:this.styles}},setId:function(a){this.id=a}})})(jQuery);(function(d){CE.Panels={};can.Control.extend("CE.Panels.DialogsManager",{myThis:null},{dialogs:[],init:function(a,b){CE.Panels.DialogsManager.myThis=this;CE.Iframe.runAndSetAsDependent(this.proxy(function(a){a.$window.on("click",this.proxy("clickHandler"));a.$window.on("keydown",this.proxy("keydownHandler"))}));CE.EventDispatcher.Dispatcher.addListener(CE.PanelEvents.DialogOpen.NAME,
this.proxy(this.onDialogOpen))},onDialogOpen:function(a){a=a.getDialog();var b=a.getName(),c=this.getActiveDialog();-1<d.inArray(b,[CE.Panels.WidgetsDialog.NAME,CE.Panels.LayoutChooserDialog.NAME,CE.Panels.PageDialog.NAME])&&(IframeCE.Selectable.myThis.unselect(),c&&c!=a&&c.getName()!==CE.Panels.HistoryDialog.NAME&&c.close())},registerDialog:function(a){this.dialogs.push(a)},getActiveDialog:function(){return this.dialogs.find(function(a){return a.isOpen()})},clickHandler:function(a){if(!(IframeCE.Selectable.myThis.isHandleForSelected(d(a.target))||
d(a.target).hasClass("mpce-panel-btn")||d(a.target).closest(parent.MP.Utils.convertClassesToSelector(parent.CE.Panels.SettingsDialog.myThis.dialogClass)).length||IframeCE.InlineEditor.isTinymce(a))&&(a=CE.Panels.DialogsManager.myThis.getActiveDialog())){var b=a.getName();b===CE.Panels.SettingsDialog.NAME?IframeCE.Selectable.myThis.unselect():b!==CE.Panels.HistoryDialog.NAME&&a.close()}},keydownHandler:function(a){}})})(jQuery);(function(d){CE.PanelEvents={};CE.PanelEvents.Event=parent.CE.EventDispatcher.Event.extend({},
{});CE.PanelEvents.PanelEvent=CE.PanelEvents.Event.extend({},{dialog:null,init:function(a){this.dialog=a},getDialog:function(){return this.dialog}})})(jQuery);CE.PanelEvents.DialogOpen=CE.PanelEvents.PanelEvent.extend({NAME:"panels.dialog.open"},{});CE.PanelEvents.DialogClose=CE.PanelEvents.PanelEvent.extend({NAME:"panels.dialog.close"},{});(function(d){can.Control.extend("CE.Panels.AbstractDialog",{myThis:null,NAME:null},{name:null,openDeferred:null,init:function(a,b){CE.Panels.DialogsManager.myThis.registerDialog(this)},
open:function(){this.openDeferred&&"pending"==this.openDeferred.state()&&this.openDeferred.reject();this.openDeferred=new d.Deferred;CE.EventDispatcher.Dispatcher.dispatch(CE.PanelEvents.DialogOpen.NAME,new CE.PanelEvents.DialogOpen(this));this.element.dialog("open");return this.openDeferred.promise()},close:function(){this.openDeferred&&"pending"==this.openDeferred.state()&&this.openDeferred.reject();this.isOpen()&&this.element.dialog("close")},toggle:function(){this.isOpen()?this.close():this.open()},
isOpen:function(){return this.element.dialog("isOpen")},getName:function(){return this.constructor.NAME}})})(jQuery);(function(d){can.Control("CE.Panels.Navbar",{myThis:null},{editorEl:d("#motopress-content-editor"),editorWrapperEl:d("#motopress-content-editor-scene-wrapper"),postTypeLabel:null,tutorialsCounter:0,init:function(a,b){CE.Panels.Navbar.myThis=this;CE.Iframe.myThis=null;this.postTypeLabel=motopressCE.postData.postTypeLabel;this.$savingBtns=a.find(".motopress-content-editor-saving-btn");
this.showContentEditor();this.fixEditorWrapperHeight();this.updateSaveButtons();MP.Preloader.myThis.load(CE.Panels.Navbar.shortName);MP.Editor.on("BeforeSave",this.proxy("beforeSave"));MP.Editor.on("AfterUpdate",this.proxy("successSave"));MP.Editor.on("SaveComplete",this.proxy("completedSave"))},fixEditorWrapperHeight:function(){if(0===this.editorWrapperEl.height()){var a=this.editorWrapperEl.parent().height()-53;0<a&&this.editorWrapperEl.height(a);a=this.editorEl.parent().height()-32;0<a&&this.editorEl.height(a);
d(window).resize(function(){var a=CE.Panels.Navbar.myThis.editorWrapperEl.parent().height()-53;0<a&&CE.Panels.Navbar.myThis.editorWrapperEl.height(a);a=CE.Panels.Navbar.myThis.editorEl.parent().height()-32;0<a&&CE.Panels.Navbar.myThis.editorEl.height(a)})}},onIframeLoad:function(a){a=MP.Utils.getScrollbarWidth()+724+80;CE.Iframe.myThis.minWidth=a;CE.Iframe.myThis.setMinWidth()},updateSaveButtons:function(){var a=this.element.find("#motopress-content-editor-publish");"publish"==this.options.PageSettings.status?
a.closest("li").hide():a.closest("li").show()},"#motopress-content-editor-tutorials click":function(a){var b=jQuery("#motopress-tutorials-modal");jQuery("body");b.mpmodal("toggle");0===this.tutorialsCounter&&jQuery.ajax({type:"post",dataType:"html",url:motopress.ajaxUrl,data:{action:"motopress_tutorials"},success:function(a){0!=a&&"nothing"!=a?b.find(".modal-body").html(a):b.find(".modal-body").html("<h1>Error: can't load tutorials.<h1>")}});this.tutorialsCounter++},beforeSave:function(){this.$savingBtns.addClass("mpce-disabled-btn mpce-in-progress")},
completedSave:function(){this.$savingBtns.removeClass("mpce-disabled-btn mpce-in-progress")},successSave:function(){var a;a="draft"===CE.Settings.Page.attr("status")?motopressCE.postData.previewUrl:motopressCE.postData.viewUrl;MP.Flash.setFlash(MP.Utils.strtr(localStorage.getItem("CEPostSaved"),{"%postType%":this.postTypeLabel,"%link%":a,"%preview%":localStorage.getItem("CEPreviewBtnText")}),"success","success-save");MP.Flash.showMessage()},save:function(a){CE.Save.saveAJAX(a)},"#motopress-content-editor-publish:not(.mpce-disabled-btn) click":function(){CE.Saving.save("publish")},
"#motopress-content-editor-update:not(.mpce-disabled-btn) click":function(){CE.Saving.save()},"#motopress-content-editor-page-settings click":function(){CE.Panels.PageDialog.myThis.toggle()},"#motopress-content-editor-history click":function(){CE.Panels.HistoryDialog.myThis.toggle()},"#motopress-content-editor-save-page-object-template click":function(a,b){var c=CE.ObjectTemplatesLibrary.myThis.getPageCategories();CE.SaveObjectModal.myThis.showModal({categories:c}).done(function(a){var b=a.category;
a.name||(a.name="Page");a.hasOwnProperty("newCategoryTitle")&&(b=a.newCategoryTitle?CE.ObjectTemplatesLibrary.myThis.addPageCategory(a.newCategoryTitle):0);var c=new CE.ContentTemplateParser(CE.Iframe.myThis.getContentRootElement());a=new CE.ObjectTemplatesLibrary.PageTemplate({name:a.name,category:b,content:c.content,styles:c.replaceableStyles});CE.ObjectTemplatesLibrary.myThis.savePage(a)})},"#motopress-content-editor-close click":function(){MP.Editor.myThis.close()},"{PageSettings} status":function(){this.updateSaveButtons()},
hide:function(){this.abortShow();this.element.addClass("motopress-ce-navbar-hide").one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(a,b){CE.Panels.Navbar.myThis.element.addClass("motopress-hide");CE.Panels.Navbar.myThis.element.removeClass("motopress-ce-navbar-hide")})},show:function(){this.abortHide();this.element.addClass("motopress-ce-navbar-show").removeClass("motopress-hide").one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){CE.Panels.Navbar.myThis.element.removeClass("motopress-ce-navbar-show")})},
abortShow:function(){this.element.removeClass("motopress-ce-navbar-show").off("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd")},abortHide:function(){this.element.removeClass("motopress-ce-navbar-hide").off("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd")},hideContentEditor:function(){MP.Error.terminate()},showContentEditor:function(){d("html").css({overflow:"hidden",paddingTop:0});this.editorEl.siblings(':not("#'+MP.Preloader.myThis.element.attr("id")+', script, link")').each(function(){d(this).is(":hidden")||
d(this).addClass("motopress-hide")});d("#wpwrap").height("100%").children("#wpcontent").children("#wpadminbar").prependTo("body");this.editorEl.show()}})})(jQuery);can.view.stache("widgetsDialogCommonTab",'<div id="mpce-widgets-common-panel">\n\t\t<div id="mpce-widgets-filter-wrapper">\n\t\t\t<input type="text" class="mpce-widgets-search" placeholder="{{translations.search}}"/>\n\t\t\t<select class="mpce-widgets-category-filter">\n\t\t\t\t<option value="">{{translations.all}}</option>\n\t\t\t\t{{#each library}}\n\t\t\t\t\t<option value="{{id}}">{{name}}</option>\n\t\t\t\t{{/each}}\n\t\t\t</select>\n\t\t</div>\n\t\t<div id="mpce-widgets-wrapper">\n\t\t\t<div id="mpce-recent-widgets"></div>\n\t\t\t<div id="mpce-regular-widgets">\n\t\t\t\t<ul class="mpce-widgets-list mpce-regular-widgets-list">\n\t\t\t\t\t{{#each library}}\n\t\t\t\t\t\t<li class="mpce-widget-group-wrapper" data-id="{{id}}">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t{{#each objects}}\n\t\t\t\t\t\t\t\t\t<li class="mpce-widget-group-{{groupId}} mpce-widget-item-wrapper mpce-widget-id-{{id}}">\n\t\t\t\t\t\t\t\t\t\t<div class="mpce-widget-item"\n\t\t\t\t\t\t\t\t\t\t\t data-widget-id="{{id}}" data-widget-group-id="{{groupId}}" data-widget-title="{{name}}">\n\t\t\t\t\t\t\t\t\t\t\t<span class="mpce-widget-icon" style="background-image: url(\'{{icon}}\');"></span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="mpce-widget-name motopress-default motopress-no-color-text">{{name}}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t{{/each}}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>');
can.view.stache("widgetsDialogLibraryTab",'<div id="mpce-widgets-library-panel">\n\t\t<div id="mpce-widgets-filter-wrapper">\n\t\t\t<input type="text" class="mpce-widgets-search" placeholder="{{translations.search}}"/>\n\t\t\t<select class="mpce-widgets-category-filter">\n\t\t\t\t<option value="">{{translations.all}}</option>\n\t\t\t\t{{#each library}}\n\t\t\t\t\t<option value="{{id}}">{{name}}</option>\n\t\t\t\t{{/each}}\n\t\t\t</select>\n\t\t</div>\n\t\t<div id="mpce-widgets-wrapper">\n\t\t\t<div id="mpce-library-widgets">\n\t\t\t\t{{#templatesExists}}\n\t\t\t\t\t<ul class="mpce-widgets-list mpce-library-widgets-list">\n\t\t\t\t\t\t{{#each library}}\n\t\t\t\t\t\t\t<li class="mpce-widget-group-wrapper" data-id="{{id}}">\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t{{#each objects}}\n\t\t\t\t\t\t\t\t\t\t<li class="mpce-widget-group-{{groupId}} mpce-widget-item-wrapper mpce-widget-id-{{id}}">\n\t\t\t\t\t\t\t\t\t\t\t<div class="mpce-widget-item"\n\t\t\t\t\t\t\t\t\t\t\t data-widget-template-id="{{id}}" data-widget-category-id="{{category}}" data-widget-group-id="{{groupId}}" data-widget-title="{{name}}">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="mpce-widget-icon" style="background-image: url(\'{{icon}}\');"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="mpce-widget-name motopress-default motopress-no-color-text">{{name}}</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t</ul>\n\t\t\t\t{{/templatesExists}}\n\t\t\t\t{{^templatesExists}}\n\t\t\t\t\t<p><em>{{translations.noTemplates}}</em></p>\n\t\t\t\t{{/templatesExists}}\n\t\t\t</div>\n\t\t</div>\n\t</div>');
can.view.stache("widgetsDialog",'<div class="motopress-dialog-tabs" id="mpce-widgets-tab"><ul>{{#each tabs}}<li><a href="#{{id}}" class="motopress-text-no-color-text">{{title}}</a></li>{{/each}}</ul>{{#each tabs}}<div id="{{id}}">{{content}}</div>{{/each}}</div>');can.view.stache("recentWidgets",'{{#recentWidgets.length}}\n\t\t<p>{{translations.recentWidgetsTitle}}</p>\n\t\t<ul class="mpce-widgets-list mpce-recent-widgets-list">\n\t\t\t{{#recentWidgets}}\n\t\t\t\t<li class="mpce-widget-group-{{groupId}} mpce-widget-item-wrapper mpce-widget-id-{{id}}">\n\t\t\t\t\t<div class="mpce-widget-item" data-widget-id="{{id}}" data-widget-group-id="{{groupId}}" data-widget-title="{{name}}">\n\t\t\t\t\t\t<span class="mpce-widget-icon" style="background-image: url(\'{{icon}}\');"></span>\n\t\t\t\t\t\t<span class="mpce-widget-name motopress-default motopress-no-color-text">{{name}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t{{/recentWidgets}}\n\t\t</ul>\n\t{{/recentWidgets.length}}');
(function(d){CE.Panels.AbstractDialog.extend("CE.Panels.WidgetsDialog",{myThis:null,NAME:"widgets"},{spanToInsert:null,library:{},recentWidgets:null,tabs:{common:null,library:null},tabsEl:null,init:function(a,b){this._super();CE.Panels.WidgetsDialog.myThis=this;this.prepareWidgets(b.library,b.grid);this.recentWidgets=new CE.RecentWidgets([]);this.buildDialogElement();a.dialog({autoOpen:!1,resizable:!1,dialogClass:"motopress-dialog",title:"Insert Widget",width:632,height:400});this.tabsEl=a.find("#mpce-widgets-tab");
this.tabsEl.tabs();this.tabs={common:new CE.Panels.WidgetsDialog.CommonTab(this.element.find("#mpce-widgets-common-tab"),{parentDialog:this}),library:new CE.Panels.WidgetsDialog.LibraryTab(this.element.find("#mpce-widgets-library-tab"),{parentDialog:this})}},prepareWidgets:function(a,b){var c=this;this.library={};var e=b.span.inner;d.each(a,function(a,b){var h=IframeCE.Shortcode.isGrid(b.id);if(!b.show&&!h)return!0;c.library[a]=d.extend({},b);c.library[a].objects={};d.each(b.objects,function(k,n){if(!n.show||
h&&k!==e)return!0;c.library[a].objects[k]=d.extend({groupId:b.id},n)})});c.library.mp_grid.objects.hasOwnProperty(e)&&(c.library.mp_grid.objects[e].name="Column")},buildDialogElement:function(){var a=new can.Map({tabs:[{id:"mpce-widgets-common-tab",title:"Widgets",content:""},{id:"mpce-widgets-library-tab",title:"Library",content:""}]});this.element.html(can.view("widgetsDialog",a))},open:function(a,b){this.spanToInsert=a;this.reset();this.element.dialog("option","position",{my:"center",at:"center",
of:window.top});this._super();this.resetAfterOpen()},preparePositionNearSpan:function(){var a=42-CE.Iframe.$window.scrollTop(),a={my:"center bottom",at:"center top"+(0<a?"+":"")+a,of:this.spanToInsert,within:window};this.isOpen()&&(a.using=function(a,c){c.element.element.animate(a)});return a},close:function(){this.element.dialog("close");this.spanToInsert=null},reset:function(){d.each(this.tabs,function(a,b){b.reset()})},resetAfterOpen:function(){d.each(this.tabs,function(a,b){b.resetAfterOpen()})}})})(jQuery);
(function(d){can.Control.extend("CE.Panels.WidgetsDialog.BaseTab",{},{parentDialog:null,widgetsList:null,searchInput:null,init:function(a,b){this.parentDialog=b.parentDialog;this._updateView()},_updateView:function(){this._initElements()},_initElements:function(){this.widgetsList=this._findWidgetList();this.searchInput=this.element.find(".mpce-widgets-search")},_findWidgetList:function(){return this.element},_getTitlePart:function(){return this.searchInput.val().toUpperCase()},hideWidget:function(a){a.addClass("mpce-widget-item-wrapper-hidden")},
showWidget:function(a){a.removeClass("mpce-widget-item-wrapper-hidden")},reset:function(){this.searchInput.val("");this.filterWidgets()},resetAfterOpen:function(){this.element.scrollTop(0)},filterWidgets:function(){var a=this.widgetsList.find(">li>ul>li"),b=this.widgetsList.children("li");this.hideWidget(a);this.showWidget(a.filter(this.proxy(function(a,b){var f=d(b).children();return this._isShowWidget(f)})));a=b.filter(function(a,b){return!d(b).find(">ul>li:not(.mpce-widget-item-wrapper-hidden)").length});
a.hide();b.not(a).show()},_isShowWidget:function(a){var b=this._getTitlePart();return!b||-1!==a.attr("data-widget-title").toUpperCase().indexOf(b)},".mpce-widgets-search input":function(a,b){this.filterWidgets()}})})(jQuery);(function(d){CE.Panels.WidgetsDialog.BaseTab("CE.Panels.WidgetsDialog.CommonTab",{},{categorySelect:null,searchInput:null,init:function(a,b){this._super(a,b);this.updateRecentWidgets()},_initElements:function(){this._super();this.recentWidgetsHolder=this.element.find("#mpce-recent-widgets");
this.categorySelect=this.element.find(".mpce-widgets-category-filter")},_updateView:function(){this.element.html(can.view("widgetsDialogCommonTab",new can.Map({library:this.parentDialog.library,recentWidgets:this.parentDialog.recentWidgets.getList(),translations:{all:"All Categories",search:"Search"}})));this._super()},_findWidgetList:function(){return this.element.find(".mpce-regular-widgets-list")},getRecentWidgetList:function(){return this.element.find(".mpce-recent-widgets-list")},findVisibleWidgets:function(a){return a.find(".mpce-widget-item-wrapper:not(.mpce-widget-item-wrapper-hidden)")},
reset:function(){this.categorySelect.val("");this._super()},resetAfterOpen:function(){this._super();this.searchInput.focus()},filterWidgets:function(){this._super();var a=this.getRecentWidgetList().find(".mpce-widget-group-mp_grid");1<MP.Utils.detectSpanNestingLvl(this.parentDialog.spanToInsert)?this.hideWidget(a):this.showWidget(a);a=this.findVisibleWidgets(this.getRecentWidgetList()).length;this._getTitlePart()||this._getCategory()||!a?this.recentWidgetsHolder.hide():this.recentWidgetsHolder.show()},
_isShowWidget:function(a){var b=this._super(a);b&&(b=this._getCategory(),a=a.attr("data-widget-group-id"),b=""===b||a===b,1<MP.Utils.detectSpanNestingLvl(this.parentDialog.spanToInsert)&&"mp_grid"===a&&(b=!1));return b},_getCategory:function(){return this.categorySelect.val()},updateRecentWidgets:function(){this.recentWidgetsHolder.html(can.view("recentWidgets",{recentWidgets:this.parentDialog.recentWidgets.getList(),translations:{recentWidgetsTitle:"Recent Widgets"}}))},insertInnerRow:function(){IframeCE.LayoutManager.insertRow([6,
6],this.parentDialog.spanToInsert,"in",2)},".mpce-widgets-category-filter change":function(a,b){this.filterWidgets()},"#mpce-regular-widgets .mpce-widget-item click":function(a,b){b.preventDefault();b.stopPropagation();var c=a.attr("data-widget-id"),e=a.attr("data-widget-group-id");if(IframeCE.Shortcode.isGrid(e))this.insertInnerRow();else{var f=CE.Iframe.$("<div />");CE.WidgetsLibrary.myThis.setAttrs(f,e,CE.WidgetsLibrary.myThis.getObject(e,c));IframeCE.LayoutManager.insertWidgetToClmn(f,this.parentDialog.spanToInsert,
!0,!0);IframeCE.Selectable.myThis.showWidgetMainEditTool(f)}this.parentDialog.close();this.parentDialog.recentWidgets.add(d.extend({groupId:e},this.parentDialog.library[e].objects[c]));this.updateRecentWidgets()},"#mpce-recent-widgets .mpce-widget-item click":function(a,b){b.preventDefault();b.stopPropagation();var c=a.attr("data-widget-id"),d=a.attr("data-widget-group-id");if(IframeCE.Shortcode.isGrid(d))this.insertInnerRow();else{var f=CE.Iframe.$("<div />");CE.WidgetsLibrary.myThis.setAttrs(f,
d,CE.WidgetsLibrary.myThis.getObject(d,c));IframeCE.LayoutManager.insertWidgetToClmn(f,this.parentDialog.spanToInsert,!0,!0)}this.parentDialog.close()}})})(jQuery);(function(d){var a;CE.Panels.WidgetsDialog.BaseTab("CE.Panels.WidgetsDialog.LibraryTab",{},(a={categorySelect:null,init:function(a,c){this._super(a,c);parent.CE.EventDispatcher.Dispatcher.addListener(CE.Libraries.Events.WidgetTemplateSaved.NAME,this.proxy("_updateView"))},_initElements:function(){this._super();this.categorySelect=this.element.find(".mpce-widgets-category-filter")},
_updateView:function(){this.element.html(can.view("widgetsDialogLibraryTab",new can.Map({library:this._prepareLibrary(),templatesExists:0!==CE.ObjectTemplatesLibrary.myThis.getWidgets().length,translations:{all:"All Categories",uncategorized:"Uncategorized",search:"Search",noTemplates:"There are no saved templates yet."}})));this._super()},_prepareLibrary:function(){var a={};d.each(CE.ObjectTemplatesLibrary.myThis.getWidgetCategories(),function(c,d){a[c]={id:c,name:d,objects:[]}});d.each(CE.ObjectTemplatesLibrary.myThis.getWidgets().attr(),
function(c,d){var f=d.category;(a[f]?a[f]:a[0]).objects.push(d)});return a},_findWidgetList:function(){return this.element.find(".mpce-library-widgets-list")},_isShowWidget:function(a){return this._super(a)},reset:function(){this.categorySelect.val("");this._super()},_getCategory:function(){return this.categorySelect.val()}},s(a,"_isShowWidget",function(a){var c=this._super(a);c&&(c=this._getCategory(),a=a.attr("data-widget-category-id"),c=""===c||a===c,1<MP.Utils.detectSpanNestingLvl(this.parentDialog.spanToInsert)&&
"mp_grid"===a&&(c=!1));return c}),s(a,".mpce-widgets-category-filter change",function(a,c){this.filterWidgets()}),s(a,"#mpce-library-widgets .mpce-widget-item click",function(a,c){c.preventDefault();c.stopPropagation();var d=a.attr("data-widget-template-id"),d=CE.ObjectTemplatesLibrary.myThis.getWidgetById(d),f=this.parentDialog.spanToInsert,g=parent.MP.Utils.getEdgeSpan(f);g.children(".motopress-block-content").addClass(IframeCE.Shortcode.preloaderClass).children(".motopress-filler-content").addClass("motopress-hide");
IframeCE.LayoutManager.insertShortcodeString(d.content,new MP.EntityType(IframeCE.Grid.ENTITIES.WIDGET),f,"in").done(this.proxy(function(a){IframeCE.Selectable.myThis.showWidgetMainEditTool(a);f.children(".motopress-block-content").children().trigger("render")})).always(this.proxy(function(){g.children(".motopress-block-content").removeClass(IframeCE.Shortcode.preloaderClass)}));this.parentDialog.close()}),a))})(jQuery);(function(d){can.Construct("CE.RecentWidgets",{},{maxSize:5,storage:[],init:function(a,
b){"undefined"!==typeof b&&(this.maxSize=b);a.length>this.maxSize&&a.splice(0,a.length-this.maxSize);this.storage=a},add:function(a){var b=JSON.stringify(a);this.storage=this.storage.filter(function(a){return JSON.stringify(a)!==b});this.storage.unshift(a);this.storage.length>this.maxSize&&this.storage.pop()},getList:function(){return this.storage}})})(jQuery);(function(d){CE.Ctrl=can.Control.extend({bodyEl:d("body"),processValue:function(a,b,c){(a="undefined"!==typeof c&&c&&"undefined"===typeof a?
b:a)||(a="");return String(a)}},{name:null,propLabel:null,dependency:!1,disabled:!1,hided:!1,isPermanentHided:!1,customized:!1,shortcode:null,shortcodeName:null,shortcodeCtrl:null,formCtrl:null,init:function(a,b){this.customized=!1;this.name=b.name;this.propLabel=this.filterPropLabel(b.propLabel);this.dependency=b.dependency;this.disabled=b.disabled;this.isPermanentHided=b.hasOwnProperty("isPermanentHided")&&b.isPermanentHided;this.formCtrl=b.formCtrl;b.hasOwnProperty("innerForm")&&(this.innerForm=
b.innerForm);this.shortcode=b.shortcode;this.shortcodeName=IframeCE.Shortcode.getShortcodeName(this.shortcode);this.shortcodeGroup=IframeCE.Shortcode.getShortcodeGroup(this.shortcode);this.shortcodeCtrl=b.shortcode.control(IframeCE.Controls)},afterInit:function(){this.isPermanentHided&&this.hide()},get:function(){},set:function(){},filterPropLabel:function(a){a=d.trim(a);a.lastIndexOf(":")===a.length-1&&(a=a.substring(0,a.length-1));return a},hide:function(){this.element.closest("[data-motopress-parameter]").addClass("motopress-hide");
this.hided=!0},show:function(){this.isPermanentHided||(this.element.closest("[data-motopress-parameter]").removeClass("motopress-hide"),this.hided=!1)},isHided:function(){return this.hided},change:function(a,b,c,d){b.stopPropagation();"undefined"===typeof c&&(c=!0);CE.EventDispatcher.Dispatcher.clearPrevents();can.isFunction(d)&&this.proxy(d)();this.hideDependencedControls();c&&this.formCtrl.changeProperty(this)}," customize":function(a,b){if(this.customized)return!1;this.customized=!0},hideDependencedControls:function(){var a=
this,b;a.formCtrl.form.find('> [data-motopress-parameter] > .motopress-controls:not(".select2-container"), > [data-motopress-parameter] > :not(".motopress-property-legend, .motopress-property-label, .motopress-property-description, hr") > .motopress-controls').each(function(){b=d(this).control(CE.Ctrl);b.dependency&&a.name===b.dependency.parameter&&(b.isShouldBeHiddenByDependency()?b.hide():b.show(),b.hideDependencedControls())})},isShouldBeHiddenByDependency:function(){var a=!1;if(this.hasOwnProperty("dependency")&&
this.dependency.hasOwnProperty("parameter")){var b=this.formCtrl.getCtrlByName(this.dependency.parameter),c=this.dependency.hasOwnProperty("value")?d.isArray(this.dependency.value)?-1!==d.inArray(b.get(),this.dependency.value):b.get()==this.dependency.value:!0,e=this.dependency.hasOwnProperty("except")?d.isArray(this.dependency.except)?-1!==d.inArray(b.get(),this.dependency.except):b.get()==this.dependency.except:!1;!c||e?a=!0:b.dependency&&(a=b.isShouldBeHiddenByDependency())}return a}});CE.Ctrl("CE.CtrlInput",
{},{get:function(){return this.element.val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.val(a)}});CE.Ctrl("CE.CtrlSpinner",{listensTo:["customize"]},{spinning:!1,min:null,max:null,step:1,init:function(a,b){this._super(a,b);b.hasOwnProperty("min")&&(this.min=b.min);b.hasOwnProperty("max")&&(this.max=b.max);b.hasOwnProperty("step")&&(this.step=b.step)}," customize":function(a,b){if(this.customized)return!1;this.customized=!0;var c=this;a.spinner({disabled:this.disabled,min:this.min,
max:this.max,step:this.step,stop:function(b,d){c.spinning&&(a.trigger("change",c.oldValue),c.spinning=!1,c.oldValue=null)},spin:function(a,b){c.spinning||(c.spinning=!0,c.oldValue=c.get())}})},change:function(a,b,c){var d=this.get();null!==d&&c!==d&&d>=this.min&&d<=this.max&&0===(d/this.step).toFixed(12)%1&&CE.Ctrl.prototype.change.apply(this,[a,b])},get:function(){return this.element.spinner("value")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);"undefined"!==typeof this.element.data("uiSpinner")?
this.element.spinner("value",a):this.element.val(a)}});CE.Ctrl("CE.CtrlDateTimePicker",{listensTo:["customize"]},{returnMode:null,displayMode:null,input:null,button:null,changeTimeout:null,showedValue:null,dpChangePrevented:!1,init:function(a,b){this._super(a,b);this.returnMode=b.returnMode;this.displayMode=b.displayMode;this.input=a.find(".motopress-property-datetime-picker-input");this.wrapper=a.find(".motopress-property-datetime-picker-wrapper")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,
c);this.input.val(a)},get:function(){return this.input.val()}," customize":function(a,b){if(this.customized)return!1;this.customized=!0;this._super(a,b);var c=this;this.input.on("change",this.proxy(function(a){this.dpChangePrevented=!0;this.element.trigger("change")}));this.wrapper.datetimepicker({format:this.returnMode,debug:!1,icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"glyphicon glyphicon-screenshot",
clear:"fa fa-trash-o"}}).on("dp.show",function(a){c.dpChangePrevented=!1;c.showedValue=c.get()}).on("dp.hide",function(a){c.dpChangePrevented||c.showedValue==c.get()||(clearTimeout(c.changeTimeout),c.element.trigger("change"))}).on("dp.change",function(a){c.dpChangePrevented||(clearTimeout(c.changeTimeout),c.changeTimeout=setTimeout(function(){CE.Ctrl.prototype.change.apply(c,[c.element,a,!0,c.preventDispatcher])},500))})},preventDispatcher:function(){CE.EventDispatcher.Dispatcher.prevent(IframeCE.SceneEvents.EntitySettingsChanged.NAME)}});
CE.Ctrl("CE.CtrlLink",{},{get:function(){return d(".motopress-property-link-input",this.element).val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);d(".motopress-property-link-input",this.element).val(a)},".motopress-property-button-default click":function(a){var b=d(".motopress-property-link-input",this.element);IframeCE.Link.myThis.open(b,{title:!1,target:!1},function(a){b.val!=a.href&&(b.val(a.href),b.trigger("change"))},IframeCE.Link.myThis.wpCancelButtonHandler);return!1}});CE.Ctrl("CE.CtrlTextarea",
{},{get:function(){return this.element.val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.val(a)}});CE.Ctrl("CE.CtrlTextarea64",{},{get:function(){return MP.Utils.base64_encode(this.element.val())},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.val(MP.Utils.base64_decode(a))}});CE.Ctrl("CE.CtrlTextareaTable",{},{get:function(){return MP.Utils.nl2br(this.element.val())},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);a=a.replace(/^<p>/,"").replace(/<\/p>$/,"");
a=MP.Utils.br2nl(a);this.element.val(a)}});CE.Ctrl("CE.CtrlTextareaTinymce",{},{textarea:null,currentShortcode:null,init:function(a,b){this._super(a,b);this.textarea=a.children(".motopress-property-textarea");this.currentShortcode=b.currentShortcode},get:function(){return this.textarea.val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.textarea.val(a)},".motopress-property-button-default click":function(a,b){var c=CE.CodeModal.myThis.editor;CE.CodeModal.currentShortcode=this.currentShortcode;
CE.CodeModal.currentTextareaTinymce=this.element;var d=this.get();d.length&&(null!==c&&c.setContent(d,{format:"html"}),CE.CodeModal.myThis.content.val(d));CE.CodeModal.myThis.saveHandler=this.saveHandler;CE.CodeModal.myThis.element.data("modal").closeDialog=!1;CE.CodeModal.myThis.element.mpmodal("show")},saveHandler:function(a){a=CE.CodeModal.myThis;a.switchVisual();var b=CE.CodeModal.currentTextareaTinymce.control(CE.CtrlTextareaTinymce),c=a.editor.getContent({format:"html"});c.length&&(b.set(c),
CE.CodeModal.currentTextareaTinymce.trigger("change"));a.element.mpmodal("hide")}});CE.Ctrl("CE.CtrlAudio",{},{init:function(a,b){this._super(a,b);d(".motopress-property-audio-title",this.element).val(b.audioTitle).attr("disabled","disabled")},get:function(){return d(".motopress-property-audio-id",this.element).val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);d(".motopress-property-audio-id",this.element).val(a)},".motopress-property-button-default click":function(a){CE.WPAudio.myThis.frame.open(this)}});
CE.Ctrl("CE.CtrlMediaVideo",{},{init:function(a,b){this._super(a,b)},get:function(){return d(".motopress-property-video-url",this.element).val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);d(".motopress-property-video-url",this.element).val(a)},".motopress-property-button-default click":function(a){this.element.attr("data-motopress-open-video-lib",1);CE.WPVideo.myThis.frame.open(this)}});CE.Ctrl("CE.CtrlMedia",{listensTo:["dialogOpen"]},{init:function(a,b){this._super(a,b);if("id"==b.returnMode){var c=
CE.Iframe.myThis.wpAttachmentDetails,e;for(e in c)b.value==e&&(d(".motopress-property-media-id",this.element).val(e),d(".motopress-property-media",this.element).val(c[e]).attr("disabled","disabled"))}else d(".motopress-property-media",this.element).val(b.value)},get:function(){return"id"==this.options.returnMode?d(".motopress-property-media-id",this.element).val():d(".motopress-property-media",this.element).val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);"id"==this.options.returnMode?d(".motopress-property-media-id",
this.element).val(a):d(".motopress-property-media",this.element).val(a)},".motopress-property-button-default click":function(a){this.element.attr("data-motopress-open-media-lib",1);CE.WPMedia.myThis.frame.open(this)}});CE.Ctrl("CE.CtrlImageGeneral",{listensTo:["dialogOpen"]},{autoOpen:!1,init:function(a,b){this._super(a,b);b.isNew&&"true"===b.autoOpen&&(this.autoOpen=!0)}});CE.CtrlImageGeneral("CE.CtrlImage",{thumbnail:motopress.pluginDirUrl+"images/ce/imageThumbnail.png"+motopress.pluginVersionParam,
storedThumbs:{}},{returnMode:"id",pseudoRender:!1,value:null,init:function(a,b){this._super(a,b);this.pseudoRender=b.pseudoRender;b.hasOwnProperty("returnMode")&&(this.returnMode=b.returnMode)}," dialogOpen":function(a){this.autoOpen&&(a.find(".motopress-thumbnail-crop").trigger("click"),this.autoOpen=!1)},get:function(){return null!==this.value?this.value:""},set:function(a,b,c){if(d.isPlainObject(a)&&a.hasOwnProperty("id")&&a.hasOwnProperty("src")&&a.hasOwnProperty("full"))this.value="id"===this.returnMode?
a.id:a.full,this.setThumbnail(a.src,b,c),this.pseudoRender&&(this.setFullSrc(a.full),this.shortcode.css("background-image","url('"+a.full+"')"));else{if("id"===this.returnMode)if(d.isNumeric(a)){var e=this.getThumb(a);this.value=a;if(e)this.setThumbnail(e,b,c);else{var f=this;this.showPreloader();d.ajax({url:motopress.ajaxUrl,type:"POST",dataType:"text",data:{action:"motopress_ce_get_attachment_thumbnail",nonce:motopressCE.nonces.motopress_ce_get_attachment_thumbnail,postID:motopressCE.postID,id:a},
success:function(e){e=d.parseJSON(e);f.storeThumb(a,e.medium);f.setThumbnail(e.medium,b,c);f.setFullSrc(e.full);f.hidePreloader()},error:function(a){a=d.parseJSON(a.responseText);a.debug?console.log(a.message):(MP.Flash.setFlash(a.message,"error"),MP.Flash.showMessage());f.removeValue();f.hidePreloader()}})}}else this.removeValue();"src"===this.returnMode&&"string"===typeof a&&(""===a?this.removeValue():(this.value=a,this.setThumbnail(this.value,b,c),this.setFullSrc(this.value),this.showTools()))}},
storeThumb:function(a,b){return this.constructor.storedThumbs[a]=b},getThumb:function(a){return this.constructor.storedThumbs[a]},setThumbnail:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.find(".motopress-thumbnail").attr("src",a);this.showTools()},setFullSrc:function(a){this.element.find(".motopress-thumbnail").attr("data-full-src",a)},".motopress-thumbnail-crop click":function(a,b){a.hasClass(IframeCE.Shortcode.preloaderClass)||(this.element.attr("data-motopress-open-img-lib",1),CE.ImageLibrary.myThis.frame.open())},
".motopress-icon-trash click":function(){this.removeValue();this.element.trigger("change")},removeValue:function(){this.value=null;this.element.find(".motopress-thumbnail").attr("src",this.constructor.thumbnail);this.hideTools();this.pseudoRender&&(this.shortcode.css("background-image",""),this.element.find(".motopress-thumbnail").removeAttr("data-full-src"))},showTools:function(){this.element.children(".motopress-image-tools").show()},hideTools:function(){this.element.children(".motopress-image-tools").hide()},
showPreloader:function(){this.element.children(".motopress-thumbnail-crop").addClass(IframeCE.Shortcode.preloaderClass).children(".motopress-thumbnail").css("visibility","hidden");this.hideTools()},hidePreloader:function(){var a=this.element.children(".motopress-thumbnail-crop"),b=a.children(".motopress-thumbnail");a.removeClass(IframeCE.Shortcode.preloaderClass);b.css("visibility","visible");b.attr("src")!==this.constructor.thumbnail&&this.showTools()}});CE.CtrlImageGeneral("CE.CtrlImageSlider",
{},{ids:null,init:function(a,b){this._super(a,b)}," dialogOpen":function(a){this.autoOpen&&(a.trigger("click"),this.autoOpen=!1)},get:function(){return null!==this.ids?this.ids:""},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);b=m(a);if("object"===b){b="";c=a.length;for(var e=0;e<c;e++)b=e<c-1?b+(a[e]+","):b+a[e];this.ids=b}else if("number"===b||"string"===b)this.ids=d.trim(a)},getArray:function(){var a=[];if(this.ids)for(var a=this.ids.split(","),b,c=0;c<a.length;c++)(b=parseInt(a[c],10))?a[c]=
b:delete a[c];return a},click:function(a){a.hasClass(IframeCE.Shortcode.preloaderClass)||CE.WPGallery.myThis.open(this)}});CE.Ctrl("CE.CtrlVideo",{},{init:function(a,b){this._super(a,b);this.element.on("paste",function(){var b=setTimeout(function(){a.blur();clearTimeout(b)},0)})},get:function(){return this.element.val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.val(a)}});CE.Ctrl("CE.CtrlCheckbox",{},{get:function(){return this.element.is(":checked").toString()},set:function(a,
b,c){a=CE.Ctrl.processValue(a,b,c);"true"===a?this.element.attr("checked","checked"):this.element.removeAttr("checked")}});CE.CtrlCheckbox("CE.CtrlGroupCheckbox",{},{change:function(a,b){a.is(":checked")&&a.closest(".motopress-property-group-accordion-item").siblings().find('.motopress-property-group-accordion-item-content > [data-motopress-parameter="'+this.name+'"] > .motopress-controls').each(function(){var a=d(this).control(CE.Ctrl);"true"===a.get()&&(a.set("false"),CE.Ctrl.prototype.change.apply(a,
[d(this),b]))});CE.Ctrl.prototype.change.apply(this,[a,b])}});CE.Ctrl("CE.CtrlSelect",{listensTo:["customize"],init:function(){CE.Ctrl.bodyEl.on("click",".motopress-property-select:not(.open) > .dropdown-toggle",function(){var a=d(this).next(),b=a.find("ul > li").length;a.find("li:eq("+(6<=b?5:b-1)+") > a").focus();a.find("ul > li > a.motopress-dropdown-selected").focus()})},setSelected:function(a){var b=a.find("option"),b=b.index(b.filter(":selected"));a=a.next().find(".dropdown-menu > ul > li");
a.children("a.motopress-dropdown-selected").removeClass("motopress-dropdown-selected");a.filter('[rel="'+b+'"]').children("a").addClass("motopress-dropdown-selected")}},{get:function(){return this.element.val()},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.find('[value="'+a+'"]').attr("selected","selected")},change:function(a,b){this._super(a,b);CE.CtrlSelect.setSelected(a)},refresh:function(){this.element.selectpicker("refresh");this.clearSelectpicker();CE.CtrlSelect.setSelected(this.element)},
clearSelectpicker:function(){var a=this.element.next();a.removeClass("ce_ctrl_select motopress-controls");a=a.children(".dropdown-toggle");a.html(a.html().replace(/&nbsp;/g,""))}," customize":function(a){"undefined"!==typeof a.data("selectpicker")&&(a.next().remove(),d.removeData(a[0],"selectpicker"));a.selectpicker({size:6});this.clearSelectpicker();CE.CtrlSelect.setSelected(a)},updateOptions:function(a,b){var c=CE.CtrlTemplates.generateOptions(a,b);this.element.html(c);this.refresh()}});CE.Ctrl("CE.CtrlSelectMultiple",
{listensTo:["customize"]},{init:function(a,b){this._super(a,b)},get:function(){var a="";this.element.select2("data").forEach(function(b,c){a+=""!==a?","+b.id:b.id});return a},set:function(a,b,c){var e=this;a=CE.Ctrl.processValue(a,b,c);a=a.split(",");this.element.find("option").removeAttr("selected");d.each(a,function(a,b){e.element.find('option[value="'+b+'"]').attr("selected","selected")})}," customize":function(a,b){a.select2({separator:",",closeOnSelect:!1,containerCssClass:"motopress-select2",
dropdownCssClass:"motopress-select2-dropdown motopress-multiple-select-control-dropdown",adaptContainerCssClass:function(a){if("motopress-controls"!==a)return a}})}});CE.Ctrl("CE.CtrlSelect2",{listensTo:["customize"]},{isPreview:!1,previewClass:null,unsetClasses:[],data:null,select2DropdownClass:"motopress-property-select2-custom-class",uniqueDropdownClass:null,init:function(a,b){this._super(a,b);var c=CE.WidgetsLibrary.myThis.getObject(this.options.formCtrl.shortcodeGroup,this.options.formCtrl.shortcodeName);
this.options.style=c.styles.mp_style_classes;this.uniqueDropdownClass=MP.Utils.uniqid("motopress-select2-dropdown-")},get:function(){var a=this,b=this.element.select2("data"),c="";this.isPreview&&(b=b.filter(function(b){return-1===d.inArray(b.id,a.unsetClasses)}));b.forEach(function(a,b){a.hasOwnProperty("locked")||!0===a.locked||(c+=""!==c?" "+a.id:a.id)});this.isPreview&&(c+=""!==c?" "+this.previewClass:this.previewClass);return c},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);d.isEmptyObject(this.options.style.basic)||
(b=this.getBasicClassesString(),a=a?b+" "+a:b);this.options.value=a;this.element.val(a)}," customize":function(a,b){if(this.customized)return!1;this.customized=!0;var c=this;this.data=this.getClassesList();a.select2({multiple:!0,separator:" ",closeOnSelect:!1,createSearchChoice:function(a,b){if(/^[-_A-Za-z0-9]+$/.test(a)&&0===d(b).filter(function(){return this.hasOwnProperty("id")?0===this.text.toUpperCase().localeCompare(a.toUpperCase())||0===this.id.toUpperCase().localeCompare(a.toUpperCase()):
0!==d(this.children).filter(function(){return 0===this.text.toUpperCase().localeCompare(a.toUpperCase())||0===this.id.toUpperCase().localeCompare(a.toUpperCase())}).length}).length)return{id:a.toLowerCase(),text:a,custom:!0}},initSelection:function(a,b){b(c.valueToData(c.options.value.split(" ")))},query:function(a){c.options.value=c.element.val();var b={},g;b.results=[];d.each(c.data,function(h,k){k.hasOwnProperty("children")?(g={text:k.text,children:[]},g.children=d.makeArray(k.children.filter(function(b){return(0<=
b.id.toUpperCase().indexOf(a.term.toUpperCase())||0<=b.text.toUpperCase().indexOf(a.term.toUpperCase()))&&d.inArray(b.id,-1===c.options.value.split(" "))})),g.children.length&&b.results.push(g)):(0<=k.id.toUpperCase().indexOf(a.term.toUpperCase())||0<=k.text.toUpperCase().indexOf(a.term.toUpperCase()))&&-1===d.inArray(k.id,c.options.value.split(" "))&&b.results.push(k)});a.callback(b)},formatNoMatches:function(){return localStorage.getItem("CEStyleClassesFormatNoMatches")},formatResult:function(a,
b){if(a.hasOwnProperty("children"))return a.text;a.hasOwnProperty("disabled")&&a.disabled&&b.attr("title",localStorage.getItem("CELiteTooltipText"));return'<i class="select2-preview-icon"'+(a.hasOwnProperty("external")&&"undefined"!==typeof a.external?' data-external="'+a.external+'"':"")+' data-value="'+a.id+'"></i>'+a.text},containerCssClass:"motopress-select2",dropdownCssClass:"motopress-select2-dropdown select2-control-dropdown "+c.select2DropdownClass+" "+c.uniqueDropdownClass});a.on("select2-highlight",
function(a){c.unsetClasses=c.getUnsetClasses(a.val)});d("."+c.uniqueDropdownClass).on("mouseover",".select2-preview-icon",function(){var a=d(this).attr("data-external");"undefined"!==typeof a&&0===d('[href="'+a+'"]').length&&(a=d("<link />",{rel:"stylesheet",type:"text/css",href:a}),CE.Iframe.$("head").append(a));a=d(this).attr("data-value");c.unsetClasses=c.getUnsetClasses(a);c.isPreview=!0;c.setPreviewClass(a);CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOver",{objElement:c.shortcode,objName:c.shortcodeName})});
d("."+c.uniqueDropdownClass).on("mouseleave",".select2-preview-icon",function(){c.isPreview=!1;c.unsetClasses=[];c.setPreviewClass();CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOut",{objElement:c.shortcode,objName:c.shortcodeName})});a.on("select2-blur",function(a){c.isPreview=!1;c.unsetClasses=[];c.setPreviewClass()});a.on("select2-close",function(a){c.isPreview=!1;c.unsetClasses=[];c.setPreviewClass()});a.on("select2-selecting",function(a){c.isPreview=!1;if(a.object.hasOwnProperty("external")&&
0===d('[href="'+a.object.external+'"]').length){var b=d("<link />",{rel:"stylesheet",type:"text/css",href:a.object.external});CE.Iframe.$("head").append(b)}b=d(c.element).select2("val");b=c.excludeGroupValues(b);a.object.hasOwnProperty("custom")&&!0===a.object.custom&&c.data.push({id:a.object.id,text:a.object.text,custom:a.object.custom});c.element.select2("data",c.valueToData(b))});a.on("select2-loaded",function(a,b){d("."+c.uniqueDropdownClass+">.select2-results>li.select2-result.select2-selected").each(function(){var a=
d(this);a.find(".select2-disabled:not(.select2-selected)").length&&a.removeClass("select2-selected")})});a.on("change",this.proxy(function(){var a=this.shortcode.control(IframeCE.Shortcode).shortcodeLabel;CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.EntityStylesChanged.NAME,new IframeCE.SceneEvents.EntityStylesChanged(a,"[Styles]"))}))},valueToData:function(a){var b=this,c=[];d.each(a,function(a,f){d.each(b.data,function(a){b.data[a].hasOwnProperty("children")?d.each(b.data[a].children,
function(d){b.data[a].children[d].id===f&&c.push(b.data[a].children[d])}):b.data[a].id===f&&c.push(b.data[a])})});return c},excludeGroupValues:function(a){var b=this;return a=a.filter(function(a){return-1===d.inArray(a,b.unsetClasses)})},setPreviewClass:function(a){this.previewClass=a;this.options.formCtrl.changeProperty(this)},getUnsetClasses:function(a){var b=[];d.each(this.data,function(c,e){var f=!1;if(e.hasOwnProperty("children")&&(void 0===e.allowMultiple||!1===e.allowMultiple)){d.each(e.children,
function(c,d){d.id===a?f=!0:b.push(d.id)});if(f)return!1;b=[]}});return b},getClassesList:function(){var a=this.getPredefinedClasses(),b=""!==this.options.value?this.options.value.split(" "):[],c=this.getGlobalPredefinedClasses(),e=this.getBasicClasses().concat(c,a);b.forEach(function(a,b){0===d(e).filter(function(){var b=!1;return b=this.hasOwnProperty("children")?0!==d(this.children).filter(function(){return this.hasOwnProperty("id")?0===this.id.localeCompare(a):!1}).length:this.hasOwnProperty("id")?
0===this.id.localeCompare(a):!1}).length&&e.push({id:a,text:a})});return e},getBasicClasses:function(){var a=[];d.isEmptyObject(this.options.style.basic)||(this.options.style.basic.hasOwnProperty("class")?a.push({id:this.options.style.basic["class"],text:this.options.style.basic.label,locked:!0}):d.each(this.options.style.basic,function(b,c){a.push({id:c["class"],text:c.label,locked:!0})}));return a},getBasicClassesString:function(){var a=this.getBasicClasses(),b=[];d.each(a,function(a,d){b.push(d.id)});
return b.join(" ")},getPredefinedClasses:function(){var a=[];if(!d.isEmptyObject(this.options.style.predefined)){var b=this.options.style.predefined,c;for(c in b)if(b[c].hasOwnProperty("values")){var e=[],f;for(f in b[c].values)e.push({id:b[c].values[f]["class"],text:b[c].values[f].label,disabled:b[c].values[f].hasOwnProperty("disabled")&&b[c].values[f].disabled,external:b[c].values[f].external});a.push({text:b[c].label,children:e,allowMultiple:b[c].allowMultiple})}else a.push({id:b[c]["class"],text:b[c].label,
disabled:b[c].hasOwnProperty("disabled")&&b[c].disabled,external:b[c].external})}return a},getGlobalPredefinedClasses:function(){var a=[];d.each(IframeCE.Style.globalPredefinedClasses,function(b,c){if(c.hasOwnProperty("values")){var e=[];d.each(c.values,function(a,b){e.push({id:b["class"],text:b.label,disabled:b.hasOwnProperty("disabled")&&b.disabled})});a.push({text:c.label,children:e,allowMultiple:c.allowMultiple})}else a.push({id:c["class"],text:c.label,disabled:c.hasOwnProperty("disabled")&&c.disabled})});
return a}});CE.Ctrl("CE.CtrlStyleEditor",{listensTo:["customize"]},{privateStyleObj:null,previewState:null,select2DropdownClass:"motopress-property-select2-style-editor",isPreview:!1,previewClass:null,unsetClasses:[],uniqueDropdownClass:null,init:function(a,b){this._super(a,b);this.uniqueDropdownClass=MP.Utils.uniqid("motopress-select2-dropdown-")},get:function(){var a=this,b=this.element.select2("data"),c="";this.privateStyleObj.isEmpty()||(c+=this.privateStyleObj.getId());this.isPreview&&(b=b.filter(function(b){return-1===
d.inArray(b.id,a.unsetClasses)}));b.forEach(function(a,b){a.hasOwnProperty("locked")||!0===a.locked||IframeCE.StyleEditor.myThis.isExistsPreset(a.id)&&(c+=""!==c?" "+a.id:a.id)});this.isPreview&&(c+=""!==c?" "+this.previewClass:this.previewClass);return c},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);b="";this.privateStyleObj||(this.privateStyleObj=IframeCE.StyleEditor.myThis.getPrivateStyleInstance(a,this.shortcodeName));b+=this.privateStyleObj.getId();a=IframeCE.StyleEditor.myThis.retrievePresetClass(a);
IframeCE.StyleEditor.myThis.isExistsPreset(a)&&(b+=" "+a);this.element.val(b)},selectPreset:function(a){a=IframeCE.StyleEditor.myThis.getPresetStyleInstance(a);this.element.select2("data",[this.getPrivateBtn(),{id:a.getId(),text:a.getLabel()}]);this.privateStyleFormCtrl.setPresetStyleObj(a)}," customize":function(){if(this.customized)return!1;this.customized=!0;this.privateStyleForm=d("<div />",{"class":"motopress-style-editor-forms motopress-style-editor-private-forms"});this.presetStyleForm=d("<div />",
{"class":"motopress-style-editor-forms motopress-style-editor-preset-forms"});var a={formsMainCtrl:this.formCtrl.formsMainCtrl,styleEditorCtrl:this,switcher:CE.StyleModeSwitcher};this.privateStyleFormCtrl=new CE.PrivateStyleControlsForm(this.privateStyleForm,d.extend({editedStyleObj:this.privateStyleObj},a));this.presetStyleFormCtrl=new CE.PresetStyleControlsForm(this.presetStyleForm,a);this.customizeSelect()},refresh:function(){var a=this.element.select2("data");d(a).filter(function(a,c){if(c.hasOwnProperty("locked")&&
c.locked)return!0;if(IframeCE.StyleEditor.myThis.isExistsPreset(c.id)){var d=IframeCE.StyleEditor.myThis.getPresetStyleInstance(c.id);c.text=d.getLabel();return!0}return!1});this.element.select2("data",a);this.element.trigger("change")},setPreviewClass:function(a){this.previewClass=a;this.formCtrl.changeProperty(this)},getPrivateBtn:function(){return{id:this.privateStyleObj.getId(),text:"Edit Element Style",locked:!0}},customizeSelect:function(){var a=this;a.data=IframeCE.StyleEditor.myThis.getPresetsList(!0);
this.element.select2({multiple:!0,separator:" ",closeOnSelect:!0,initSelection:function(b,c){c(a.valueToData(a.element.val().split(" ")))},query:function(a){var c={results:[]};d.each(IframeCE.StyleEditor.myThis.getPresetsListSelect2(),function(d,f){0<=f.text.toUpperCase().indexOf(a.term.toUpperCase())&&c.results.push(f)});a.callback(c)},formatNoMatches:function(){return localStorage.getItem("CEStylePresetsFormatNoMatches")},formatResult:function(a,c){return'<i class="select2-preview-icon" data-value="'+
a.id+'"></i>'+a.text},containerCssClass:"motopress-select2",dropdownCssClass:"motopress-select2-dropdown select2-control-dropdown "+a.select2DropdownClass+" "+this.uniqueDropdownClass});this.element.select2("container").on("click",".select2-search-choice",function(b){b=d(this).data("select2Data");b.hasOwnProperty("locked")&&b.locked?(a.privateStyleFormCtrl.setPresetStyleObj(a.getSelectedPresetInstance()),a.privateStyleFormCtrl.display(!0)):(b=a.getSelectedPresetInstance(),null!==b&&(a.presetStyleFormCtrl.setEditedStyleObj(b),
a.presetStyleFormCtrl.display(!0)))});this.element.on("select2-highlight",function(b){a.unsetClasses=a.getUnsetClasses(b.val)});d("."+a.uniqueDropdownClass).on("mouseover",".select2-preview-icon",function(){var b=d(this).attr("data-value");a.setPreview(b);CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOver",{objElement:a.shortcode,objName:a.shortcodeName})});d("."+a.uniqueDropdownClass).on("mouseleave",".select2-preview-icon",function(){a.isPreview=!1;a.unsetClasses=[];a.setPreviewClass();CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOut",
{objElement:a.shortcode,objName:a.shortcodeName})});this.element.on("select2-blur select2-close",function(b){a.isPreview=!1;a.unsetClasses=[];a.setPreviewClass()});this.element.on("select2-selecting",function(b){a.isPreview=!1;b=a.element.select2("val");b=a.excludeValues(b);a.element.select2("data",a.valueToData(b))});this.element.on("change",this.proxy(function(a){if(a.hasOwnProperty("val")||a.hasOwnProperty("removed"))a=this.shortcode.control(IframeCE.Shortcode).shortcodeLabel,CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.EntityStylesChanged.NAME,
new IframeCE.SceneEvents.EntityStylesChanged(a,"[Styles]"))}))},setPreview:function(a){this.unsetClasses=this.getUnsetClasses(a);this.isPreview=!0;this.setPreviewClass(a)},unsetPreview:function(){this.isPreview=!1;this.unsetClasses=[];this.setPreviewClass()},valueToData:function(a){var b=this,c=[];d.each(a,function(a,d){if(IframeCE.StyleEditor.myThis.isExistsPreset(d)){var g=IframeCE.StyleEditor.myThis.getPresetStyleInstance(d);c.push({id:g.getId(),text:g.getLabel()})}else IframeCE.StyleEditor.myThis.retrievePrivateClass(d)&&
c.push(b.getPrivateBtn())});return c},getUnsetClasses:function(a){var b=IframeCE.StyleEditor.myThis.getPresetsList();delete b[a];return d.map(b,function(a,b){return b})},excludeValues:function(a){var b=this;return a=a.filter(function(a){return-1===d.inArray(a,b.unsetClasses)})},getSelectedPreset:function(){var a=this.get();return IframeCE.StyleEditor.myThis.retrievePresetClass(a)},getSelectedPresetInstance:function(){var a=this.getSelectedPreset();return IframeCE.StyleEditor.myThis.getPresetStyleInstance(a)},
setStatePreview:function(a){this.unsetStatePreview();var b=[];switch(a){case "up":b.push("up");break;case "hover":b.push("up");b.push("hover");break;case "tablet":b.push("up");b.push("tablet");break;case "mobile":b.push("up"),b.push("tablet"),b.push("mobile")}a=b.map(function(a){return IframeCE.ShortcodeStyle.previewStateClassPrefix+a}).join(" ");b=this.formCtrl.getTargetElement(this);null!==b&&b.addClass(a)},unsetStatePreview:function(){var a=["up","hover","mobile","tablet"].map(function(a){return IframeCE.ShortcodeStyle.previewStateClassPrefix+
a}).join(" "),b=this.formCtrl.getTargetElement(this);null!==b&&b.removeClass(a)}});CE.Ctrl("CE.CtrlComplex",{listensTo:["customize"]},{innerForm:null,innerFormCtrl:null,parameters:{},init:function(a,b){this._super(a,b);this.innerForm=this.element.children(".motopress-property-inner-form");this.innerFormCtrl=new CE.ControlsSubForm(this.innerForm,{formsMainCtrl:this.formCtrl.formsMainCtrl,parentPropertyCtrl:this});this.innerFormCtrl.display(!0)},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.innerFormCtrl.set(this.convertValueToFormData(a))},
get:function(){var a=this.innerFormCtrl.get();return this.convertFormDataToValue(a)},convertValueToFormData:function(){return{}},convertFormDataToValue:function(){return""},getParameters:function(){return this.parameters}});CE.CtrlComplex("CE.CtrlGradient",{valueSeparator:" , ",parseGradientStr:function(a){var b=!1;""!==a&&(a=a.split(CE.CtrlGradient.valueSeparator),3===a.length&&(b={angle:String(parseInt(a[0])),"initial-color":a[1],"final-color":a[2]}));return b}},{parameters:{angle:{type:"spinner",
label:"Gradient Angle",min:0,max:360,step:1,"default":"0"},"final-color":{type:"color-picker",label:"Gradient Initial Color","default":""},"initial-color":{type:"color-picker",label:"Gradient Final Color","default":""}},convertValueToFormData:function(a){(a=CE.CtrlGradient.parseGradientStr(a))||(a={angle:this.parameters.angle["default"],"initial-color":this.parameters["initial-color"]["default"],"final-color":this.parameters["final-color"]["default"]});return a},convertFormDataToValue:function(a){a.hasOwnProperty("angle")&&
!isNaN(parseInt(a.angle))?a.angle=String(parseInt(a.angle)):a.angle="0";a.hasOwnProperty("initial-color")&&""!==a["initial-color"]||(a["initial-color"]="");a.hasOwnProperty("final-color")&&""!==a["final-color"]||(a["final-color"]="");return a.angle+CE.CtrlGradient.valueSeparator+a["initial-color"]+CE.CtrlGradient.valueSeparator+a["final-color"]}});CE.Ctrl("CE.CtrlEditorButton",{},{click:function(){var a=this.shortcode.control(IframeCE.CodeEditor,IframeCE.InlineEditor);a&&a.open()}});CE.Ctrl("CE.CtrlColorPicker",
{listensTo:["customize","dialogOpen"],paletteAddBtn:d("<span />",{"class":"palette-add"})},{lastTimerId:null,input:null,valueObserver:null,dispatchChangeFlag:!1,init:function(a,b){this._super(a,b);this.input=a.children(".motopress-property-input")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);void 0!==this.input.data("spectrum.id")?this.input.spectrum("set",a):this.input.val(a)},get:function(){return this.input.val()},paletteAdd:function(){var a=this.get();if(""!==a){var b=MP.Settings.palettes;
b.pop();b.unshift(a);d.ajax({url:motopress.ajaxUrl,type:"POST",dataType:"json",data:{action:"motopress_ce_colorpicker_update_palettes",nonce:motopressCE.nonces.motopress_ce_colorpicker_update_palettes,postID:motopressCE.postID,palettes:b},success:function(a){MP.Settings.palettes=a.data.palettes;d(".motopress-property-color-picker>.motopress-property-input").each(function(){d(this).spectrum("option","palette",MP.Settings.palettes)})},error:function(a){a=d.parseJSON(a.responseText);a.debug?console.log(a.message):
(MP.Flash.setFlash(a.message,"error"),MP.Flash.showMessage())}})}},"move.spectrum":function(a,b,c){var d=this;null===c&&(c="");clearTimeout(this.lastTimerId);this.lastTimerId=setTimeout(function(){d.input.val(c);d.valueObserver(d.input.val())},500)},"change.spectrum":function(){this.valueObserver(this.input.val())}," customize":function(a,b){if(this.customized)return!1;this.customized=!0;this.input.spectrum({allowEmpty:!0,showAlpha:!0,showInput:!0,showInitial:!0,showPalette:!0,showSelectionPalette:!1,
showButtons:!1,appendTo:this.element,palette:MP.Settings.palettes,preferredFormat:"rgb",containerClassName:"motopress-property-colorpicker mpce-spectrum-theme",replacerClassName:"mpce-spectrum-theme"});this.replacer=this.element.find(".sp-replacer");this.container=this.element.find(".sp-container");this.initPaletteAddBtn();this.valueObserver=can.compute(this.input.val());this.valueObserver.bind("change",this.proxy(this.dispatchChange))},change:function(a,b){this.canDispatchChange()&&this._super(a,
b);this.resetChangeDispatcher()},dispatchChange:function(){this.dispatchChangeFlag=!0;this.element.trigger("change")},canDispatchChange:function(){return this.dispatchChangeFlag},resetChangeDispatcher:function(){this.dispatchChangeFlag=!1},initPaletteAddBtn:function(){var a=this,b=CE.CtrlColorPicker.paletteAddBtn.clone();b.on("click",function(){a.paletteAdd()});this.container.prepend(b)}});CE.Ctrl("CE.CtrlSlider",{},{slider:null,span:null,init:function(a,b){var c=this;this._super(a,b);this.slider=
a.children(".motopress-property-slider");this.span=a.children(".motopress-property-slider-value");this.slider.slider({range:"min",min:parseInt(b.min),max:parseInt(b.max),step:parseInt(b.step),value:parseInt(b.value),slide:function(a,b){c.span.html(b.value)},change:function(b,c){"undefined"!==typeof b.handleObj&&a.trigger("change")},disabled:"true"==b.disabled})},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.span.text(a);this.slider.slider("value",a)},get:function(){return this.slider.slider("option",
"value")}});CE.Ctrl("CE.CtrlRadioButtons",{},{init:function(a,b){this._super(a,b);this.element.buttonset()},set:function(a,b,c){a="undefined"!==typeof a?a:b;"undefined"!==typeof a?this.element.find(':radio[value="'+a+'"]').attr("checked",!0):this.element.find(":radio").removeAttr("checked");this.element.buttonset("refresh")},get:function(){return this.element.find(":radio:checked").val()}});CE.Ctrl("CE.CtrlGroup",{listensTo:["render"]},{currentSpan:null,group:null,label:null,accordion:null,button:null,
oldItemIndex:null,childFormCtrls:null,activeParameter:null,init:function(a,b){this._super(a,b);this.currentSpan=b.currentSpan;this.shortcodeCtrl=b.shortcode.control(IframeCE.Controls);this.label=b.label;this.rules=b.rules;this.events=b.events;this.hasRules=!!(this.rules&&this.rules.hasOwnProperty("rootSelector")&&this.rules.rootSelector);this.hasActiveRules=!!(this.hasRules&&this.rules.hasOwnProperty("activeSelector")&&this.rules.hasOwnProperty("activeClass")&&this.rules.activeClass);this.hasEvents=
!(!this.events||!this.events.hasOwnProperty("onActive")&&!this.events.hasOwnProperty("onInactive"));this.activeParameter=b.activeParameter;this.childFormCtrls=[];this.accordion=a.children(".motopress-property-group-accordion");this.button=a.find("> .motopress-property-button-wrapper > .motopress-property-button-default");this.initChildForms()},initChildForms:function(){this.shortcode.find("[data-motopress-shortcode]").each(this.proxy(function(a,b){var c=CE.CtrlTemplates.createItem();this.addChildFormCtrl(new CE.SettingsControlsChildForm(c,
{parentFormCtrl:this.formCtrl,formsMainCtrl:this.shortcodeCtrl,shortcode:d(b),groupCtrl:this}));this.accordion.append(c)}))},addChildFormCtrl:function(a){this.childFormCtrls.push(a)},reassignShortcodes:function(){var a,b=this;d.each(this.childFormCtrls,function(c,d){a=b.formCtrl.shortcode.find("[data-motopress-shortcode]:eq("+c+")");d.setShortcode(a)})}," render":function(a,b,c){this.updateLabel();var e=this;b=this.shortcode.attr("data-motopress-active-item");b=c&&"undefined"!==typeof b?parseInt(b):
!1;b={active:b,header:"> div > h3",heightStyle:"content",collapsible:!0,create:function(a,b){var c=e.accordion.accordion("option","active");!1!==c&&e.accordion.find(".motopress-property-group-accordion-item:eq("+c+") .motopress-controls").trigger("customize")},beforeActivate:function(a,b){a.hasOwnProperty("originalEvent")&&a.originalEvent.hasOwnProperty("target")&&(d(a.originalEvent.target).hasClass("motopress-property-group-accordion-item-remove")||d(a.originalEvent.target).hasClass("motopress-property-group-accordion-item-duplicate")||
d(a.originalEvent.target).closest(".motopress-property-group-accordion-item-duplicate").length)&&a.preventDefault()},activate:function(a,b){var c=-1,d=-1;"undefined"!==typeof b.oldHeader[0]&&(c=b.oldHeader.parent(".motopress-property-group-accordion-item").index());"undefined"!==typeof b.newHeader[0]&&(d=b.newHeader.parent(".motopress-property-group-accordion-item").index());var n=e.shortcodeCtrl.childName;0<=c&&(e.interact("deactivate",c),e.shortcode.removeAttr("data-motopress-active-item"));0<=
d&&(e.interact("activate",d),e.shortcode.attr("data-motopress-active-item",d),b.newHeader.parent(".motopress-property-group-accordion-item").find(".motopress-controls").trigger("customize"));if(n&&e.hasRules&&e.hasEvents){var m=e.shortcode.find(e.rules.rootSelector);if(m.length){var r;0<=c&&e.events.hasOwnProperty("onInactive")&&(c=m.eq(0).closest('[data-motopress-shortcode="'+n+'"]').length?m.closest('[data-motopress-shortcode="'+n+'"]').eq(c).find(e.rules.rootSelector):m.eq(c),r=e.hasActiveRules&&
e.rules.activeSelector?c.find(e.rules.activeSelector):c,c.length&&(!e.hasActiveRules||e.hasActiveRules&&r.hasClass(e.rules.activeClass))&&(e.events.onInactive.selector?c.find(e.events.onInactive.selector).triggerHandler(e.events.onInactive.event):c.triggerHandler(e.events.onInactive.event),e.hasActiveRules&&r.removeClass(e.rules.activeClass)));0<=d&&e.events.hasOwnProperty("onActive")&&(c=m.eq(0).closest('[data-motopress-shortcode="'+n+'"]').length?m.closest('[data-motopress-shortcode="'+n+'"]').eq(d).find(e.rules.rootSelector):
m.eq(d),r=e.hasActiveRules&&e.rules.activeSelector?c.find(e.rules.activeSelector):c,c.length&&(!e.hasActiveRules||e.hasActiveRules&&!r.hasClass(e.rules.activeClass))&&(e.events.onActive.selector?c.find(e.events.onActive.selector).triggerHandler(e.events.onActive.event):c.triggerHandler(e.events.onActive.event),e.hasActiveRules&&(e.rules.activeSelector?m.find(e.rules.activeSelector).removeClass(e.rules.activeClass):m.removeClass(e.rules.activeClass),r.addClass(e.rules.activeClass))))}}}};this.accordion.accordion("instance")?
this.accordion.accordion("refresh"):this.accordion.accordion(b).sortable({axis:"y",handle:"h3 > .ui-accordion-header-icon",update:function(b,c){var d=c.item.closest(".motopress-property-group-accordion-item").index(),k=e.shortcode.children("div").find("[data-motopress-shortcode]");e.oldItemIndex<d?k.eq(e.oldItemIndex).insertAfter(k.eq(d)):k.eq(e.oldItemIndex).insertBefore(k.eq(d));MP.Utils.moveArrayElement(e.childFormCtrls,e.oldItemIndex,d);e.accordion.accordion("refresh");e.shortcode.attr("data-motopress-active-item",
e.accordion.accordion("option","active"));a.trigger("change")},start:function(a,b){e.oldItemIndex=b.item.closest(".motopress-property-group-accordion-item").index()}});this.disabled&&(!c||c&&this.accordion.children(".motopress-property-group-accordion-item").length)&&this.button.attr("disabled",!0)},change:function(a,b,c){this.updateLabel();var e="";d.each(this.childFormCtrls,this.proxy(function(a,b){if(c&&"true"===b.shortcode.attr("data-motopress-new")){var h="undefined"!==typeof b.shortcode.attr("data-motopress-parameters")?
b.shortcode.attr("data-motopress-parameters"):null;b.setDefaultAttrs(h);d(this).removeAttr("data-motopress-new")}h=new CE.ContentParser(b.shortcode);e+=h.content;a!==this.childFormCtrls.length&&(e+="\n\n")}));this.shortcode.attr("data-motopress-content",e);CE.Ctrl.prototype.change.apply(this,[a,b])},"> .motopress-property-button-wrapper > .motopress-property-button-default click":function(a,b,c){b.stopPropagation();if(!this.disabled||"undefined"!==typeof c){a=d("<div />",{"data-motopress-new":"true"});
b=CE.WidgetsLibrary.myThis.getObject(this.shortcodeGroup,this.shortcodeCtrl.childName);null!==b&&CE.WidgetsLibrary.myThis.setAttrs(a,this.shortcodeGroup,b);if("undefined"!==typeof c){b=d();for(var e=0;e<c;e++)b=b.add(a.clone());a=b}this.shortcodeCtrl.child.append(a);"undefined"===typeof c&&(c=this.shortcodeCtrl.child.find("[data-motopress-shortcode]").index(d(a).eq(-1)),this.shortcode.attr("data-motopress-active-item",c));this.formCtrl.regenerateGroupControl(this.name);this.formCtrl.display(!0,this.name,
!0)}},".motopress-property-group-accordion-item-duplicate click":function(a,b){b.stopImmediatePropagation();var c=a.closest(".motopress-property-group-accordion-item").index(),e=d("<div />",{"data-motopress-new":"true"}),c=this.shortcode.children("div").find("[data-motopress-shortcode]:eq("+c+")"),f=CE.WidgetsLibrary.myThis.getActualAtts(c),g=[],c=CE.WidgetsLibrary.myThis.getObject(this.shortcodeGroup,this.shortcodeCtrl.childName);d.each(c.parameters,function(a,b){b.hasOwnProperty("unique")&&b.unique&&
g.push(a);b.hasOwnProperty("saveInContent")&&b.saveInContent&&delete f.parameters[a]});this.activeParameter&&f.parameters.hasOwnProperty(this.activeParameter)&&f.parameters[this.activeParameter].hasOwnProperty("value")&&g.push(this.activeParameter);d.each(g,function(a,b){f.parameters.hasOwnProperty(b)&&(f.parameters[b]={})});null!==f&&CE.WidgetsLibrary.myThis.setAttrs(e,this.shortcodeGroup,f,!1);this.shortcodeCtrl.child.append(e);e=this.shortcodeCtrl.child.find("[data-motopress-shortcode]").index(d(e).eq(-1));
this.shortcode.attr("data-motopress-active-item",e);this.formCtrl.regenerateGroupControl(this.name);this.formCtrl.display(!0,this.name,!0)},".motopress-property-group-accordion-item-remove click":function(a,b){b.stopPropagation();var c=a.closest(".motopress-property-group-accordion-item").index();this.shortcode.children("div").find("[data-motopress-shortcode]:eq("+c+")").remove();this.shortcode.removeAttr("data-motopress-active-item");this.formCtrl.regenerateGroupControl(this.name);this.formCtrl.display(!1,
this.name,!0)},updateLabel:function(){if(this.label.hasOwnProperty("parameter")){var a=this;this.accordion.find(".motopress-property-group-accordion-item-label-text").each(function(){var b=d(this).closest(".motopress-property-group-accordion-item").control(CE.ControlsForm).getCtrlByName(a.label.parameter);b&&d(this).text(b.get())})}},interact:function(a,b){if(!1!==b&&0<=b){var c=this.shortcode.find("[data-motopress-shortcode]").eq(b);c.length&&CE.Ctrl.bodyEl.trigger("MPCEObjectInteraction",{action:a,
interacted:"child",objElement:this.shortcode,objName:this.shortcodeName,objData:this.shortcode.data("motopress-parameters"),childObjElement:c,childObjName:this.shortcodeCtrl.childName,childObjData:c.data("motopress-parameters")})}}});CE.Ctrl("CE.CtrlMargin",{},{margin:null,init:function(a,b){this._super(a,b);this.margin=b.margin},get:function(){var a=[],b=this,c=!0;d.each(b.margin.sides,function(d,f){var g=b.element.find('[data-motopress-margin-side="'+f+'"] .'+b.margin.classPrefix+"value").text();
a.push(g);g!==b.margin.values[0]&&(c=!1)});return c?"":a.join(",")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);if("string"===typeof a){if(!a.length)return;a=a.split(",")}var e=this;d.each(a,function(a,b){var c=parseInt(b);isNaN(c)||(b=c);var d=e.element.find('[data-motopress-margin-side="'+e.margin.sides[a]+'"]'),c=d.find("."+e.margin.classPrefix+"icon"),n=d.find("."+e.margin.classPrefix+"value"),d=d.find("."+e.margin.classPrefix+"values");n.text(b);d.removeAttr("data-motopress-margin-disabled");
d.filter('[data-motopress-margin-value="'+b+'"]').attr("data-motopress-margin-disabled","");b!==e.margin["default"][a]?(c.attr("data-motopress-margin-active",""),n.attr("data-motopress-margin-active","")):(c.removeAttr("data-motopress-margin-active"),n.removeAttr("data-motopress-margin-active"))})},".motopress-margin-values click":function(a){if("undefined"===typeof a.attr("data-motopress-margin-disabled")){var b=a.closest("[data-motopress-margin-side]"),c=b.index(),d=b.find("."+this.margin.classPrefix+
"icon"),f=b.find("."+this.margin.classPrefix+"value"),b=b.find("."+this.margin.classPrefix+"values"),g=a.text(),h=parseInt(g);isNaN(h)||(g=h);f.text(g);b.removeAttr("data-motopress-margin-disabled");a.attr("data-motopress-margin-disabled","");g!==this.margin["default"][c]?(d.attr("data-motopress-margin-active",""),f.attr("data-motopress-margin-active","")):(d.removeAttr("data-motopress-margin-active"),f.removeAttr("data-motopress-margin-active"));this.element.trigger("change");a=this.shortcode.control(IframeCE.Shortcode).shortcodeLabel;
CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.EntityStylesChanged.NAME,new IframeCE.SceneEvents.EntityStylesChanged(a,"[Styles]"))}},getClasses:function(a){var b=[];if("undefined"!==typeof a&&a.length){"string"===typeof a&&(a=a.split(","));var c=[];d.each(a,function(a,b){-1===d.inArray(b,c)&&c.push(b)});var e=1===c.length;if(4===a.length&&e&&c[0]!==this.margin.values[0])b.push(this.margin.classPrefix+c[0]);else{var f=this;d.each(a,function(a,c){c!==f.margin["default"][a]&&b.push(f.margin.classPrefix+
f.margin.sides[a]+"-"+c)})}}return b.join(" ")}});CE.Ctrl("CE.CtrlIconPicker",{listensTo:["customize"]},{emptyIcon:!1,emptyIconValue:null,firstChanged:!0,oldValue:"",get:function(){return this.element.find("option:selected").attr("data-value")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.find('[data-value="'+a+'"]').attr("selected","selected")},change:function(a,b){if(this.firstChange)return this.firstChange=!1,this.oldValue=this.get(),!1;if(this.oldValue!=this.get())this._super(a,
b),CE.CtrlSelect.setSelected(a),this.oldValue=this.get();else return!1},init:function(a,b){this._super(a,b);this.firstChange=!0;this.oldValue=this.get();"undefined"!==typeof b.emptyValue&&(this.emptyIcon=!0,this.emptyIconValue="undefined"!==typeof b.emptyValue?b.emptyValue:"")}," customize":function(a){if(this.customized)return!1;this.customized=!0;a.fontIconPicker({emptyIcon:this.emptyIcon,emptyIconValue:this.emptyIconValue,theme:"fip-mpce",iconsPerPage:1E3});var b=a.get(0).className;a.siblings(".icons-selector").addClass(b).removeClass("ce_ctrl_icon_picker motopress-controls")}})})(jQuery);
(function(d){CE.CtrlTemplates=can.Construct({createLegend:function(a){return"undefined"!==typeof a&&a.length?(a=d("<div />",{"class":"motopress-property-legend",html:a}),d.merge(a,d("<hr />"))):null},createLabel:function(a){return d("<label />",{"class":"motopress-property-label",text:a})},createDescription:function(a){a=d("<div />",{"class":"motopress-property-description",html:a});return d.merge(a,d("<hr />"))},createInput:function(a,b,c,e){"undefined"===typeof b&&(b=null);"undefined"===typeof c&&
(c="text");"undefined"===typeof e&&(e="input");var f={};if(a.hasOwnProperty("disabled")){var g="true"===a.disabled;g&&(f.disabled=g)}b=d("<input />",{"class":"motopress-property-"+e,type:c,name:b});this.setAttrs(b,a,f);return b},createLink:function(a,b){var c=d("<div />",{"class":"motopress-property-link"}),e=this.createInput(a,b,void 0,"link-input"),f=this.createButton(a);c.append(e,f);this.setAttrs(c,a,{});return c},createMedia:function(a,b){"undefined"===typeof b&&(b=null);var c="",e={},f=d("<div />",
{"class":"motopress-property-link"});switch(a.type){case "audio":this.createInput(a,b,"hidden","audio-id").appendTo(f);c="audio-title";break;case "media-video":c="video-url";break;case "media":this.createInput(a,b,"hidden","media-id").appendTo(f),c="media"}var c=this.createInput(a,b,"text",c).appendTo(f),g=this.createButton(a,b).appendTo(f);this.setAttrs(c,a,e);this.setAttrs(g,a,e);return f},createTextarea:function(a){var b={rows:5,cols:10};if(a.hasOwnProperty("disabled")){var c="true"===a.disabled;
c&&(b.disabled=c)}c=d("<textarea />",{"class":"motopress-property-textarea"});this.setAttrs(c,a,b);return c},createTextareaTinyMCE:function(a){var b=this.createTextarea(a);a=this.createButton(a);return d("<div />",{"class":"motopress-property-textarea-tinymce"}).append(b,a)},createImage:function(a){var b=d("<div />",{"class":"motopress-property-image"}),c=d("<div />",{"class":"motopress-image-tools"});d("<div />",{"class":"motopress-default motopress-icon-trash motopress-icon-white"}).appendTo(c);
a.hasOwnProperty("value")&&a.value||c.hide();var e=d("<div />",{"class":"motopress-thumbnail-crop"}),f=d("<img />",{src:CE.CtrlImage.thumbnail,"class":"motopress-thumbnail"}).appendTo(e);b.append(e,c);a.hasOwnProperty("disabled")&&"true"===a.disabled&&b.append(d("<div />",{"class":"motopress-image-disabled"}));this.setAttrs(f,a,{});return b},createVideo:function(a,b){"undefined"===typeof b&&(b=null);var c=this.createInput(a,b,"text","video");this.setAttrs(c,a,{});return c},createCheckbox:function(a,
b){"undefined"===typeof b&&(b=null);var c=this.createInput(a,b,"checkbox","checkbox-input motopress-property-input");this.setAttrs(c,a,{});return c},_createSelect:function(a,b,c){"undefined"===typeof b&&(b=null);var e=!1,f;switch(c){case "select":f="select";break;case "select-multiple":f="select-multiple",e=!0}c={};if(a.hasOwnProperty("disabled")){var g="true"===a.disabled;g&&(c.disabled=g)}b=d("<select />",{"class":"motopress-property-"+f+" motopress-bootstrap-dropdown motopress-dropdown-select",
multiple:e?"multiple":!1,name:b});e=CE.CtrlTemplates.generateOptions(a.list);b.append(e);this.setAttrs(b,a,c);return b},generateOptions:function(a,b){var c=[],e;d.each(a,function(a,g){e={value:a,text:g};"undefined"!==typeof b&&b===a&&(e.selected="selected");c.push(d("<option />",e))});return c},createSelect:function(a,b){return this._createSelect(a,b,"select")},createSelectMultiple:function(a,b){return this._createSelect(a,b,"select-multiple")},createColorSelect:function(a,b){"undefined"===typeof b&&
(b=null);var c={};if(a.hasOwnProperty("disabled")){var e="true"===a.disabled;e&&(c.disabled=e)}var f=d("<select />",{"class":"motopress-property-select motopress-bootstrap-dropdown color-select motopress-dropdown-select",name:b}),g="undefined"===typeof a["class-prefix"]?"":a["class-prefix"];d.each(a.list,function(a,b){var c="string"==typeof a?a.toLowerCase():"";f.append(d("<option />",{value:a,text:b}).attr("data-content",'<span class="color '+g+c+'"></span><span>'+b+"</span>"))});this.setAttrs(f,
a,c);return f},createButton:function(a,b,c){"undefined"===typeof b&&(b=null);"undefined"!==typeof c&&c||(c="default");var e={};if(a.hasOwnProperty("disabled")){var f="true"===a.disabled;f&&(e.disabled=f)}f=a.hasOwnProperty("class")?" "+a["class"]:"";b=d("<button />",{"class":"motopress-property-button-"+c+f,text:a.text,name:b});this.setAttrs(b,a,e);return b},createColorPicker:function(a,b){var c=this.createInput(a,b,"hidden"),c=d("<div />",{"class":"motopress-property-color-picker"}).append(c);this.setAttrs(c,
a,{});return c},createSlider:function(a,b){var c=d("<div>",{"class":"motopress-property-slider"}),e=d("<span>",{type:"text","class":"motopress-property-slider-value",text:a["default"]}),f=d("<div>",{"class":"motopress-property-slider"});c.appendTo(f);e.appendTo(f);return f},createRadioButtons:function(a){var b=this,c={};if(a.hasOwnProperty("disabled")){var e="true"===a.disabled;e&&(c.disabled=e)}var f=d("<div />",{"class":"motopress-property-radio-buttons"}),g=parent.MP.Utils.uniqid(),h=0;d.each(a.list,
function(e,n){var m=d("<input />",{type:"radio",id:g+h,name:g,value:e});b.setAttrs(m,a,c);var r=d("<label />",{"for":g+h,text:n});f.append(m,r);h++});this.setAttrs(f,a,c);return f},createGroup:function(a){var b=d("<div />",{"class":"motopress-property-group"});d("<div />",{"class":"motopress-property-group-accordion"}).appendTo(b);var c=d("<div />",{"class":"motopress-property-button-wrapper"}).appendTo(b),e=d.extend({},a);a.hasOwnProperty("disabled")&&"true"===a.disabled&&(delete e.disabled,d("<div />",
{"class":"motopress-property-disabled"}).appendTo(c));this.createButton(e).appendTo(c);this.setAttrs(b,a,{});return b},createItem:function(){var a=d("<span />",{"class":"motopress-property-group-accordion-item-label-text"}),b=d("<span />",{"class":"motopress-property-group-accordion-item-btn motopress-property-group-accordion-item-duplicate",title:"Duplicate",html:d("<i />",{"class":"fa fa-clone"})}),c=d("<span />",{"class":"motopress-property-group-accordion-item-btn motopress-property-group-accordion-item-remove",
title:"Delete",html:d("<i />",{"class":"fa fa-trash-o"})}),a=d("<h3 />",{"class":"motopress-property-group-accordion-item-label"}).append(a,b,c),b=d("<div />",{"class":"motopress-property-group-accordion-item-content"});return d("<div />",{"class":"motopress-property-group-accordion-item"}).append(a,b)},createMargin:function(a){var b=d("<table />",{"class":"motopress-property-margin"});d.each(a.sides,function(c,e){var f=d("<tr />",{"data-motopress-margin-side":e}).appendTo(b);d("<td />").append(d("<i />",
{"class":a.classPrefix+"icon "+a.classPrefix+"icon-"+e})).appendTo(f);d("<td />").append(d("<div />",{"class":a.classPrefix+"value",text:a["default"][c]})).appendTo(f);d.each(a.values,function(b,c){d("<td />").append(d("<div />",{"class":a.classPrefix+"values","data-motopress-margin-value":c,text:c})).appendTo(f)})});return b},createIconPicker:function(a,b){"undefined"===typeof b&&(b=null);var c={};if(a.hasOwnProperty("disabled")){var e="true"===a.disabled;e&&(c.disabled=e)}var e=d("<select />",{"class":"motopress-property-icon-picker",
name:b}),f="";for(b in a.list)var g=a.list[b],f=f+('<option value="'+g["class"]+'" data-value="'+b+'" >'+g.label+"</option>");e.get(0).innerHTML=f;this.setAttrs(e,a,c);return e},createDateTimePicker:function(a,b){var c=d("<div />",{"class":"motopress-property-datetime-picker"}),e=d("<div />",{"class":"form-group"}),f=d("<div />",{"class":"input-group date motopress-property-datetime-picker-wrapper "});a.readonly="readonly";var g=this.createInput(a,b,void 0,"datetime-picker-input form-control"),h=
d("<span />",{"class":"input-group-addon motopress-property-datetime-picker-button"}),k=d("<span />",{"class":"motopress-calendar-icon fa fa-calendar"}),h=h.append(k);e.append(f.append(g,h));c.append(e);this.setAttrs(c,a,{});return c},createStyleEditor:function(a,b){var c=d("<div />",{"class":"motopress-property-style-editor-wrapper"}),e=this.createInput({});c.append(e);this.setAttrs(c,a,{});return c},createComplexCtrl:function(a,b){var c=d("<div />",{"class":"motopress-property-complex"}),e=d("<div />",
{"class":"motopress-property-inner-form"});c.append(e);this.setAttrs(c,a,{});return c},setAttrs:function(a,b,c){"object"!==m(b)&&(b={});d.each(c,function(c,d){"undefined"!==typeof b[c]?a.attr(c,b[c]):null!==d&&a.attr(c,d)})}},{})})(jQuery);(function(d){CE.ControlsForm=can.Control.extend({},{form:null,init:function(a,b){this.beforeInit();this.setupDeps(b);this.generate()},restoreClone:function(a){this.setupDeps(a);a.formsMainCtrl.groupItemName&&this.regenerateGroupControl(a.formsMainCtrl.groupItemName)},
setupDeps:function(a){this.formsMainCtrl=a.formsMainCtrl;this.detectForm();this.detectShortcode(a.hasOwnProperty("shortcode")?a.shortcode:!1)},beforeInit:function(){},detectForm:function(){this.form=this.element},detectShortcode:function(a){this.setShortcode(!1===a?this.formsMainCtrl.shortcode:a);this.shortcodeGroup=IframeCE.Shortcode.getShortcodeGroup(this.shortcode);this.shortcodeName=IframeCE.Shortcode.getShortcodeName(this.shortcode)},setShortcode:function(a){this.shortcode=a},generate:function(){var a=
this.getAttrs(),b=this.getGeneralAttrs();b&&(a=this.generatePropertiesControls(b,a),this.form.append(a))},changeProperty:function(a){throw Error("Must be implemented by subclass!");},getGeneralAttrs:function(){throw Error("Must be implemented by subclass!");},getAttrs:function(){throw Error("Must be implemented by subclass!");},save:function(){throw Error("Must be implemented by subclass!");},display:function(a){throw Error("Must be implemented by subclass!");},generatePropertiesControls:function(a,
b){var c=this,e,f,g,h,k,n,m=[];d.each(a,function(a,l){e=parent.MP.Utils.uniqid();l.value=b.hasOwnProperty(a)&&b[a].hasOwnProperty("value")?b[a].value:l["default"];g=CE.CtrlTemplates.createLegend(l.legend);h=CE.CtrlTemplates.createLabel(l.label);n=l.description;l.hasOwnProperty("additional_description")&&(n+=" "+l.additional_description);k=CE.CtrlTemplates.createDescription(n);var p=d("<div />",{"data-motopress-parameter":a,"data-motopress-disabled":l.disabled}),q={name:a,propLabel:l.label,dependency:l.hasOwnProperty("dependency")?
l.dependency:!1,disabled:"true"===l.disabled,isNew:c.formsMainCtrl.isNew,shortcode:c.formsMainCtrl.shortcode,formCtrl:c};switch(l.type){case "text":f=CE.CtrlTemplates.createInput(l,a);f.ce_ctrl_input(d.extend(q,{}));p.append(g,h,f,k);break;case "text-hidden":f=CE.CtrlTemplates.createInput(l,a,"hidden");f.ce_ctrl_input(d.extend(q,{}));p.append(f);break;case "link":f=CE.CtrlTemplates.createLink(l,a);f.ce_ctrl_link(d.extend(q,{}));p.append(g,h,f,k);break;case "spinner":f=CE.CtrlTemplates.createInput(l,
a,null,"spinner");f.ce_ctrl_spinner(d.extend(q,{min:l.min,max:l.max,step:l.step}));p.append(g,h,f,k);break;case "longtext":f=CE.CtrlTemplates.createTextarea(l);f.ce_ctrl_textarea(d.extend(q,{}));p.append(g,h,f,k);break;case "longtext64":f=CE.CtrlTemplates.createTextarea(l);f.ce_ctrl_textarea64(d.extend(q,{}));p.append(g,h,f,k);break;case "longtext-table":f=CE.CtrlTemplates.createTextarea(l);f.ce_ctrl_textarea_table(d.extend(q,{}));p.append(g,h,f,k);break;case "longtext-tinymce":f=CE.CtrlTemplates.createTextareaTinyMCE(l);
f.ce_ctrl_textarea_tinymce(d.extend(q,{currentShortcode:c.formsMainCtrl.element}));p.append(g,h,f,k);break;case "image":l.src=l.value;f=CE.CtrlTemplates.createImage(l);f.ce_ctrl_image(d.extend(q,{autoOpen:l.autoOpen,pseudoRender:"parallax_image"!==a||"mp_row"!==c.shortcodeName&&"mp_row_inner"!==c.shortcodeName?!1:!0}));p.append(g,h,f,k);break;case "image-src":l.src=l.value;f=CE.CtrlTemplates.createImage(l);f.ce_ctrl_image(d.extend(q,{returnMode:"src",autoOpen:l.autoOpen,pseudoRender:"parallax_image"!==
a||"mp_row"!==c.shortcodeName&&"mp_row_inner"!==c.shortcodeName?!1:!0}));p.append(g,h,f,k);break;case "audio":f=CE.CtrlTemplates.createMedia(l);var t=c.formsMainCtrl.child.attr("data-audio-title");f.ce_ctrl_audio(d.extend(q,{audioTitle:t}));p.append(g,h,f,k);break;case "media":var t="undefined"===typeof l.returnMode||-1===d.inArray(l.returnMode,["id","url"])?"url":l.returnMode,s=l.value;f=CE.CtrlTemplates.createMedia(l);f.ce_ctrl_media(d.extend(q,{returnMode:t,value:s}));p.append(g,h,f,k);break;case "media-video":f=
CE.CtrlTemplates.createMedia(l);f.ce_ctrl_media_video(d.extend(q,{}));p.append(g,h,f,k);break;case "multi-images":f=CE.CtrlTemplates.createButton(l,null,"default");f.ce_ctrl_image_slider(d.extend(q,{autoOpen:l.autoOpen}));p.append(g,h,f,k);break;case "video":f=CE.CtrlTemplates.createVideo(l,a);f.ce_ctrl_video(d.extend(q,{}));p.append(g,h,f,k);break;case "checkbox":f=CE.CtrlTemplates.createCheckbox(l);f.ce_ctrl_checkbox(d.extend(q,{}));h.addClass("motopress-property-checkbox-label");p.append(g,f,h,
k);break;case "group-checkbox":f=CE.CtrlTemplates.createCheckbox(l);f.ce_ctrl_group_checkbox(d.extend(q,{}));h.addClass("motopress-property-checkbox-label");p.append(g,f,h,k);break;case "select":f=CE.CtrlTemplates.createSelect(l);f.ce_ctrl_select(d.extend(q,{}));p.append(g,h,f,k);break;case "select-multiple":f=CE.CtrlTemplates.createSelectMultiple(l);f.ce_ctrl_select_multiple(d.extend(q,{}));p.append(g,h,f,k);break;case "color-select":f=CE.CtrlTemplates.createColorSelect(l);f.ce_ctrl_select(d.extend(q,
{}));p.append(g,h,f,k);break;case "editor-button":f=CE.CtrlTemplates.createButton(l,null,"default");f.ce_ctrl_editor_button(d.extend(q,{}));p.append(g,h,f,k);break;case "color-picker":f=CE.CtrlTemplates.createColorPicker(l,a);f.ce_ctrl_color_picker(d.extend(q,{}));p.append(g,h,f,k);break;case "group":t=c.formsMainCtrl.shortcode.control(IframeCE.Controls);s=l.contains;t.setGroupItemName(a);t.setChildName(s);l.hasOwnProperty("activeParameter")&&l.activeParameter&&t.setActiveParameter(l.activeParameter);
f=CE.CtrlTemplates.createGroup(l);f.children(".motopress-property-group-accordion");f.ce_ctrl_group(d.extend(q,{currentSpan:c.formsMainCtrl.element,label:l.hasOwnProperty("items")?l.items.label:null,rules:l.hasOwnProperty("rules")?l.rules:null,events:l.hasOwnProperty("events")?l.events:null,activeParameter:l.hasOwnProperty("activeParameter")?l.activeParameter:null}));c.formsMainCtrl.shortcode.attr("data-motopress-wrap-render","true");p.attr("data-motopress-grouped","true");p.append(g,h,f,k);break;
case "slider":f=CE.CtrlTemplates.createSlider(l);f.ce_ctrl_slider(d.extend(q,{min:"undefined"===typeof l.min||isNaN(l.min)?0:l.min,max:"undefined"===typeof l.max||isNaN(l.max)?100:l.max,step:"undefined"===typeof l.step||isNaN(l.step)?1:l.step,value:l.value}));p.append(g,h,f,k);break;case "radio-buttons":f=CE.CtrlTemplates.createRadioButtons(l);f.ce_ctrl_radio_buttons(d.extend(q,{value:l.value}));p.append(g,h,f,k);break;case "icon-picker":f=CE.CtrlTemplates.createIconPicker(l);f.ce_ctrl_icon_picker(d.extend(q,
{value:l.value}));p.append(g,h,f,k);break;case "datetime-picker":t="undefined"===typeof l.returnMode?"YYYY-MM-DD H:m:s":l.returnMode;s="undefined"===typeof l.displayMode||-1===d.inArray(l.displayMode,["date","datetime"])?"datetime":l.displayMode;f=CE.CtrlTemplates.createDateTimePicker(l);f.ce_ctrl_date_time_picker(d.extend(q,{value:l.value,returnMode:t,displayMode:s}));p.append(g,h,f,k);break;case "margin":f=CE.CtrlTemplates.createMargin(l);f.ce_ctrl_margin(d.extend(q,{margin:l}));p.append(g,h,f,
k);break;case "select2":f=CE.CtrlTemplates.createInput(l,a);f.ce_ctrl_select2(d.extend(q,{}));p.append(g,h,f,k);break;case "style_editor":f=CE.CtrlTemplates.createInput(l,a);f.ce_ctrl_style_editor(d.extend(q,{}));p.append(g,h,f,k);break;case "gradient-picker":f=CE.CtrlTemplates.createComplexCtrl(l,a),f.ce_ctrl_gradient(d.extend(q,{})),p.append(g,h,f,k)}f.control(CE.Ctrl).afterInit();m.push(p);if(l.hasOwnProperty("disabled")&&"true"===l.disabled){var u=null,u="group"===l.type?f.find("> .motopress-property-button-wrapper > .motopress-property-disabled"):
d("<div />",{"class":"motopress-property-disabled"}).appendTo(p);u.data("popover")||u.mppopover({placement:"top",trigger:"manual",container:p,content:localStorage.getItem("CELiteTooltipText")});u.on("click",function(){d(this).mppopover("show");var a=setTimeout(function(){u.mppopover("hide");clearTimeout(a)},2E3)})}f.addClass("motopress-controls");f.attr("id",e);h.attr("for",e)});return m},resolveDependencies:function(){var a=this,b,c;d.each(this.getGeneralAttrs(),function(d,f){b=a.getCtrlByName(d);
b.dependency&&(c=a.getCtrlByName(b.dependency.parameter),c.name===b.dependency.parameter&&(b.isShouldBeHiddenByDependency()?b.hide():b.show()))})},getParameterElByName:function(a){a=this.form.find('> [data-motopress-parameter="'+a+'"] > .motopress-controls, > [data-motopress-parameter="'+a+'"] > :not(".motopress-property-legend, .motopress-property-label, .motopress-property-description, hr") > .motopress-controls');return a.length?a:!1},getCtrlByName:function(a){return(a=this.getParameterElByName(a))?
a.control(CE.Ctrl):!1}})})(jQuery);(function(d){CE.ControlsForm("CE.SettingsControlsForm",{},{init:function(a,b){this._super(a,b)},restoreClone:function(a){this._super(a)},getGeneralAttrs:function(){return CE.WidgetsLibrary.myThis.getParametersAttrs(this.shortcodeGroup,this.shortcodeName)},getAttrs:function(){var a=this.shortcode.attr("data-motopress-parameters");return a?d.parseJSON(a):!1},setAttrs:function(a){this.shortcode.attr("data-motopress-parameters",JSON.stringify(a))},setDefaultAttrs:function(a){if(null!==
a){a=d.parseJSON(a);var b=this.getGeneralAttrs(),c=this;d.each(a,function(a,d){"undefined"!==typeof d.value&&d.value||(b[a].hasOwnProperty("saveInContent")&&"true"===b[a].saveInContent?c.shortcode.attr("data-motopress-content",b[a]["default"]):d.value=b[a]["default"])});this.setAttrs(a);return JSON.stringify(a)}return a},regenerateGroupControl:function(a){var b=this.getAttrs();if(b){var c=this.getGeneralAttrs(),d={};d[a]=c[a];b=this.generatePropertiesControls(d,b);this.form.append(b)}b=this.form.children('[data-motopress-parameter="'+
a+'"]:first');a=this.form.children('[data-motopress-parameter="'+a+'"]:last');b.replaceWith(a)},changeProperty:function(a){this.save(a)},save:function(a){if("undefined"!==typeof a&&"undefined"!==typeof a.name){var b=this.getAttrs();if(b){var c=this.getGeneralAttrs()[a.name],d=a.get();c.hasOwnProperty("saveInContent")&&"true"===c.saveInContent?this.shortcode.attr("data-motopress-content",d):b[a.name].value=void 0!==d&&"string"===typeof d?d.replace(new RegExp(/"/g),"'").replace(new RegExp(/[\[\]]/g),
""):d;this.setAttrs(b);this.formsMainCtrl.renderShortcode();if("mp_row"===this.shortcodeName||"mp_row_inner"===this.shortcodeName){switch(a.name){case "bg_media_type":this.setRowMediaBG(d);break;case "parallax_image":case "parallax_bg_size":this.setRowParallaxBGSize();break;case "bg_video_youtube":case "bg_video_youtube_cover":this.clearRowMediaBG(this.shortcode);this.renderYoutubeBG();break;case "bg_video_webm":case "bg_video_mp4":case "bg_video_ogg":case "bg_video_cover":this.clearRowMediaBG(this.shortcode);
this.renderHTML5VideoBG();break;case "stretch":(b=this.getStretchClassByValue(d))?this.setRowWidth(b):this.clearRowWidth();parent.MP.Editor.triggerIfr("Resize");break;case "width_content":b=this.getContentWidthClassByValue(d);this.setRowWidth(b);parent.MP.Editor.triggerIfr("Resize");break;case "full_height":"true"===d?this.shortcode.addClass("mp-row-fullheight"):this.shortcode.removeClass("mp-row-fullheight"),parent.MP.Editor.triggerIfr("Resize")}CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.EntitySettingsChanged.NAME,
new IframeCE.SceneEvents.EntitySettingsChanged(IframeCE.Grid.ENTITIES.ROW,a.propLabel))}}}},getStretchClassByValue:function(a){var b="";switch(a){case "full":a=this.getCtrlByName("width_content").get();b=this.getContentWidthClassByValue(a);break;case "fixed":b="mp-row-fixed-width"}return b},getContentWidthClassByValue:function(a){var b="";switch(a){default:b="mp-row-fullwidth";break;case "full":b="mp-row-fullwidth-content";break;case "fixed":b="mp-row-fixed-width-content"}return b},display:function(a,
b,c){"undefined"===typeof b&&(CE.Panels.SettingsDialog.myThis.settingsTab.children(".motopress-settings-forms").detach(),CE.Panels.SettingsDialog.myThis.settingsTab.html(this.form));var e=this.getAttrs();if(e){var f=this,g=null,h=null,k=this.getGeneralAttrs();if("undefined"!==typeof b){var n={};n[b]=k[b];k=n}var m=null,r=null;d.each(k,function(b,n){g=f.getParameterElByName(b);g.hasClass("motopress-property-group")&&(c&&g.trigger("change",a),g.find(".motopress-property-group-accordion-item").each(function(){d(this).control(CE.ControlsForm).display(a)}),
g.trigger("render",a));r=g.control(CE.Ctrl);n.hasOwnProperty("saveInContent")&&"true"===n.saveInContent?"undefined"!==typeof f.shortcode.attr("data-motopress-content")&&(h=f.shortcode.attr("data-motopress-content").replace(/\[\]/g,"[")):h=e[r.name].value;m=k[r.name]["default"];r.set(h,m,a);g.trigger("customize")});this.resolveDependencies()}},renderYoutubeBG:function(){var a=this,b="undefined"!==typeof this.shortcode.attr("data-motopress-parameters")?this.shortcode.attr("data-motopress-parameters"):
null,b=d.parseJSON(b);d.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"text",data:{action:"motopress_ce_render_youtube_bg",nonce:motopressCE.nonces.motopress_ce_render_youtube_bg,postID:motopressCE.postID,bg_video_youtube:b.bg_video_youtube.value,bg_video_youtube_cover:b.bg_video_youtube_cover.value,bg_video_youtube_repeat:b.bg_video_youtube_repeat.value,bg_video_youtube_mute:b.bg_video_youtube_mute.value},success:function(b){a.shortcode.addClass("mp-row-video").children(".mpce-row-tools-wrapper").before(b);
parent.MP.Editor.triggerIfr("RenderRowYoutubeBG",a.shortcode)},error:function(a){console.log(a)}})},renderHTML5VideoBG:function(){var a=this,b="undefined"!==typeof this.shortcode.attr("data-motopress-parameters")?this.shortcode.attr("data-motopress-parameters"):null,b=d.parseJSON(b);d.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"text",data:{action:"motopress_ce_render_video_bg",nonce:motopressCE.nonces.motopress_ce_render_video_bg,postID:motopressCE.postID,bg_video_mp4:b.bg_video_mp4.value,
bg_video_webm:b.bg_video_webm.value,bg_video_ogg:b.bg_video_ogg.value,bg_video_cover:b.bg_video_cover.value,bg_video_mute:b.bg_video_mute.value,bg_video_repeat:b.bg_video_repeat.value},success:function(b){a.shortcode.addClass("mp-row-video").children(".mpce-row-tools-wrapper").before(b);parent.MP.Editor.triggerIfr("RenderRowVideoBG",a.shortcode)},error:function(a){console.log(a)}})},setRowWidth:function(a){this.clearRowWidth();this.shortcode.addClass(a)},clearRowWidth:function(){this.shortcode.removeClass("mp-row-fullwidth mp-row-fullwidth-content mp-row-fixed-width mp-row-fixed-width-content");
this.shortcode.css({width:"","padding-left":"","margin-left":"","padding-right":"","margin-right":""})},setRowMediaBG:function(a){this.clearRowMediaBG(this.shortcode);switch(a){case "video":this.renderHTML5VideoBG();break;case "youtube":this.renderYoutubeBG();break;case "parallax":a=this.form.find('[data-motopress-parameter="parallax_image"] [data-full-src]').length?this.form.find('[data-motopress-parameter="parallax_image"] [data-full-src]').attr("data-full-src"):null,this.shortcode.addClass("motopress-row-parallax").attr("data-stellar-background-ratio",
.5),a&&this.shortcode.css("background-image","url('"+a+"')"),this.setRowParallaxBGSize(),CE.Iframe.$.stellar("refresh")}},clearRowMediaBG:function(a){a.children(".mp-video-container").remove();a.removeClass("mp-row-video motopress-row-parallax").css("background-image","").css("background-position","").css("background-size","");a.removeAttr("data-stellar-background-ratio").removeData("stellarBackgroundIsActive stellarBackgroundRatio stellarBackgroundStartingLeft stellarBackgroundStartingTop");CE.Iframe.$.stellar("refresh")},
setRowParallaxBGSize:function(){var a=this.getCtrlByName("parallax_bg_size").get();this.shortcode.css("background-size",void 0===a||"normal"===a?"":a)}})})(jQuery);(function(d){CE.SettingsControlsForm("CE.SettingsControlsChildForm",{},{init:function(a,b){this._super(a,b);this.parentFormCtrl=b.parentFormCtrl;this.groupCtrl=b.groupCtrl},restoreClone:function(a){this._super(a);this.parentFormCtrl=a.parentFormCtrl;this.groupCtrl=a.groupCtrl},changeProperty:function(a){this.save(a);this.groupCtrl.element.trigger("change")},
setDefaultAttrs:function(a){if(null!==a){a=d.parseJSON(a);var b=this.getGeneralAttrs(),c=this;d.each(a,function(a,d){"undefined"!==typeof d.value&&d.value||("mp_tab"===c.shortcodeName&&"id"===a?d.value=parent.MP.Utils.uniqid():b[a].hasOwnProperty("saveInContent")&&"true"===b[a].saveInContent?c.shortcode.attr("data-motopress-content",b[a]["default"]):d.value=b[a]["default"])});this.setAttrs(a);return JSON.stringify(a)}return a},detectForm:function(){this.form=this.element.children(".motopress-property-group-accordion-item-content")},
save:function(a){if("undefined"!==typeof a&&"undefined"!==typeof a.name){var b=this.getAttrs();if(b){var c=this.getGeneralAttrs()[a.name],d=a.get();c.hasOwnProperty("saveInContent")&&"true"===c.saveInContent?this.shortcode.attr("data-motopress-content",d):b[a.name].value=void 0!==d&&"string"===typeof d?d.replace(new RegExp(/"/g),"'").replace(new RegExp(/[\[\]]/g),""):d;this.setAttrs(b)}}},display:function(a,b){var c=this.getAttrs();if(c){var e=this,f=null,g=this.getGeneralAttrs();if("undefined"!==
typeof b){var h={};h[b]=g[b];g=h}var k=null,n=null;d.each(g,function(b,d){n=e.getCtrlByName(b);d.hasOwnProperty("saveInContent")&&"true"===d.saveInContent?"undefined"!==typeof e.shortcode.attr("data-motopress-content")&&(f=e.shortcode.attr("data-motopress-content").replace(/\[\]/g,"[")):f=c[n.name].value;"id"===b&&"mp_accordion_item"===e.shortcodeName&&"undefined"===typeof f&&(f=e.shortcode.find(".motopress-accordion-item").attr("id"));k=g[n.name]["default"];n.set(f,k,a)});this.resolveDependencies()}}})})(jQuery);
(function(d){CE.ControlsForm("CE.StyleControlsForm",{},{init:function(a,b){this._super(a,b)},restoreClone:function(a){this._super(a)},changeProperty:function(a){this.save(a);d("body").trigger("MPCEObjectStyleChanged",{objElement:this.shortcode,objName:this.shortcodeName})},getGeneralAttrs:function(){return CE.WidgetsLibrary.myThis.getStyleAttrs(this.shortcodeGroup,this.shortcodeName)},getAttrs:function(){var a=this.shortcode.attr("data-motopress-styles");return a?(a=d.parseJSON(a),!this.formsMainCtrl.isGrid&&
a.hasOwnProperty("margin")&&d.isEmptyObject(a.margin)&&(a=this.fixMarginValue(a)),a):!1},fixMarginValue:function(a){if(this.formsMainCtrl.child.length){var b=this.getGeneralAttrs(),c=b.margin["default"].slice(),e=this.formsMainCtrl.child.prop("class").split(" ").filter(function(a){return b.margin.regExp.test(a)});e.length&&(d.each(e,function(a,e){var h=e.match(b.margin.regExp),k=h[1],n=parseInt(h[2]);"undefined"===typeof k?d.each(c,function(a,d){n!==b.margin["default"][a]&&(c[a]=n)}):(h=d.inArray(k,
b.margin.sides),-1!==h&&(c[h]=n))}),a.margin.value=c.join(","),this.setAttrs(a),a=this.getAttrs())}return a},setAttrs:function(a){this.shortcode.attr("data-motopress-styles",JSON.stringify(a))},setDefaultAttrs:function(a){a="undefined"===typeof a?this.getAttrs():d.parseJSON(a);var b=CE.WidgetsLibrary.myThis.getStyleAttrs(this.shortcodeGroup,this.shortcodeName);d.each(a,function(a,e){if("undefined"===typeof e.value||!e.value){var f=b[a]["default"];switch(b[a].type){case "margin":var g=!0;d.each(b[a]["default"],
function(d,e){e!==b[a].values[0]&&(g=!1)});f=g?"":f.join(",");break;case "select2":var h=[];b.mp_style_classes.hasOwnProperty("default")&&d.each(b.mp_style_classes["default"],function(a,b){h.push(b)});f=h.join(" ")}e.value=f}});this.setAttrs(a);return JSON.stringify(a)},display:function(a){CE.Panels.SettingsDialog.myThis.styleTab.children(".motopress-style-forms").detach();CE.Panels.SettingsDialog.myThis.styleTab.html(this.form);this._setValuesToCtrls(a)},_setValuesToCtrls:function(a){var b=this.getAttrs();
if(b){var c=this,e=null,f=null,g=null,h=null,k=this.getGeneralAttrs();d.each(b,function(d,m){f=c.getParameterElByName(d);e=f.control(CE.Ctrl);g=b[e.name].value;h=k[e.name]["default"];e.set(g,h,a);f.trigger("customize")});this.resolveDependencies()}},save:function(a){var b=this.getAttrs();if(b)if("undefined"===typeof a&&this.formsMainCtrl.isGrid){var c=this;d.each(b,function(d){a=c.getCtrlByName(d);c._save(b,a,!1)})}else this._save(b,a),IframeCE.Resizer.myThis.updateAllHandles(),d(window).trigger("resize")},
getTargetElement:function(a){var b=null;this.formsMainCtrl.isGrid?b=this.shortcode:this.formsMainCtrl.child.length&&(b=this.formsMainCtrl.child);"mp_style_classes"!==a.name&&"mp_custom_style"!==a.name||!CE.WidgetsLibrary.myThis.getObject(this.shortcodeGroup,this.shortcodeName).styles[a.name].hasOwnProperty("selector")||(a=CE.WidgetsLibrary.myThis.getObject(this.shortcodeGroup,this.shortcodeName).styles[a.name].selector,!1===a?b=null:a.length&&(b=b.find(a)));return b},_save:function(a,b,c){"undefined"===
typeof c&&(c=!0);var e=a[b.name].value,f=c?b.get():e;c&&(a[b.name].value=f,this.setAttrs(a));a=this.getTargetElement(b);switch(b.name){case "margin":var g=b.getClasses(e);g.length&&(e=g);b=b.getClasses(f);b.length&&(f=b);break;case "mp_style_classes":if(!c&&!d.isEmptyObject(b.options.style.basic)){var h="";d.isArray(b.options.style.basic)?d.each(b.options.style.basic,function(a,b){h+=b["class"]+" "}):h=b.options.style.basic["class"]+" ";f=h+f}}null!==a&&a.length&&(c&&a.removeClass(e),a.addClass(f))}})})(jQuery);
(function(d){CE.ControlsForm("CE.StyleEditorControlsForm",{},{emptyStyleValue:"",editedStyleObj:null,loadedAttrs:{},styleEditorCtrl:null,propertiesWrapper:null,statesWrapper:null,actionsWrapper:null,state:null,displayed:!1,switcher:!1,stateClsName:"motopress-ce-style-editor-state-active",subStateClsName:"motopress-ce-style-editor-sub-state-active",beforeInit:function(){this._super();this.generateStatesWrapper();this.generatePropertiesWrapper();this.generateActionsWrapper()},init:function(a,b){this.styleEditorCtrl=
b.styleEditorCtrl;this.switcher=b.switcher;this._super(a,b)},generateStatesWrapper:function(){var a=this;this.statesWrapper=d("<div />",{"class":"motopress-ce-style-editor-states-wrapper"});this.statesWrapper.append(d("<a />",{href:"#","data-state":"up",title:localStorage.getItem("CEDesktopStyle")}),d("<a />",{href:"#","data-state":"tablet",title:localStorage.getItem("CETabletStyle")}),d("<a />",{href:"#","data-state":"mobile",title:localStorage.getItem("CEMobileStyle")}),d("<a />",{href:"#","data-state":"hover",
title:localStorage.getItem("CEHoverStyle")}));this.statesWrapper.children("a").on("click",function(b){b.preventDefault();b=d(this).attr("data-state");"hover"===b?a.setState(b):a.switcher.setMode(a.getStyleModeByState(b))});this.element.append(this.statesWrapper)},getStyleModeByState:function(a){return"up"===a?this.switcher.DESKTOP:a},getStateByStyleMode:function(a){return a===this.switcher.DESKTOP?"up":a},generatePropertiesWrapper:function(){this.propertiesWrapper=d("<div />",{"class":"motopress-ce-style-editor-properties-wrapper"});
this.element.append(this.propertiesWrapper)},generateActionsWrapper:function(){var a=this;this.actionsWrapper=d("<div />",{"class":"motopress-ce-style-editor-actions-wrapper"});var b=d("<button />",{"class":"motopress-ce-style-editor-apply-button btn",text:localStorage.getItem("CEApply")}).on("click",function(b){b.preventDefault();a.confirm()}),c=d("<ul />",{"class":"dropdown-menu"});d.each(this.generateActionButtons(),function(a,b){d("<li />").append(b).appendTo(c)});b=d("<div />",{"class":"btn-group motopress-bootstrap-dropdown motopress-dropdown-button dropup"}).append(b,
'<button class="dropdown-toggle btn" data-toggle="dropdown"><span class="caret"></span></button>',c);this.actionsWrapper.append(b);this.element.append(this.actionsWrapper);b.on("keydown",function(a){a.stopPropagation()})},generateActionButtons:function(){var a=this;return[d("<a />",{href:"#","class":"motopress-ce-style-editor-cancel-button",text:localStorage.getItem("CECancel")}).on("click",function(b){b.preventDefault();a.cancel()})]},generate:function(){var a=this.getGeneralAttrs(),a=this.generatePropertiesControls(a,
{});this.form.append(a)},detectForm:function(){this.form=this.propertiesWrapper},display:function(a){this.displayed||(this.displayed=!0,this.listenToStyleSwitcher());a=this.getStateByStyleMode(this.switcher.getCurMode());this.attachForm();a=this.highlightState(a);this.rememberSettings();a=this.getStateAttrs(a);this.fillForm(a,"customize");this.resolveDependencies();this.show()},listenToStyleSwitcher:function(){CE.EventDispatcher.Dispatcher.addListener(CE.StyleModeEvents.Switched.NAME,this.proxy("styleModeSwitched"))},
styleModeSwitched:function(a){a=a.getSwitcher();a=this.getStateByStyleMode(a.getCurMode());this.setState(a)},attachForm:function(){CE.Panels.SettingsDialog.myThis.styleEditorContainer.children().detach();CE.Panels.SettingsDialog.myThis.styleEditorContainer.html(this.element)},getState:function(){return this.state},setState:function(a){a=this.highlightState(a);this.fillForm(this.getStateAttrs(a),!1)},highlightState:function(a){"hover"===a?this.highlightHoverState(a):this.highlightNormalState(a);return this.getState()},
highlightNormalState:function(a){var b=this.statesWrapper.children("a");b.removeClass(this.stateClsName).removeClass(this.subStateClsName);b.filter('[data-state="'+a+'"]').addClass(this.stateClsName);this.state=a;this.styleEditorCtrl.unsetStatePreview()},highlightHoverState:function(a){var b=this.statesWrapper.children('a[data-state="hover"]');b.hasClass(this.subStateClsName)?this.highlightNormalState(this.getStateByStyleMode(this.switcher.getCurMode())):(b.addClass(this.subStateClsName),this.state=
a,this.styleEditorCtrl.setStatePreview(a))},setEditedStyleObj:function(a){this.editedStyleObj=a},rememberSettings:function(){this.loadedAttrs=this.editedStyleObj.getSettings()},getFormValues:function(){var a,b,c={},e=this,f=this.getGeneralAttrs();d.each(f,function(d,f){a=e.getCtrlByName(d);a.isHided()||(b=a.get(),b=e.filterValue(d,b),b!==e.emptyStyleValue&&(c[d]=b))});c.hasOwnProperty("background-image-type")&&"none"!==c["background-image-type"]&&(c.hasOwnProperty("background-gradient")||c.hasOwnProperty("background-image")||
delete c["background-image-type"]);return c},getEmptyValues:function(){var a=this.getGeneralAttrs(),b=this;return d.map(a,function(){return b.emptyStyleValue})},getCleanFormValues:function(a){var b=this.getFormValues();a=this.getInheritValues(a);var c=parent.MP.Utils.getObjectChanges(a,b),e=this;d.each(c,function(a,d){e.preventLossDependencyValues(a,c,b)});return c},preventLossDependencyValues:function(a,b,c){a=this.getCtrlByName(a);a.dependency&&a.dependency.hasOwnProperty("needDependenceValue")&&
a.dependency.needDependenceValue&&!b.hasOwnProperty(a.dependency.parameter)&&(b[a.dependency.parameter]=c[a.dependency.parameter],this.preventLossDependencyValues(a.dependency.parameter,b,c))},filterValue:function(a,b){switch(a){case "padding-top":case "padding-bottom":case "padding-left":case "padding-right":case "border-top-width":case "border-bottom-width":case "border-left-width":case "border-right-width":case "border-top-left-radius":case "border-top-right-radius":case "border-bottom-left-radius":case "border-bottom-right-radius":b=
b.replace(/[^0-9]/gi,"");break;case "margin-top":case "margin-bottom":case "margin-left":case "margin-right":b=b.replace(/[^0-9-]/gi,"");break;case "background-position-x":case "background-position-y":null===b&&(b="")}return b},fillForm:function(a,b){var c=this,e,f,g,h,k=this.getGeneralAttrs();d.each(k,function(d,m){e=c.getParameterElByName(d);f=e.control(CE.Ctrl);h=k[f.name].hasOwnProperty("default")?k[f.name]["default"]:c.emptyStyleValue;g=a.hasOwnProperty(d)?a[d]:h;f.set(g,h,!1);b&&e.trigger(b)});
this.resolveDependencies()},changeProperty:function(a){this.save();this.styleEditorCtrl.element.trigger("change")},save:function(){var a=this.getState(),b=this.getCleanFormValues(a);this.editedStyleObj.updateState(a,b)},getTitle:function(){return""},show:function(){CE.Panels.SettingsDialog.myThis.setMode("style-editor");this.propertiesWrapper.scrollTop(0)},hide:function(){CE.Panels.SettingsDialog.myThis.setMode("tabs");this.styleEditorCtrl.unsetStatePreview()},cancel:function(){this.editedStyleObj.update(this.loadedAttrs);
this.styleEditorCtrl.element.trigger("change");this.hide()},confirm:function(){this.styleEditorCtrl.element.trigger("change");this.hide();can.Object.same(this.loadedAttrs,this.editedStyleObj.getSettings())||this.confirmed()},confirmed:function(){}})})(jQuery);(function(d){CE.StyleEditorControlsForm("CE.PrivateStyleControlsForm",{},{presetStyleObj:null,init:function(a,b){this._super(a,b);this.editedStyleObj=b.editedStyleObj},setPresetStyleObj:function(a){this.presetStyleObj=a},generateActionButtons:function(){var a=
this,b=this._super(),c=[d("<a />",{href:"#","class":"motopress-ce-style-editor-save-button",text:localStorage.getItem("CESaveAs")}).on("click",function(b){b.preventDefault();a.saveAsPreset()}),d("<a />",{href:"#","class":"motopress-ce-style-editor-clear-button",text:localStorage.getItem("CEClear")}).on("click",function(b){b.preventDefault();a.clear()})];return d.merge(c,b)},getGeneralAttrs:function(){return parent.CE.WidgetsLibrary.myThis.getPrivateStyleAttrs(this.shortcodeGroup,this.shortcodeName)},
getPrivateStateAttrs:function(a){return this.editedStyleObj.getStateSettings(a)},getPresetStateAttrs:function(a){return null!==this.presetStyleObj?this.presetStyleObj.getStateSettings(a):{}},getStateAttrs:function(a){"undefined"===typeof a&&(a=this.getState());var b={};switch(a){case "up":d.extend(b,this.getPresetStateAttrs("up"),this.getPrivateStateAttrs("up"));break;case "hover":d.extend(b,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("hover"),this.getPrivateStateAttrs("up"),this.getPrivateStateAttrs("hover"));
break;case "tablet":d.extend(b,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPrivateStateAttrs("up"),this.getPrivateStateAttrs("tablet"));break;case "mobile":d.extend(b,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPresetStateAttrs("mobile"),this.getPrivateStateAttrs("up"),this.getPrivateStateAttrs("tablet"),this.getPrivateStateAttrs("mobile"))}return b},resetForm:function(){this.fillForm(this.getStateAttrs(),!1);this.styleEditorCtrl.element.trigger("change")},
getInheritValues:function(a){var b={},c=this.getEmptyValues();switch(a){case "up":d.extend(b,c,this.getPresetStateAttrs("up"));break;case "hover":d.extend(b,c,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("hover"),this.getPrivateStateAttrs("up"));break;case "tablet":d.extend(b,c,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPrivateStateAttrs("up"));break;case "mobile":d.extend(b,c,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPresetStateAttrs("mobile"),
this.getPrivateStateAttrs("tablet"),this.getPrivateStateAttrs("up"))}return b},saveAsPreset:function(a,b){var c=this;d.when(IframeCE.StyleEditor.myThis.presetSaveModal.showModal(this.editedStyleObj,this.presetStyleObj)).then(function(a){c.styleEditorCtrl.selectPreset(a);c.clear();c.rememberSettings();c.styleEditorCtrl.refresh();parent.CE.Panels.SettingsDialog.myThis.updateTitle()})},clear:function(){this.editedStyleObj.clear();this.resetForm()},getTitle:function(){var a="Element Style";null!==this.presetStyleObj&&
(a+=" (inherit from "+this.presetStyleObj.getLabel()+")");return a},show:function(){this._super()},hide:function(){this._super()},confirmed:function(){var a=this.shortcode.control(IframeCE.Shortcode).shortcodeLabel;CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.EntityStylesChanged.NAME,new IframeCE.SceneEvents.EntityStylesChanged(a,"[Styles]"))}})})(jQuery);(function(d){CE.StyleEditorControlsForm("CE.PresetStyleControlsForm",{},{generateActionButtons:function(){var a=this,b=this._super(),
c=[d("<a />",{href:"#","class":"motopress-ce-style-editor-rename-button",text:localStorage.getItem("CERename")}).on("click",function(b){b.preventDefault();a.renamePreset()}),d("<a />",{href:"#","class":"motopress-ce-style-editor-delete-button",text:localStorage.getItem("CEDelete")}).on("click",function(b){b.preventDefault();a.deletePreset()})];return d.merge(c,b)},getGeneralAttrs:function(){return IframeCE.Style.getStyleEditorProps()},getAttrs:function(){return this.editedStyleObj.getSettings()},
getStateAttrs:function(a){var b={};switch(a){case "up":d.extend(b,this.editedStyleObj.getStateSettings("up"));break;case "hover":d.extend(b,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("hover"));break;case "tablet":d.extend(b,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("tablet"));break;case "mobile":d.extend(b,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("tablet"),this.editedStyleObj.getStateSettings("mobile"))}return b},
getInheritValues:function(a){var b={},c=this.getEmptyValues();switch(a){case "up":d.extend(b,c);break;case "hover":d.extend(b,c,this.editedStyleObj.getStateSettings("up"));break;case "tablet":d.extend(b,c,this.editedStyleObj.getStateSettings("up"));break;case "mobile":d.extend(b,c,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("tablet"))}return b},renamePreset:function(a,b){var c=this.editedStyleObj.getLabel(),d=localStorage.getItem("CERenamePresetPrompt").replace("%presetLabel%",
c),c=prompt(d,c);null!==c&&(c=c.trim(),""!==c?(this.editedStyleObj.setLabel(c),parent.CE.Panels.SettingsDialog.myThis.updateTitle(),this.styleEditorCtrl.refresh(),CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.StylePresetRenamed.NAME,new IframeCE.SceneEvents.StylePresetRenamed(this.editedStyleObj))):(parent.MP.Flash.setFlash(localStorage.getItem("CERenamePresetEmptyError"),"error"),parent.MP.Flash.showMessage()))},deletePreset:function(a,b){var c=this.editedStyleObj.getLabel(),c=localStorage.getItem("CEDeletePresetConfirm").replace("%presetLabel%",
c);confirm(c)&&(IframeCE.StyleEditor.myThis.deletePreset(this.editedStyleObj.getId()),this.styleEditorCtrl.refresh(),this.hide(),CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.StylePresetDeleted.NAME,new IframeCE.SceneEvents.StylePresetDeleted(this.editedStyleObj)))},getTitle:function(){return'Preset "'+this.editedStyleObj.getLabel()+'"'},confirmed:function(){CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.StylePresetChanged.NAME,new IframeCE.SceneEvents.StylePresetChanged(this.editedStyleObj))}})})(jQuery);
(function(d){CE.ControlsForm("CE.ControlsSubForm",{},{parentPropertyCtrl:null,init:function(a,b){this.parentPropertyCtrl=b.parentPropertyCtrl;this._super(a,b)},getGeneralAttrs:function(){return this.parentPropertyCtrl.getParameters()},getAttrs:function(){return{}},save:function(){this.parentPropertyCtrl.element.trigger("change")},display:function(a){var b=this;a=this.getGeneralAttrs();var c;d.each(a,function(a,d){c=b.getParameterElByName(a);c.trigger("customize")})},changeProperty:function(a){this.save()},
set:function(a){var b=this.getGeneralAttrs(),c,e,f=this;d.each(b,function(b,d){c=f.getCtrlByName(b);e=a.hasOwnProperty(b)?a[b]:"";c.set(e)});this.resolveDependencies()},get:function(){var a,b,c={},e=this,f=this.getGeneralAttrs();d.each(f,function(d,f){a=e.getCtrlByName(d);a.isHided()||(b=a.get(),c[d]=b)});return c}})})(jQuery);(function(d){CE.Panels.AbstractDialog.extend("CE.Panels.SettingsDialog",{myThis:null,NAME:"settings"},{dialogClass:"motopress-dialog",wrapper:null,shortcode:null,oldShortcode:null,
dialog:null,minimizeRestoreBtn:d("<button />",{"class":"ui-dialog-titlebar-minimize"}),state:{minimized:"minimized",restored:"restored"},tabs:d("<div />",{"class":"motopress-dialog-tabs"}),settingsTitle:d("<li />"),styleTitle:d("<li />"),settingsTab:d("<div />",{id:"motopress-dialog-settings-tab"}),styleTab:d("<div />",{id:"motopress-dialog-style-tab"}),styleEditorContainer:d("<div />",{id:"motopress-style-editor-container","class":"motopress-hide"}),mode:"tabs",setup:function(a,b){this._super(a,
b);var c=d("<ul />");d("<a />",{href:"#"+this.settingsTab.attr("id"),"class":"motopress-text-no-color-text",text:localStorage.getItem("CESettings")}).append(d("<i />",{"class":"motopress-settings-icon"})).appendTo(this.settingsTitle);d("<a />",{href:"#"+this.styleTab.attr("id"),"class":"motopress-text-no-color-text",text:localStorage.getItem("CEStyle")}).append(d("<i />",{"class":"motopress-style-icon"})).appendTo(this.styleTitle);c.append(this.settingsTitle,this.styleTitle);this.tabs.append(c,this.settingsTab,
this.styleTab).appendTo(this.element);this.styleEditorContainer.appendTo(this.element)},setMode:function(a){switch(a){case "tabs":this.styleEditorContainer.addClass("motopress-hide");this.tabs.removeClass("motopress-hide");break;case "style-editor":this.tabs.addClass("motopress-hide"),this.styleEditorContainer.removeClass("motopress-hide")}this.mode=a;this.updateTitle()},updateTitle:function(){var a=this.shortcode.control(IframeCE.Controls);switch(this.getMode()){case "tabs":this.setTitle(a.shortcodeLabel);
break;case "style-editor":var b=this.styleEditorContainer.children().control(CE.StyleEditorControlsForm);this.setTitle(a.shortcodeLabel+" - "+b.getTitle())}},getMode:function(){return this.mode},init:function(a,b){this._super(a,b);CE.Panels.SettingsDialog.myThis=this;var c=null,e=!1,f=0,g=parent.MP.Utils.version_compare(d.fn.jquery,"1.9.0","<"),h={my:"right-20 top+20",at:"right top",of:window},k=sessionStorage.getItem("motopressDialogWidth");null===k&&(k=300);var n=sessionStorage.getItem("motopressDialogHeight");
null===n&&(n=400);d.ui.dialog.prototype._focusTabbable=function(){};this.element.dialog({autoOpen:!1,closeOnEscape:!0,closeText:"",dialogClass:this.dialogClass,draggable:!0,modal:!1,position:h,resizable:!0,minWidth:280,width:k,minHeight:280,height:n,maxHeight:d(window).height(),create:function(){CE.Panels.SettingsDialog.myThis.dialog=CE.Panels.SettingsDialog.myThis.element.dialog("widget");CE.Panels.SettingsDialog.myThis.wrapper=CE.Panels.SettingsDialog.myThis.element.closest(MP.Utils.convertClassesToSelector(CE.Panels.SettingsDialog.myThis.dialogClass));
c=CE.Panels.SettingsDialog.myThis.dialog;c.on("resizestart",function(a,b){e=d(a.originalEvent.target).hasClass("ui-resizable-n");f=d(document).scrollTop();g&&(e||d(this).css("top",parseInt(d(this).css("top"))-f))});c.on("resize",function(a,b){g&&e&&d(this).css("top",parseInt(d(this).css("top"))-f)});c.on("resizestop",function(a,b){CE.Panels.SettingsDialog.myThis.savePosition(b);CE.Panels.SettingsDialog.myThis.saveSize(b)});d(this).prev(".ui-dialog-titlebar").find(".ui-dialog-titlebar-close").before(CE.Panels.SettingsDialog.myThis.minimizeRestoreBtn);
var a=c.draggable("option","cancel")+", .ui-dialog-titlebar-minimize, .ui-dialog-titlebar-restore";c.draggable("option","cancel",a);CE.Panels.SettingsDialog.myThis.minimizeRestoreBtn.on("click",function(){d(this).hasClass("ui-dialog-titlebar-minimize")?CE.Panels.SettingsDialog.myThis.minimize():CE.Panels.SettingsDialog.myThis.restore()})},dragStart:function(a,b){IframeCE.LeftBar.myThis.disable()},dragStop:function(a,b){CE.Panels.SettingsDialog.myThis.savePosition(b);IframeCE.LeftBar.myThis.enable()},
close:function(){"style-editor"===CE.Panels.SettingsDialog.myThis.getMode()&&CE.Panels.SettingsDialog.myThis.styleEditorContainer.children().control(CE.StyleEditorControlsForm).confirm();CE.Panels.SettingsDialog.myThis.setTitle();IframeCE.Selectable.focusWithoutScroll(IframeCE.Selectable.getFocusAreaBySelected(CE.Panels.SettingsDialog.myThis.shortcode))},open:function(){IframeCE.Selectable.focusWithoutScroll(IframeCE.Selectable.getFocusAreaBySelected(CE.Panels.SettingsDialog.myThis.shortcode));if("minimized"===
sessionStorage.getItem("motopressDialogState"))c.css("left","auto");else{var a=parseInt(sessionStorage.getItem("motopressDialogLeft")),b=parseInt(sessionStorage.getItem("motopressDialogTop")),e=c.width(),f=c.height(),g=d(window).width(),h=d(window).height();f>h&&(f=h,c.height(f));0>b?c.css("top",0):f<h&&b+f>h?c.css("top",h-f):b+f>h?c.css("top",h-f):c.css("top",b);0>a?c.css("left",0):e<g&&a+e>g?c.css("left",g-e):c.css("left",a)}},resizeStart:function(){IframeCE.LeftBar.myThis.disable()},resizeStop:function(){IframeCE.LeftBar.myThis.enable()}});
d(window).on("resize.CE.Panels.SettingsDialog",this.proxy("onResize"));MP.Utils.fixTabsBaseTagConflict(this.tabs,document,location);this.tabs.tabs({activate:function(a,b){CE.Panels.SettingsDialog.myThis.shortcode.attr("data-motopress-dialog-tab",b.newTab.index())}})},_destroy:function(){d(window).off("resize.CE.Panels.SettingsDialog")},onResize:function(a){d(a.target).is(this.element.dialog("widget"))||this.element.dialog("option","maxHeight",d(window).height())},open:function(a){this.oldShortcode=
this.shortcode;this.shortcode=IframeCE.Selectable.myThis.getShortcodeByHandle(a);var b=MP.Utils.isTheSameElement(this.shortcode,this.oldShortcode),c=this.shortcode.control(IframeCE.Controls);if(null!==CE.WidgetsLibrary.myThis.getLibrary()&&"undefined"!==typeof c.group&&"undefined"!==typeof c.shortcodeName&&(a=CE.WidgetsLibrary.myThis.getObject(c.group,c.shortcodeName))){a=d.isEmptyObject(a.parameters);var e=this.isGrid?"gridProps":"props";a&&d.isEmptyObject(IframeCE.Style[e])||(this.setTitle(c.shortcodeLabel),
e=!1,this.shortcode.hasClass("motopress-new-object")&&(e=!0,this.shortcode.removeClass("motopress-new-object")),b||c.display(e),sessionStorage.getItem("motopressDialogState")===this.state.minimized&&this.minimize(),b=a?this.styleTitle.index():this.settingsTitle.index(),c=this.shortcode.attr("data-motopress-dialog-tab"),"undefined"!==typeof c&&(b=c),a?this.tabs.tabs("disable",this.settingsTitle.index()):!1!==this.tabs.tabs("option","disabled")&&this.tabs.tabs("enable",this.settingsTitle.index()),this.tabs.tabs("option",
"active",b),this._super(),this.element.find(".motopress-controls").trigger("dialogOpen"))}},setTitle:function(a){a="undefined"!==typeof a?a:"";"string"===typeof a&&(this.element.dialog("option","title",a),this.element.dialog("widget").find(".ui-dialog-title").attr("title",a))},savePosition:function(a){sessionStorage.setItem("motopressDialogLeft",this.dialog.css("left"));sessionStorage.setItem("motopressDialogTop",this.dialog.css("top"))},saveSize:function(a){sessionStorage.setItem("motopressDialogWidth",
a.size.width);sessionStorage.setItem("motopressDialogHeight",a.size.height)},minimize:function(){this.minimizeRestoreBtn.removeClass("ui-dialog-titlebar-minimize").addClass("ui-dialog-titlebar-restore");sessionStorage.setItem("motopressDialogState",this.state.minimized);this.dialog.removeClass("motopress-dialog-"+this.state.restored).addClass("motopress-dialog-"+this.state.minimized);var a=d(window).width()-this.dialog.width();this.dialog.css("left",a);sessionStorage.setItem("motopressDialogLeft",
this.dialog.css("left"));this.element.dialog("option","draggable",!1)},restore:function(){this.minimizeRestoreBtn.removeClass("ui-dialog-titlebar-restore").addClass("ui-dialog-titlebar-minimize");sessionStorage.setItem("motopressDialogState",this.state.restored);this.element.nextAll().add(this.element).removeClass("motopress-hide");this.dialog.removeClass("motopress-dialog-"+this.state.minimized).addClass("motopress-dialog-"+this.state.restored);this.element.dialog("option","height",400);this.element.dialog({position:{my:"center",
at:"center",of:window}});sessionStorage.setItem("motopressDialogLeft",this.dialog.css("left"));sessionStorage.setItem("motopressDialogTop",this.dialog.css("top"));this.element.dialog("option","draggable",!0)}})})(jQuery);(function(d){CE.PreviewDevice=can.Control.extend({myThis:null},{mode:null,previewClassPrefix:"motopress-ce-device-mode-",init:function(a){CE.PreviewDevice.myThis=this},hide:function(){this.abortShow();this.element.addClass("motopress-content-editor-preview-device-panel-hide").one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",
function(a,b){CE.PreviewDevice.myThis.element.addClass("motopress-hide").removeClass("motopress-content-editor-preview-device-panel-hide")})},isHiding:function(){return this.element.hasClass("motopress-content-editor-preview-device-panel-hide")},show:function(){this.abortHide();this.element.addClass("motopress-content-editor-preview-device-panel-show").removeClass("motopress-hide").one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(a,b){CE.PreviewDevice.myThis.element.removeClass("motopress-content-editor-preview-device-panel-show")})},
abortShow:function(){this.element.removeClass("motopress-content-editor-preview-device-panel-show").off("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd")},abortHide:function(){this.element.removeClass("motopress-content-editor-preview-device-panel-hide").off("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd")},".motopress-content-editor-preview-mode-btn click":function(a,b){this.isHiding()&&(this.show(),CE.Panels.Navbar.myThis.hide());var c=d(a).attr("data-mode");this.preview(c)},
".motopress-content-editor-preview-edit click":function(a,b){this.unsetPreview();this.hide();CE.Panels.Navbar.myThis.show()},preview:function(a){null===this.mode&&(IframeCE.Selectable.myThis.unselect(),IframeCE.StyleEditor.myThis.unsetEmulateCSSMode(),IframeCE.InlineEditor.destroyAll(),IframeCE.Utils.addSceneAction("device-preview"),CE.Iframe.myThis.unsetMinWidth());if(a!==this.mode){var b=null!==this.mode?this.previewClassPrefix+this.mode:"",c=this.previewClassPrefix+a;CE.Iframe.myThis.element.removeClass(b).addClass(c);
CE.Panels.Navbar.myThis.editorWrapperEl.addClass("motopress-ce-full-height");CE.Iframe.myThis.body.removeClass(b).addClass(c);IframeCE.Utils.triggerWindowEvent("resize");this.mode=a}},unsetPreview:function(){var a=this.previewClassPrefix+this.mode;CE.Iframe.myThis.element.removeClass(a);IframeCE.StyleEditor.myThis.setEmulateCSSMode();IframeCE.InlineEditor.reinitAll();CE.Panels.Navbar.myThis.editorWrapperEl.removeClass("motopress-ce-full-height");CE.Iframe.myThis.body.removeClass(a);CE.Iframe.myThis.setMinWidth();
IframeCE.Utils.removeSceneAction("device-preview");this.mode=null}})})(jQuery);(function(d){CE.StyleModeEvents={};CE.StyleModeEvents.Switched=CE.EventDispatcher.Event.extend({NAME:"style_mode.switched"},{switcher:null,init:function(a){this.switcher=a},getSwitcher:function(){return this.switcher}})})(jQuery);(function(d){var a=null,b=null;CE.StyleModeSwitcher=can.Construct.extend({DESKTOP:"desktop",TABLET:"tablet",MOBILE:"mobile",setMode:function(c){b=a;a=c;CE.EventDispatcher.Dispatcher.dispatch(CE.StyleModeEvents.Switched.NAME,
new CE.StyleModeEvents.Switched(this))},getCurMode:function(){return a},getPrevMode:function(){return b},getModeList:function(){return[this.DESKTOP,this.TABLET,this.MOBILE]}},{init:function(b){a=b}})})(jQuery);(function(d){CE.ResponsiveSwitcher=can.Control.extend({},{switcher:null,modeClassPrefix:"mpce-device-mode-",init:function(a,b){this.switcher=b.switcher;this.displayMode(this.switcher.getCurMode());CE.EventDispatcher.Dispatcher.addListener(CE.StyleModeEvents.Switched.NAME,this.proxy("modeSwitched"))},
change:function(a,b){this.switcher.setMode(a.val())},displayMode:function(a){this.element.find('[value="'+a+'"]').attr("selected","selected")},modeSwitched:function(a){var b=this.switcher.getPrevMode();a=this.switcher.getCurMode();a===this.switcher.DESKTOP?CE.Iframe.myThis.setMinWidth():CE.Iframe.myThis.unsetMinWidth();var b=this.modeClassPrefix+b,c=this.modeClassPrefix+a;CE.Iframe.myThis.element.removeClass(b).addClass(c);CE.Iframe.myThis.body.removeClass(b).addClass(c);IframeCE.Utils.triggerWindowEvent("resize");
this.displayMode(a)}})})(jQuery);(function(d){d=can.Construct({},{canSave:function(){throw Error("Must be implemented in sub-class!");},save:function(){throw Error("Must be implemented in sub-class!");}});var a=d.extend({},{navbar:null,init:function(){MP.Editor.one("SceneInited",this.proxy(function(){this.navbar=CE.Panels.Navbar.myThis}))},canSave:function(){return!0},save:function(){this.navbar.save.apply(this.navbar,arguments)}}),b=d.extend({},{revision:null,init:function(){MP.Editor.one("SceneInited",
this.proxy(function(){MP.Editor.oneIfr("WPRevision.Init",this.proxy(function(a,b){this.revision=b.control}))}))},canSave:function(){return this.revision.isPreview()},save:function(){this.revision.save()}});CE.Saving=can.Construct({strategies:[],init:function(){this.strategies=new can.List([new b,new a])},save:function(){var a=arguments;this.strategies.each(function(b){if(b.canSave())return b.save.apply(b,a),!1})}},{})})(jQuery);(function(d){CE.ContentParser=can.Construct({},{content:"",init:function(a){this.content=
this._getSources(a).replace(/\n\n$/,"")},_getSources:function(a,b){var c="";"undefined"===typeof b&&(b=1);a.each(this.proxy(function(a,f){var g=d(f);if(g.hasClass("motopress-content-wrapper"))c+=this._getSources(g.children(".motopress-row, .mpce-wp-more-tag"),b);else if(g.hasClass("motopress-row")){var h=parent.CE.Iframe.myThis.getRowSlug(b),k=parent.MP.Utils.getEdgeRow(g);c+="["+h+this._getAttributes(g)+"]\n\n";c+=this._getSources(k.children(".motopress-clmn"),b);c+="[/"+h+"]\n\n"}else if(g.hasClass("motopress-clmn")){var h=
MP.Utils.getEdgeSpan(g),k=MP.Utils.getSpanClass(g.prop("class").split(" ")),n=MP.Utils.getSpanNumber(k),k="",n=parent.CE.Iframe.myThis.getClmnSlug(b,n),m=MP.Utils.isSpanWrapper(g)?b+1:b,r=g.get(0).style.minHeight;if(r.length){var l=parseInt(r);isNaN(l)||l===IframeCE.Resizer.myThis.minHeight||l===IframeCE.Resizer.myThis.spaceMinHeight||(k=' style="min-height: '+r+';"')}c+="["+n.slug+n.attr+k+this._getAttributes(g)+"]\n\n";c+=this._getSources(h.find("> .motopress-row, > .motopress-block-content > [data-motopress-shortcode]"),
m);c+="[/"+n.slug+"]\n\n"}else g.is("[data-motopress-shortcode]")?c+=this._getShortcode(g):1===b&&g.hasClass("mpce-wp-more-tag")&&(c+="\x3c!--more--\x3e")}));return c},_getShortcode:function(a){var b="";if(a.length){var c="",d=a.attr("data-motopress-shortcode"),f=a.attr("data-motopress-close-type"),g="undefined"!==typeof a.attr("data-motopress-unwrap"),h="",k="";"enclosed"===f&&(f=(f=a.attr("data-motopress-content"))?f.replace(/\[\]/g,"["):"",c+=f+"\n\n",k="[/"+d+"]\n\n");g&&this._isEmptyStyles(a)||
(h="["+d+this._getAttributes(a)+"]\n\n",c=h+c+k);b+=c}return b},_getAttributes:function(a){var b={},c=a.attr("data-motopress-parameters")?JSON.parse(a.attr("data-motopress-parameters")):{},e=a.attr("data-motopress-styles")?JSON.parse(a.attr("data-motopress-styles")):{};d.extend(b,c,e);var f="";if(b){var c=a.attr("data-motopress-group"),g=a.attr("data-motopress-shortcode"),h=CE.WidgetsLibrary.myThis.getObject(c,g).parameters;if(g===parent.CE.Iframe.myThis.gridObj.span.shortcode||g===parent.CE.Iframe.myThis.gridObj.span.inner)a.hasClass("motopress-empty")&&
(b.hasOwnProperty(parent.CE.Iframe.myThis.gridObj.span.custom_class_attr)||(b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr]={}),b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr].hasOwnProperty("value")||(b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr].value=""),b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr].value+=" motopress-empty mp-hidden-phone"),a.hasClass("motopress-space")&&(b.hasOwnProperty(parent.CE.Iframe.myThis.gridObj.span.custom_class_attr)||(b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr]=
{}),b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr].hasOwnProperty("value")||(b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr].value=""),b[parent.CE.Iframe.myThis.gridObj.span.custom_class_attr].value+=" motopress-space");d.each(b,this.proxy(function(a,c){c=this._filterShortcodeAttribute(c,a,{name:g,parameters:h,attributes:b});"undefined"!==typeof c.value&&""!==c.value&&(f+=" "+a+'="'+c.value+'"')}))}return f},_filterShortcodeAttribute:function(a,b,c){c.parameters.hasOwnProperty(b)&&
c.parameters[b].hasOwnProperty("saveInContent")&&"true"==c.parameters[b].saveInContent&&(a.value="");if(-1!==d.inArray(c.name,["mp_row","mp_row_inner"])){if(c.parameters.hasOwnProperty(b)&&"undefined"!==typeof c.parameters[b].disabled&&"true"===c.parameters[b].disabled&&-1!==d.inArray(b,"bg_video_youtube bg_video_youtube_cover bg_video_webm bg_video_mp4 bg_video_ogg bg_video_cover parallax_image parallax_bg_size".split(" "))||"full_height"===b&&c.parameters.hasOwnProperty(b)&&c.parameters[b]["default"]===
a.value)return a.value="",a;c.parameters.hasOwnProperty(b)&&c.parameters[b].dependency&&c.attributes[c.parameters[b].dependency.parameter].value!==c.parameters[b].dependency.value&&("undefined"===typeof c.parameters[b].disabled||"false"===c.parameters[b].disabled)&&(a.value="")}return a},_isEmptyStyles:function(a){var b=!0;a=a.attr("data-motopress-styles")?JSON.parse(a.attr("data-motopress-styles")):{};d.each(a,function(a,d){"undefined"!==typeof d.value&&""!==d.value&&(b=!1)});return b}})})(jQuery);
(function(d){CE.ContentTemplateParser=CE.ContentParser({},{replaceableStyles:[],_filterShortcodeAttribute:function(a,b,c){a=this._super(a,b,c);if("mp_custom_style"==b&&a.hasOwnProperty("value")&&(b=IframeCE.StyleEditor.myThis.retrievePrivateClass(a.value))){c=IframeCE.StyleEditor.myThis.getPrivateStyleInstance(b,c.name);var d="mpce-replaceable-prvt-"+this.replaceableStyles.length;this.replaceableStyles.push({name:d,settings:c.getSettings()});a.value=a.value.replace(b,d)}return a}})})(jQuery);(function(d){CE.Save=
can.Construct({postChanged:!1,saveAJAX:function(a){this.triggerBeforeSave();var b=this.getContent();a&&CE.Settings.Page.attr("status",a);a={action:"motopress_ce_save_post",nonce:motopressCE.nonces.motopress_ce_save_post,postID:motopressCE.postID,content:b,motopresscecontent:b,title:CE.Settings.Page.attr("title"),hideTitle:CE.Settings.Page.attr("hideTitle"),template:CE.Settings.Page.attr("template"),status:CE.Settings.Page.attr("status"),"motopress-ce-edited-post":motopressCE.postID,"motopress-ce-preset-styles-last-id":IframeCE.StyleEditor.myThis.getPresetsLastId(),
"motopress-ce-preset-styles":IframeCE.StyleEditor.myThis.getPresetsString(),"_motopress-ce-private-styles":IframeCE.StyleEditor.myThis.getPrivateStylesString()};return d.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"json",data:a,success:this.proxy(function(a){d.isArray(a.data)&&!a.data.length&&(a.data={});a.data.hasOwnProperty("post_status")&&CE.Settings.Page.attr("status",a.data.post_status);MP.Editor.triggerEverywhere("AfterUpdate",a.data)}),error:function(a){console.log(a);MP.Editor.triggerEverywhere("SaveError",
a)},complete:this.proxy(function(a){MP.Editor.triggerEverywhere("SaveComplete",a)})}).done(this.makeContentNonDirty)},triggerBeforeSave:function(){MP.Editor.triggerEverywhere("BeforeSave")},makeContentNonDirty:function(){},getContent:function(){var a="",b=CE.Iframe.myThis.getContentRootElement();b.length&&(a=(new CE.ContentParser(b)).content);return a},changeContent:function(a){this.postChanged=!0;MP.Editor.triggerEverywhere("ContentChange",a)},setContentNotChanged:function(){this.postChanged=!1},
isContentChanged:function(){return this.postChanged},isEmptyStyles:function(a){var b=!0;a=a.attr("data-motopress-styles")?JSON.parse(a.attr("data-motopress-styles")):{};d.each(a,function(a,d){"undefined"!==typeof d.value&&""!==d.value&&(b=!1)});return b}},{})})(jQuery);(function(d){MP.Settings=can.Construct({siteUrl:null,debug:null,adminUrl:null,pluginRootUrl:null,pluginName:null,pluginDirUrl:null,palettes:null,lang:null,langName:null,loadScriptsUrl:null,spellcheck:null,removeWpPanels:function(){d("#footer, #adminmenuwrap, #adminmenuback, .update-nag").remove();
d("#wpcontent").css("margin-left",0);d("#wpbody-content").css("padding-bottom",0);d("#wpfooter").remove()},getSiteUrl:function(){var a=window.location.href,b=a.indexOf("/wp-admin/");this.siteUrl=a.substr(0,b)},getWpSettings:function(){var a=motopressCE.settings.wp;MP.Settings.debug=a.debug;MP.Settings.adminUrl=a.admin_url;MP.Settings.pluginRootUrl=a.plugin_root_url;MP.Settings.pluginName=a.plugin_name;MP.Settings.pluginDirUrl=a.plugin_dir_url;MP.Settings.palettes=a.palettes;MP.Settings.licenseType=
a.license_type;MP.Settings.lang=a.lang;MP.Settings.loadScriptsUrl=a.load_scripts_url;MP.Settings.spellcheck="1"==a.spellcheck;if(MP.Utils.Browser.IE||MP.Utils.Browser.Opera)window.location=MP.Settings.adminUrl+"?page="+MP.Settings.pluginName}},{setup:function(){"undefined"===typeof CE&&this.removeWpPanels();MP.Settings.getSiteUrl();MP.Settings.getWpSettings()}})})(jQuery);(function(d){can.Construct("MP.Language",{},{init:function(){var a={},b;for(b in localStorage)0==b.indexOf("WP_DATA_USER_")&&(a[b]=
localStorage.getItem(b));localStorage.clear();for(var c in a)localStorage.setItem(c,a[c]);d.each(motopressCE.settings.translations,function(a,b){localStorage.setItem(a,b)});MP.Preloader.myThis.load(MP.Language.shortName)}})})(jQuery);(function(d){CE.ImageLibrary=can.Construct({myThis:null},{frame:null,propertyImage:null,init:function(){CE.ImageLibrary.myThis=this;this.frame=wp.media({id:"motopress-image-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",router:"browse",
menu:"default",searchable:!0,filterable:!1,sortable:!1,title:localStorage.getItem("CEImageLibraryText"),button:{text:localStorage.getItem("CEImageLibraryText")},library:{type:"image"},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setImage"));this.frame.on("close",this.proxy("onClose"))},onOpen:function(){var a=this.frame;a.reset();this.propertyImage=CE.Panels.SettingsDialog.myThis.element.find('[data-motopress-open-img-lib="1"]');
var b=this.propertyImage.control(CE.Ctrl).get();null!==b&&""!==b&&(d.isArray(b)||(b=[b]),b.forEach(function(b){jQuery.isNumeric(b)&&(b=wp.media.attachment(b),b.fetch(),a.state().get("selection").add(b))}))},setImage:function(){var a=this.frame.state().get("selection").models[0].attributes,b="full";a.sizes.hasOwnProperty("medium")?b="medium":a.sizes.hasOwnProperty("thumbnail")&&(b="thumbnail");var b=a.sizes[b].url,c=this.propertyImage.control(CE.Ctrl);c.set({id:a.id,src:b,full:a.sizes.full.url});c.showTools();
c.element.trigger("change");this.propertyImage.removeAttr("data-motopress-open-img-lib")},onClose:function(){CE.Panels.SettingsDialog.myThis.wrapper.focus();var a=d(document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},0)}})})(jQuery);(function(d){CE.WPGallery=can.Construct({myThis:null},{frame:null,ctrl:null,init:function(){CE.WPGallery.myThis=this;var a=wp.media,b=a.model.Attachment;a.controller.CEGallery=
a.controller.FeaturedImage.extend({defaults:parent._.defaults({id:"motopress-media-library-gallery",title:localStorage.getItem("CEWpGalleryText"),toolbar:"main-insert",filterable:"uploaded",library:a.query({type:"image"}),multiple:"add",editable:!0,priority:60,syncSelection:!1},a.controller.Library.prototype.defaults),updateSelection:function(){var a=this.get("selection"),d=CE.WPGallery.myThis.ctrl.get(),f;""!==d&&-1!==d&&(f=parent._.map(d.split(/,/),function(a){return b.get(a)}));a.reset(f)}});a.view.MediaFrame.CEGallery=
a.view.MediaFrame.Post.extend({createStates:function(){this.states.add([new a.controller.CEGallery])},bindHandlers:function(){a.view.MediaFrame.Select.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:create:main-insert",this.createToolbar,this);parent._.each({content:{embed:"embedContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar"}},function(a,b){parent._.each(a,function(a,c){this.on(b+":render:"+c,this[a],this)},this)},this)},mainInsertToolbar:function(a){var b=
this;this.selectionStatusToolbar(a);a.set("insert",{style:"primary",priority:80,text:localStorage.getItem("CEWpGalleryText"),requires:{selection:!0},click:function(){var a=b.state(),c=a.get("selection");b.close();a.trigger("insert",c).reset()}})}});this.frame=new a.view.MediaFrame.CEGallery(parent._.defaults({},{state:"motopress-media-library-gallery",title:localStorage.getItem("CEWpGalleryText"),library:{type:"image"},multiple:!0}));this.frame.on("open",this.proxy("onOpen"));this.frame.on("close",
this.proxy("onClose"));this.frame.on("insert",this.proxy("setImage"))},open:function(a){this.ctrl=a;this.frame.open()},onOpen:function(){var a=this.frame;a.reset();var b=this.ctrl.getArray();if(null!==b){var c=null;b.forEach(function(b){c=wp.media.attachment(b);c.fetch();a.state().get("selection").add(c)})}},onClose:function(){CE.Panels.SettingsDialog.myThis.wrapper.focus();var a=d(document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");
clearTimeout(b)},0)},setImage:function(){var a=[],b=this.frame.state().get("selection").models;d.each(b,function(b,d){a.push(d.attributes.id)});this.ctrl.set(a);this.ctrl.element.trigger("change")}})})(jQuery);(function(d){CE.WPMedia=can.Construct({myThis:null},{frame:null,propertyMedia:null,init:function(){CE.WPMedia.myThis=this;this.frame=wp.media({id:"motopress-media-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",router:"browse",menu:"default",searchable:!0,
filterable:!1,sortable:!1,title:localStorage.getItem("CEMediaLibraryText"),button:{text:localStorage.getItem("CEMediaLibraryText")},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setMedia"));this.frame.on("close",this.proxy("onClose"))},onOpen:function(){var a;this.propertyMedia=CE.Panels.SettingsDialog.myThis.element.find('[data-motopress-open-media-lib="1"]');this.propertyMediaID=this.propertyMedia.find(".motopress-property-media-id");
this.propertyMediaSrc=this.propertyMedia.find(".motopress-property-media");a=this.propertyMediaID.val();a=null!==a?wp.media.attachment(a):wp.media.attachment();a.fetch();this.frame.state().get("selection").add(a)},setMedia:function(){var a=this.frame.state().get("selection").models[0].attributes,b=this.propertyMedia.control(CE.Ctrl),c=a.url;this.propertyMediaID.val(a.id);this.propertyMediaSrc.val(c);b.element.removeAttr("data-motopress-open-media-lib");b.element.trigger("change")},onClose:function(){CE.Panels.SettingsDialog.myThis.wrapper.focus();
this.propertyMedia.removeAttr("data-motopress-open-media-lib");var a=d(document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},0)}})})(jQuery);(function(d){CE.WPAudio=can.Construct({myThis:null},{frame:null,propertyAudio:null,propertyAudioTitle:null,init:function(){CE.WPAudio.myThis=this;this.frame=wp.media({id:"motopress-audio-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",
router:"browse",menu:"default",searchable:!0,filterable:!1,sortable:!1,title:"Set audio file",button:{text:"Set audio file"},library:{type:"audio"},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setAudio"));this.frame.on("close",this.proxy("onClose"))},onOpen:function(){var a;this.propertyAudio=CE.Panels.SettingsDialog.myThis.element.find(".motopress-property-audio-id");this.propertyAudioTitle=CE.Panels.SettingsDialog.myThis.element.find(".motopress-property-audio-title");
a=this.propertyAudio.val();a=null!==a?wp.media.attachment(a):wp.media.attachment();a.fetch();this.frame.state().get("selection").add(a)},setAudio:function(){var a=this.frame.state().get("selection").models[0].attributes;this.propertyAudio.val(a.id);this.propertyAudioTitle.val(a.title);this.propertyAudio.trigger("change")},onClose:function(){CE.Panels.SettingsDialog.myThis.wrapper.focus();var a=d(document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");
clearTimeout(b)},0)}})})(jQuery);(function(d){CE.WPVideo=can.Construct({myThis:null},{frame:null,propertyVideo:null,init:function(){CE.WPVideo.myThis=this;this.frame=wp.media({id:"motopress-video-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",router:"browse",menu:"default",searchable:!0,filterable:!1,sortable:!1,title:localStorage.getItem("CEVideoLibraryText"),button:{text:localStorage.getItem("CEVideoLibraryText")},library:{type:"video"},contentUserSetting:!0,
syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setVideo"));this.frame.on("close",this.proxy("onClose"))},onOpen:function(){this.propertyVideo=CE.Panels.SettingsDialog.myThis.element.find("[data-motopress-open-video-lib=1]")},setVideo:function(){var a=this.frame.state().get("selection").models[0].attributes.url,b=this.propertyVideo.control(CE.Ctrl);b.set(a);b.element.removeAttr("data-motopress-open-video-lib");b.element.trigger("change")},onClose:function(){CE.Panels.SettingsDialog.myThis.wrapper.focus();
this.propertyVideo.removeAttr("data-motopress-open-video-lib");var a=d(document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},0)}})})(jQuery);can.view.stache("saveObjectModal",'<div class="modal-header">\n\t\t<p id="codeModalLabel" class="modal-header-label">\n\t\t\t{{translations.modalTitle}}\n\t\t</p>\n\t</div>\n\t<div class="modal-body">\n\t\t<div class="motopress-dialog-content">\n\t\t\t<div class="motopress-ce-object-template-name-wrapper motopress-ce-modal-control-wrapper">\n\t\t\t\t<label for="motopress-ce-object-template-name" class="motopress-property-label">\n\t\t\t\t\t{{translations.templateName}}\n\t\t\t\t</label>\n\t\t\t\t<input type="text" id="motopress-ce-object-template-name" name="object-template-name"\n\t\t\t\t\tclass="motopress-property-input" />\n\t\t\t\t<p class="description motopress-property-description">\n\t\t\t\t\t{{translations.leaveNameEmpty}}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div class="motopress-ce-object-template-category-select-wrapper motopress-ce-modal-control-wrapper">\n\t\t\t\t<label for="motopress-ce-save-template-select" class="motopress-property-label">\n\t\t\t\t\t{{translations.chooseAction}}\n\t\t\t\t</label>\n\t\t\t\t<select id="motopress-ce-object-template-category-select" \n\t\t\t\t\tclass="motopress-property-select motopress-bootstrap-dropdown motopress-dropdown-select" >\n\t\t\t\t\t<option class="motopress-ce-create-new-category" value="">\n\t\t\t\t\t\t<i>{{translations.createNewCategory}}</i>\n\t\t\t\t\t</option>\n\t\t\t\t\t<optgroup label="{{translations.existingCategories}}" >\n\t\t\t\t\t\t{{#each categories}}\n\t\t\t\t\t\t\t<option value="{{@index}}">{{.}}</option>\n\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t</optgroup>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div class="motopress-ce-object-template-category-name-wrapper motopress-ce-modal-control-wrapper">\n\t\t\t\t<label for="motopress-ce-object-template-category-name" class="motopress-property-label">\n\t\t\t\t\t{{translations.categoryName}}\n\t\t\t\t</label>\n\t\t\t\t<input type="text" id="motopress-ce-object-template-category-name" name="category-name"\n\t\t\t\t\tclass="motopress-property-input"/>\n\t\t\t\t<p class="description motopress-property-description">\n\t\t\t\t\t{{translations.leaveCategoryNameBlank}}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="modal-footer">\n\t\t<button id="motopress-ce-create-object-template" class="motopress-btn-blue">\n\t\t\t{{translations.createTemplate}}\n\t\t</button>\n\t\t<button class="motopress-btn-default" data-dismiss="modal" aria-hidden="true">\n\t\t\t{{translations.close}}\n\t\t</button>\n\t</div>\n');
(function(d){CE.SaveObjectModal=can.Control.extend({myThis:null,listensTo:["show","shown","hide"]},{defer:null,categories:[],createBtn:null,categorySelect:null,categorySelectWrapper:null,categoryNameInput:null,categoryNameInputWrapper:null,templateNameInput:null,init:function(){CE.SaveObjectModal.myThis=this;this.element.mpmodal({backdrop:"static",show:!1})},_updateView:function(){this.element.html(can.view("saveObjectModal",{translations:{modalTitle:"Save Template",templateName:"Template Name:",
leaveNameEmpty:"Leave this field blank to generate name automatically.",chooseAction:"Category:",createNewCategory:"Create New Category",existingCategories:"Existing Categories",uncategorized:"Uncategorized",categoryName:"Category Name:",leaveCategoryNameBlank:"Leave this field blank for uncategorized.",createTemplate:"Create Template",close:"Close"},categories:this.categories}));this.initForm()},initForm:function(){this.templateNameInput=this.element.find("#motopress-ce-object-template-name");this.categorySelect=
this.element.find("#motopress-ce-object-template-category-select");this.categorySelectWrapper=this.element.find(".motopress-ce-object-template-category-select-wrapper");this.categoryNameInput=this.element.find("#motopress-ce-object-template-category-name");this.categoryNameInputWrapper=this.element.find(".motopress-ce-object-template-category-name-wrapper");this.createBtn=this.element.find("#motopress-ce-create-object-template")}," show":function(a,b){this._updateView();this.formReset()}," shown":function(){this.templateNameInput.focus()},
" hide":function(a,b){this.defer.reject()},"#motopress-ce-object-template-category-select change":function(){!this.categorySelect.val()&&this.categorySelect.children(":selected").hasClass("motopress-ce-create-new-category")?this.categoryNameInputWrapper.removeClass("motopress-hide"):this.categoryNameInputWrapper.addClass("motopress-hide")},keydown:function(a,b){b.which===d.ui.keyCode.ENTER&&this.createBtn.click()},formReset:function(){this.templateNameInput.val("");this.categorySelect.val("");this.categoryNameInput.val("")},
showModal:function(a){this.categories=a.categories;this.element.mpmodal("show");this.defer=d.Deferred();return this.defer.promise()},hideModal:function(){this.element.mpmodal("hide")},"#motopress-ce-create-object-template click":function(){var a=this.categorySelect.val(),b={name:d.trim(this.templateNameInput.val()),category:a};!a&&this.categorySelect.children(":selected").hasClass("motopress-ce-create-new-category")&&(a=d.trim(this.categoryNameInput.val()),b.newCategoryTitle=a);this.defer.resolve(b);
this.hideModal()}})})(jQuery);(function(d){CE.PresetSaveModal=can.Control.extend({myThis:null,listensTo:["show","shown","hide"]},{saveBtn:null,updateBtn:null,privateStyleObj:null,presetStyleObj:null,presetSelect:null,presetSelectWrapper:null,presetNameInput:null,presetNameInputWrapper:null,presetInheritanceDesc:null,presetInheritanceName:null,init:function(){CE.PresetSaveModal.myThis=this;this.initButtons();this.initForm();this.element.mpmodal({backdrop:"static",show:!1})},initButtons:function(){this.createBtn=
this.element.find("#motopress-ce-create-preset");this.updateBtn=this.element.find("#motopress-ce-update-preset")},initForm:function(){this.presetSelect=this.element.find("#motopress-ce-save-preset-select");this.presetSelectWrapper=this.element.find(".motopress-ce-save-preset-select-wrapper");this.presetNameInput=this.element.find("#motopress-ce-save-preset-name");this.presetNameInputWrapper=this.element.find(".motopress-ce-save-preset-name-wrapper");this.presetInheritanceDesc=this.element.find(".motopress-ce-preset-inheritance");
this.presetInheritanceName=this.presetInheritanceDesc.find(".motopress-ce-preset-inheritance-name")}," show":function(a,b){this.updatePresetsList();this.formReset()}," shown":function(){this.presetNameInput.focus()}," hide":function(a,b){this.defer.reject()},updatePresetsList:function(){var a=IframeCE.StyleEditor.myThis.getPresetsList(),b=[];d.each(a,function(a,e){b.push(d("<option />",{value:a,text:e}))});this.presetSelect.find("optgroup").html(b);b.length?this.presetSelect.find("optgroup").removeClass("motopress-hide"):
this.presetSelect.find("optgroup").addClass("motopress-hide")},"#motopress-ce-save-preset-select change":function(){this.updateControlsVisibility()},keydown:function(a,b){b.which===d.ui.keyCode.ENTER&&d(this.createBtn,this.updateBtn).filter(":not(.motopress-hide)").click()},updateControlsVisibility:function(){""===this.presetSelect.val()?(this.presetNameInputWrapper.removeClass("motopress-hide"),this.updateBtn.addClass("motopress-hide"),this.createBtn.removeClass("motopress-hide")):(this.presetNameInputWrapper.addClass("motopress-hide"),
this.updateBtn.removeClass("motopress-hide"),this.createBtn.addClass("motopress-hide"))},formReset:function(){this.presetSelect.val("");this.presetNameInput.val("");null!==this.presetStyleObj?(this.presetInheritanceName.text(this.presetStyleObj.getLabel()),this.presetInheritanceDesc.removeClass("motopress-hide")):(this.presetInheritanceName.text(""),this.presetInheritanceDesc.addClass("motopress-hide"));this.updateControlsVisibility()},showModal:function(a,b){this.privateStyleObj=a;this.presetStyleObj=
b;this.element.mpmodal("show");this.defer=d.Deferred();return this.defer.promise()},"#motopress-ce-create-preset click":function(){var a=null!==this.presetStyleObj?this.presetStyleObj.getSettings():{};d.extend(!0,a,this.privateStyleObj.getSettings());var b={label:d.trim(this.presetNameInput.val()),objectType:this.privateStyleObj.getObjectType()},a=IframeCE.StyleEditor.myThis.createPreset(a,b);this.defer.resolve(a.getId());this.element.mpmodal("hide");CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.StylePresetCreated.NAME,
new IframeCE.SceneEvents.StylePresetCreated(a))},"#motopress-ce-update-preset click":function(){var a=this.presetSelect.val(),a=IframeCE.StyleEditor.myThis.getPresetStyleInstance(a),b=null!==this.presetStyleObj?this.presetStyleObj.getSettings():{};d.extend(!0,b,this.privateStyleObj.getSettings());a.update(b);this.defer.resolve(a.getId());this.element.mpmodal("hide");CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.StylePresetChanged.NAME,new IframeCE.SceneEvents.StylePresetChanged(a))}})})(jQuery);
(function(d){CE.CodeModal=can.Control.extend({myThis:null,currentShortcode:null,currentTextareaTinymce:null,listensTo:["show","shown","hide"]},{iframeBody:null,content:null,editor:null,saveBtn:null,saveHandler:null,isHiding:!1,editorId:"motopresscodecontent",init:function(){CE.CodeModal.myThis=this;this.container=this.element.find("#wp-"+this.editorId+"-editor-container");this.content=this.element.find("#"+this.editorId+"");if("undefined"!==typeof tinyMCE&&"undefined"!==typeof tinyMCE.get(this.editorId)){var a=
this;d.when(motopressCE.tinyMCEInited[this.editorId]).done(function(b){a.editor=b})}this.saveBtn=this.element.find("#motopress-save-code-content");var b=this.element.find("#wp-"+this.editorId+"-editor-tools");0===b.height()&&b.height(33);this.element.mpmodal({backdrop:"static",show:!1});d(window).on("resize",this.proxy("resize"));MP.Utils.addWindowFix();if(parent.MP.Utils.version_compare(parent.motopressCE.settings.wp.wordpress_version,"4.0.0",">="))this.element.find(".wp-switch-editor.switch-html, .wp-switch-editor.switch-tmce").on("click",
function(){CE.CodeModal.myThis.recalcTabSizeWP4()})},setSize:function(a){var b=this.element.find(".modal-footer"),c=this.element.width()-(parseFloat(b.css("padding-left"))+parseFloat(b.css("padding-right")));b.width(c);c=this.element.find(".modal-body");b=this.element.height()-this.element.find(".modal-header").outerHeight()-parseFloat(c.css("margin-top"))-parseFloat(c.css("margin-bottom"))-b.outerHeight();c.height(b);a&&this.element.css({display:"block",visibility:"hidden"});b=parent.MP.Utils.version_compare(parent.motopressCE.settings.wp.wordpress_version,
"4.1.0",">=")?2:0;b=this.element.find("#wp-"+this.editorId+"-wrap").height()-this.element.find("#wp-"+this.editorId+"-editor-tools").outerHeight()-parseFloat(this.container.css("border-top-width"))-parseFloat(this.container.css("border-bottom-width"))-b;this.container.height(b);parent.MP.Utils.version_compare(parent.motopressCE.settings.wp.wordpress_version,"4.0.0","<")?this.recalcTabSizeWPOld():this.recalcTabSizeWP4();a&&(this.element.css({display:"",visibility:""}),this.content.removeAttr("rows"))},
recalcTabSizeWPOld:function(){var a=this.container.height()-parseFloat(this.container.css("border-top-width"))-parseFloat(this.container.css("border-bottom-width"))-this.element.find("#qt_"+this.editorId+"_toolbar").outerHeight()-parseFloat(this.content.css("padding-top"))-parseFloat(this.content.css("padding-bottom"));this.content.height(a);var a=this.element.find("#"+this.editorId+"_ifr"),b=this.container.find(".mce-first, tr.mceFirst").first(),c=this.container.find(".mce-statusbar, tr.mceLast").last(),
b=this.container.height()-parseFloat(this.container.css("border-top-width"))-parseFloat(this.container.css("border-bottom-width"))-b.outerHeight()-c.outerHeight();a.height(b)},recalcTabSizeWP4:function(){switch(MP.Utils.getEditorActiveMode(this.element.find("#wp-"+this.editorId+"-wrap").prop("class").split(" "))){case "html-active":var a=this.container.height()-this.element.find("#qt_"+this.editorId+"_toolbar").outerHeight()-parseFloat(this.content.css("padding-top"))-parseFloat(this.content.css("padding-bottom"));
this.content.height(a);break;case "tmce-active":a=this.container.height()-parseFloat(this.container.find(".mce-toolbar-grp").outerHeight())-parseFloat(this.container.find(".mce-statusbar").outerHeight()),this.container.find(".mce-edit-area").height(a)}},resize:function(){this.element.data("modal").isShown&&this.setSize(!1)}," show":function(a,b){this.isHiding=!1;this.switchVisual();this.setSize(!0);if(null!==this.saveHandler&&"function"===typeof this.saveHandler)this.saveBtn.off("click").on("click",
this.saveHandler);null===this.iframeBody&&(this.iframeBody=this.element.find("#"+this.editorId+"_ifr").contents().find("."+this.editorId+""),this.iframeBody.css("max-width","none"));a.data("modal").hasOwnProperty("closeDialog")||CE.Panels.SettingsDialog.myThis.close()}," shown":function(){null!==this.editor?this.editor.execCommand("mceFocus",!1):this.content.focus();d("body").hide(0,function(){d("body").show()})}," hide":function(a,b){if(!this.isHiding){this.isHiding=!0;var c=CE.CodeModal.currentShortcode.closest(".motopress-block-content").find(">.mpce-widget-tools-wrapper>.mpce-object-panel>.mpce-panel-btn-settings");
IframeCE.Selectable.getFocusAreaBySelected(c).focus();this.content.val("");null!==this.editor&&this.editor.setContent("");this.saveHandler=null;a.data("modal").hasOwnProperty("closeDialog")&&delete a.data("modal").closeDialog;CE.Panels.SettingsDialog.myThis.element.dialog("isOpen")||CE.Panels.SettingsDialog.myThis.open(c);var d=setTimeout(function(){CE.CodeModal.currentShortcode=null;CE.CodeModal.currentTextareaTinymce=null;clearTimeout(d)},0)}},switchVisual:function(){var a=MP.Utils.getEditorActiveMode(this.element.find("#wp-"+
this.editorId+"-wrap").prop("class").split(" "));"undefined"!==typeof tinyMCE&&"html-active"===a&&(switchEditors.hasOwnProperty("switchto")?switchEditors.switchto(this.element.find("#"+this.editorId+"-tmce")[0]):switchEditors.go(this.editorId,"tmce"),null===this.editor&&(this.editor=tinyMCE.get(this.editorId)))}})})(jQuery);(function(d){CE.Panels.AbstractDialog.extend("CE.Panels.LayoutChooserDialog",{myThis:null,NAME:"layout_chooser"},{layoutTypes:[],editedRow:null,positionTarget:null,$marker:null,
insertMarker:null,init:function(a,b){this._super(a,b);CE.Panels.LayoutChooserDialog.myThis=this;this.layoutTypes=b.layouts;this.createPositionMarker();a.dialog({autoOpen:!1,resizable:!1,dialogClass:"motopress-dialog",title:"Choose Layout",width:352,height:232})},createPositionMarker:function(){this.$marker=d("<div />",{"class":"mpce-layout-chooser-marker"}).css({position:"absolute",opacity:0});CE.Panels.Navbar.myThis.editorWrapperEl.before(this.$marker)},updatePositionMarker:function(a){var b=a[0].ownerDocument,
b=b.defaultView||b.parentWindow,c=a.offset();this.$marker.css({width:a.outerWidth(),height:a.outerHeight(),left:c.left+CE.Iframe.myThis.element.offset().left,top:c.top-d(b).scrollTop()+CE.Iframe.myThis.element.offset().top})},open:function(a){a=d.extend({positionTarget:null,insertMarker:null,editedRow:null},a);(this.editedRow=a.editedRow)?(this.nestingLevel=MP.Utils.detectRowNestingLvl(this.editedRow),IframeCE.Selectable.myThis.selectShortcode(this.editedRow)):this.nestingLevel=1;this.insertMarker=
a.insertMarker;this.positionTarget=a.positionTarget;this.updateView();this.element.dialog("option","position",this.preparePositionNearEl(a.positionTarget));return this._super()},updateView:function(){var a={};d.each(this.layoutTypes,function(b,c){a[c.join("-")]=c});this.element.html(can.view("layoutChooserDialog",{layouts:a,activeLayout:this.editedRow?IframeCE.LayoutManager.detectRowLayout(this.editedRow).join("-"):"",translations:{}}))},close:function(){this.element.dialog("close")},preparePositionNearEl:function(a){this.updatePositionMarker(a);
a={my:"center bottom",at:"center top",of:this.$marker,within:window};this.isOpen()&&(a.using=function(a,c){c.element.element.animate(a)});return a},".mpce-layout-type click":function(a,b){var c=a.attr("data-layout-type").split("-");this.editedRow?IframeCE.LayoutManager.editLayout(this.editedRow,c):IframeCE.LayoutManager.insertRow(c,this.insertMarker,"before",this.nestingLevel);this.openDeferred.resolve();this.close()}})})(jQuery);can.view.stache("layoutChooserDialog",'<ul class="mpce-layout-types-wrapper">\n\t\t{{#each layouts}}\n\t\t\t<li class="mpce-layout-type mpce-layout-type-{{@key}}{{#is activeLayout @key}} mpce-active-layout-type{{/is}}" \n\t\t\t\tdata-layout-type="{{@key}}">\n\t\t\t\t{{#each .}}\n\t\t\t\t\t<span class="mpce-layout-type-clmn mpce-layout-type-clmn-{{.}}"><span>{{.}}</span></span>\n\t\t\t\t{{/each}}\n\t\t\t</li>\n\t\t{{/each}}\n\t</ul>');
(function(d){CE.Panels.AbstractDialog.extend("CE.Panels.TemplateChooserDialog",{myThis:null,NAME:"template_chooser"},{positionTarget:null,$marker:null,insertMarker:null,init:function(a,b){this._super(a,b);CE.Panels.TemplateChooserDialog.myThis=this;this.createPositionMarker();a.dialog({autoOpen:!1,resizable:!1,dialogClass:"motopress-dialog",title:"Choose Template",width:392,height:332})},createPositionMarker:function(){this.$marker=d("<div />",{"class":"mpce-template-chooser-marker"}).css({position:"absolute",
opacity:0});CE.Panels.Navbar.myThis.editorWrapperEl.before(this.$marker)},updatePositionMarker:function(a){var b=a[0].ownerDocument,b=b.defaultView||b.parentWindow,c=a.offset();this.$marker.css({width:a.outerWidth(),height:a.outerHeight(),left:c.left+CE.Iframe.myThis.element.offset().left,top:c.top-d(b).scrollTop()+CE.Iframe.myThis.element.offset().top})},open:function(a){a=d.extend({positionTarget:null,insertMarker:null,editedRow:null},a);this.insertMarker=a.insertMarker;this.positionTarget=a.positionTarget;
this.updateView();this.element.dialog("option","position",this.preparePositionNearEl(a.positionTarget));return this._super()},updateView:function(){this.element.html(can.view("templateChooserDialog",{rows:CE.ObjectTemplatesLibrary.myThis.getRows(),pages:CE.ObjectTemplatesLibrary.myThis.getPages(),translations:{all:"All",search:"Search",noTemplate:"There are no saved templates yet. "}}))},close:function(){this.element.dialog("close")},preparePositionNearEl:function(a){this.updatePositionMarker(a);
a={my:"center bottom",at:"center top",of:this.$marker,within:window};this.isOpen()&&(a.using=function(a,c){c.element.element.animate(a)});return a},".mpce-section-item click":function(a,b){var c=a.attr("data-section-template-id");a.attr("data-section-category-id");var e;e=a.hasClass("mpce-row-item")?CE.ObjectTemplatesLibrary.myThis.getRowById(c):CE.ObjectTemplatesLibrary.myThis.getPageById(c);var c=e.content,f={};d.each(e.styles,function(a,b){b=d.extend({settings:{},objectType:""},b);var c=IframeCE.StyleEditor.myThis.createPrivateStyle(b.settings,
b.objectType);f[b.name]=c.getId()});d.isEmptyObject(f)||(e=new RegExp("(\\W)("+Object.keys(f).join("|")+")(\\W)","ig"),c=c.replace(e,function(a,b,c,d){return b+f[c]+d}));e=new MP.EntityType(IframeCE.Grid.ENTITIES.PAGE);IframeCE.LayoutManager.insertShortcodeString(c,e,this.insertMarker,"before").done(this.proxy(function(){this.openDeferred.resolve()}));this.close()}})})(jQuery);can.view.stache("templateChooserDialog",'<div id="mpce-sections-panel">\n\t\t\x3c!--<div id="mpce-sections-filter-wrapper">--\x3e\n\t\t\t\x3c!--<input type="text" class="mpce-sections-search" placeholder="{{translations.search}}"/>--\x3e\n\t\t\t\x3c!--<select class="mpce-sections-category-filter">--\x3e\n\t\t\t\t\x3c!--<option value="">{{translations.all}}</option>--\x3e\n\t\t\t\t\x3c!--{{#each categories}}--\x3e\n\t\t\t\t\t\x3c!--<option value="{{@index}}">{{.}}</option>--\x3e\n\t\t\t\t\x3c!--{{/each}}--\x3e\n\t\t\t\x3c!--</select>--\x3e\n\t\t\x3c!--</div>--\x3e\n\t\t<div id="mpce-sections-wrapper">\n\t\t\t<div id="mpce-library-sections">\n\t\t\t\t<p>Sections</p>\t\t\t\t\n\t\t\t\t{{#rows.length}}\n\t\t\t\t\t<ul class="mpce-sections-list mpce-library-rows-list">\n\t\t\t\t\t\t{{#each rows}}\n\t\t\t\t\t\t\t<li class="mpce-section-item-wrapper mpce-section-id-{{@index}}">\n\t\t\t\t\t\t\t\t<div class="mpce-section-item mpce-row-item" data-section-template-id="{{@index}}" data-section-category-id="{{category}}" \n\t\t\t\t\t\t\t\t\tdata-section-title="{{name}}">\n\t\t\t\t\t\t\t\t<span class="mpce-section-icon" style="background-image: url(\'{{icon}}\');"></span>\n\t\t\t\t\t\t\t\t\t<span class="mpce-section-name motopress-default motopress-no-color-text">{{name}}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t</ul>\n\t\t\t\t{{/rows.length}}\n\t\t\t\t{{^rows.length}}\n\t\t\t\t\t<p><em>{{translations.noTemplate}}</em></p>\n\t\t\t\t{{/rows.length}}\n\t\t\t\t<p>Pages</p>\n\t\t\t\t{{#pages.length}}\n\t\t\t\t<ul class="mpce-sections-list mpce-library-pages-list">\n\t\t\t\t\t{{#each pages}}\n\t\t\t\t\t\t<li class="mpce-section-item-wrapper mpce-section-id-{{@index}}">\n\t\t\t\t\t\t\t<div class="mpce-section-item mpce-page-item" data-section-template-id="{{@index}}" data-section-category-id="{{category}}" \n\t\t\t\t\t\t\t\tdata-section-title="{{name}}">\n\t\t\t\t\t\t\t<span class="mpce-section-icon"><i class="fa fa-file-o fa-lg"></i></span>\n\t\t\t\t\t\t\t\t<span class="mpce-section-name motopress-default motopress-no-color-text">{{name}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t{{/each}}\n\t\t\t\t</ul>\n\t\t\t\t{{/pages.length}}\n\t\t\t\t{{^pages.length}}\n\t\t\t\t\t<p><em>{{translations.noTemplate}}</em></p>\n\t\t\t\t{{/pages.length}}\n\t\t\t</div>\n\t\t</div>\n\t</div>');
(function(d){CE.PageSettingsEvents={};CE.PageSettingsEvents.Event=parent.CE.EventDispatcher.Event.extend({},{});CE.PageSettingsEvents.SettingsEvent=CE.PageSettingsEvents.Event.extend({},{init:function(a,b,c){this.attr=a;this.newVal=b;this.oldVal=c},getAttr:function(){return this.attr}})})(jQuery);CE.PageSettingsEvents.SettingsChanged=CE.PageSettingsEvents.SettingsEvent.extend({NAME:"page_settings.settings.changed"},{});can.view.stache("pageDialogSettings","<page-settings>\n\n\t<div class=\"\">\t\n\t\t<div>\t\n\t\t\t<label class='motopress-property-label' for='mpce-page-settings-title'>\n\t\t\t\t{{translations.title}}\n\t\t\t</label>\n\t\t\t<input class='motopress-property-input' type='text' value='{{Settings.title}}' id='mpce-page-settings-title'  \n\t\t\tplaceholder='Title' ($blur)='updateTitle($element.val)'  ($change)='updateTitle($element.val)' />\n\t\t\t<hr/>\n\t\t</div>\n\t\t<div>\n\t\t\t<input type='checkbox' class=\"motopress-property-checkbox-input motopress-property-input\"  id='mpce-page-settings-hide-title' \n\t\t\t\t($change)='updateTitleVisibility' {{#if Settings.hideTitle}}checked{{/if}} />\n\t\t\t<label class=\"motopress-property-label motopress-property-checkbox-label\" for='mpce-page-settings-hide-title'> \n\t\t\t\t{{translations.hideTitle}}\n\t\t\t</label>\n\t\t\t<hr/>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class='motopress-property-label' for='mpce-page-settings-template'>\n\t\t\t\t{{translations.template}} \n\t\t\t</label>\n\t\t\t<select ($change)='updateTemplate' id='mpce-page-settings-template' class=\"motopress-property-select motopress-bootstrap-dropdown motopress-dropdown-select\">\n\t\t\t\t{{#each displayTemplateList}}\n\t\t\t\t\t<option value='{{value}}' {{#is value Settings.template }}selected{{/is}}>{{name}}</option>\n\t\t\t\t{{/each}}\n\t\t\t</select>\n\t\t\t<hr/>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class='motopress-property-label' for='mpce-page-settings-status'>\n\t\t\t\t{{translations.status}}\n\t\t\t</label>\n\t\t\t<select ($change)='updateStatus' id='mpce-page-settings-status' class=\"motopress-property-select motopress-bootstrap-dropdown motopress-dropdown-select\">\n\t\t\t\t{{#each displayStatusList}}\n\t\t\t\t<option value='{{@key}}' {{#is @key Settings.status }}selected{{/is}}>{{.}}</option>\n\t\t\t\t{{/each}}\n\t\t\t</select>\n\t\t</div>\t\t\t\t\t\t\n\t</div>\n\n</page-settings>\n");
(function(d){var a,b;can.Component.extend({tag:"page-settings",viewModel:{Settings:CE.Settings.Page,init:function(){CE.Iframe.runAndSetAsDependent(this.proxy(function(c){a=c.$("h1.entry-title");b=c.$(".mpce-post-div")}))},displayTemplateList:function(){return motopressCE.postData.templateList},displayStatusList:function(){return motopressCE.postData.statusList},updateTitle:function(a){a=d.trim(a);this.Settings.attr("title",a)},updateTitleVisibility:function(a,b,d){this.Settings.attr("hideTitle",b.is(":checked")?
1:0)},updateTemplate:function(a,b,d){this.Settings.attr("template",b.val())},updateStatus:function(a,b,d){this.Settings.attr("status",b.val())}},events:{"{Settings} change":function(c,d,f,g,h,k){c=can.Deferred();switch(f){case "title":a.html(h);c.resolve();break;case "hideTitle":h?b.addClass("mpce-hide-post-title"):b.removeClass("mpce-hide-post-title");c.resolve();break;case "template":MP.Preloader.myThis.reopen();MP.Preloader.myThis.show();CE.Save.saveAJAX().success(function(a){MP.Editor.myThis.reloadScene(a.data.iframe_nonce)}).error(function(){MP.Preloader.myThis.hide()});
c.reject();break;case "status":c.resolve()}c.done(function(){CE.EventDispatcher.Dispatcher.dispatch(CE.PageSettingsEvents.SettingsChanged.NAME,new CE.PageSettingsEvents.SettingsChanged(f,h,k))})}}})})(jQuery);can.view.stache("pageDialogDesign","<page-design><b>page-design</b></page-design>");(function(d){can.Component.extend({tag:"page-design",viewModel:{init:function(){this._foo()},_foo:function(){}},events:{}})})(jQuery);can.view.stache("pageDialogTabs",'<div class="motopress-dialog-tabs" id="mpce-page-dialog-tabs"><ul>{{#each tabs}}<li><a href="#{{id}}" class="motopress-text-no-color-text">{{title}}<i class="{{icon_class}}"></i></a></li>{{/each}}</ul>{{#each tabs}}<div id="{{id}}">{{content}}</div>{{/each}}</div>');
(function(d){CE.Panels.AbstractDialog.extend("CE.Panels.PageDialog",{myThis:null,NAME:"page"},{setup:function(a,b){this._super(a,b);this.buildDialogElement()},init:function(a,b){this._super(a,b);this.constructor.myThis=this;this.initDialog();this.initTabs()},buildDialogElement:function(){var a=new can.Map({tabs:[{id:"mpce-page-dialog-settings-tab",title:"Settings",icon_class:"motopress-settings-icon",content:can.view("pageDialogSettings",{translations:{title:"Title",hideTitle:"Hide Title",template:"Template",
status:"Status"}})}]});this.element.append(can.view("pageDialogTabs",a));this.element.find(".motopress-property-select").selectpicker({size:6})},initDialog:function(){this.element.dialog({autoOpen:!1,resizable:!1,dialogClass:"motopress-dialog",title:"Page Settings",width:332,height:400,open:this.proxy(function(){})})},initTabs:function(){this.element.find("#mpce-page-dialog-tabs").tabs({})},open:function(){this._super()},close:function(){this.element.dialog("close")}})})(jQuery);CE.LocalRevision=
{};(function(d){CE.LocalRevision.Events={};CE.LocalRevision.Events.RevisionPicked=CE.EventDispatcher.Event.extend({NAME:"local_revision.revision.picked"},{revision:null,silent:null,init:function(a,b){this.revision=a;this.silent=b},getRevision:function(){return this.revision},getSilent:function(){return this.silent}})})(jQuery);(function(d){can.Map.extend("CE.LocalRevision.Item",{},{selected:!1,type:null,event:null,snapshot:null,entity:null,action:null,prop:null,init:function(a,b){if(!(a instanceof
IframeCE.SceneEvents.Event))throw Error();this.event=a;this.snapshot=b;this.attr("selected",!1);this.detectType();this.initData()},detectType:function(){switch(this.event.getEventName()){case IframeCE.SceneEvents.sceneInited.NAME:this.attr("type","scene_init");break;case IframeCE.SceneEvents.StylePresetChanged.NAME:this.attr("type","preset_change");break;default:this.attr("type","entity_change")}},initData:function(){this.attr("action",b(this.event.getEventName()));switch(this.type){case "preset_change":this.prop=
null;this.attr("prop",this.event.getPresetLabel());break;case "entity_change":this.attr("entity",a(this.event.getEntityName())),this.prop=null,can.isFunction(this.event.getPropName)&&this.attr("prop",this.event.getPropName())}},getEvent:function(){return this.event},getSnapshot:function(){return this.snapshot},setSnapshot:function(a){this.snapshot=a},isType:function(a){return this.type===a},isSelected:function(){return this.selected}});var a=function(a){return can.capitalize(a)},b=function(a){var b=
IframeCE.SceneEvents;switch(a){case b.sceneInited.NAME:return"Editing Started";case b.EntityCreated.NAME:return"Created";case b.EntityDeleted.NAME:return"Deleted";case b.EntityDuplicated.NAME:return"Duplicated";case b.EntityMoved.NAME:return"Moved";case b.EntityResized.NAME:return"Resized";case b.EntitySettingsChanged.NAME:case b.EntityStylesChanged.NAME:return"Edited";case b.StylePresetChanged.NAME:return"Preset Edited";default:return""}}})(jQuery);(function(d){CE.LocalRevision.Manager=can.Construct({_instance:null,
getInstance:function(){null===this._instance&&(this._instance=new CE.LocalRevision.Manager);return this._instance}},{revisions:null,current:null,init:function(){this.revisions=new can.List},getList:function(){return this.revisions},getByIndex:function(a){return this.revisions.attr(a)},undo:function(){this.move(1)},redo:function(){this.move(-1)},move:function(a){var b=this.indexOf(this.current);(a=this.revisions.attr(b+a))&&this.pick(a)},isOldest:function(){return this.indexOf(this.current)===this.revisions.length-
1},isLatest:function(){return 0===this.indexOf(this.current)},pick:function(a,b){void 0===b&&(b=!1);if(a.isSelected())return!1;this.current&&this.current.attr("selected",!1);a.attr("selected",!0);this.current=a;b||this.sceneManager.applySnapshot(a.getSnapshot());CE.EventDispatcher.Dispatcher.dispatch(CE.LocalRevision.Events.RevisionPicked.NAME,new CE.LocalRevision.Events.RevisionPicked(a,b));return!0},isPicked:function(a){return this.current==a},indexOf:function(a){return this.revisions.indexOf(a)},
push:function(a){if(this.current){var b=this.indexOf(this.current);0!==b&&this.revisions.splice(0,b)}this.revisions.unshift(a)},createItem:function(a){return new CE.LocalRevision.Item(a,this.sceneManager.takeSnapshot())},onContentChange:function(a){this.push(this.createItem(a))}});CE.EventDispatcher.Subscriber.extend({},{cb:null,init:function(a){this.cb=a},getSubscribedEvents:function(){var a=IframeCE.SceneEvents;return[[[a.EntityCreated.NAME,a.EntityDeleted.NAME,a.EntityDuplicated.NAME,a.EntityResized.NAME,
a.EntityMoved.NAME,a.EntitySettingsChanged.NAME,a.EntityStylesChanged.NAME,a.StylePresetDeleted.NAME,a.StylePresetRenamed.NAME,a.StylePresetCreated.NAME,a.StylePresetChanged.NAME],this.cb]]}})})(jQuery);can.view.stache("localRevisionList","<local-revision-list><button class='motopress-btn-default' ($click)='move(\"undo\")' {{^if buttons.undo}}disabled='disabled'{{/if}}>&lsh; Undo</button>&nbsp;<button class='motopress-btn-default' ($click)='move(\"redo\")' {{^if buttons.redo}}disabled='disabled'{{/if}}>&rsh; Redo</button><ul class='mpce-revision-list'>{{#each displayList}}<li ($click)='apply(., @element, @event, @index)' class='mpce-revision-item {{#if selected}}selected{{/if}}'>{{#if isType('scene_init')}}<b>{{action}}</b>{{/else}}{{#if isType('preset_change')}}{{#if prop}}{{prop}}&nbsp;{{/if}}<i>{{action}}</i>&nbsp;{{/else}}<b>{{entity}}</b>&nbsp;{{#if prop}}{{prop}}&nbsp;{{/if}}<i>{{action}}</i>&nbsp;{{/if}}{{/if}}</li>{{/each}}</ul></local-revision-list>");
(function(d){var a;CE.LocalRevision.SceneManager=can.Construct({},{$sceneContent:null,$container:null,$stylesWrapper:null,$currentContent:null,$originalStyles:null,controlsSelector:null,init:function(){CE.Iframe.runAndSetAsDependent(this.proxy(function(b){a=CE.Iframe.$;this.$sceneContent=a(CE.Iframe.myThis.sceneContent);this.$container=this.$sceneContent.parent();this.$stylesWrapper=IframeCE.ShortcodePrivateStyle.stylesWrapper}))},takeSnapshot:function(){CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.SnapshotTakenBefore.NAME,
new IframeCE.SceneEvents.SnapshotTakenBefore);return{content:this.cloneContent(this.$sceneContent.children()),styles:{privates:IframeCE.StyleEditor.myThis.clonePrivateStyles()}}},applySnapshot:function(a){var c={content:null,styles:null};this.$sceneContent.children().detach();c.content=this.cloneContent(a.content);c.styles={privates:IframeCE.StyleEditor.myThis.clonePrivateStyles(a.styles.privates)};var d=this.$sceneContent.append(c.content);IframeCE.StyleEditor.myThis.applyPrivateStyles(c.styles.privates);
this.eachContentClone(d,this.proxy(function(a){this.eachElementControls(a,function(b){can.isFunction(b.restoreClone)&&b.restoreClone(a)})}),this.proxy(function(a){can.isFunction(a.restoreClone)&&a.restoreClone(d)}));CE.EventDispatcher.Dispatcher.dispatch(IframeCE.SceneEvents.SnapshotApplied.NAME,new IframeCE.SceneEvents.SnapshotApplied(c))},cloneContent:function(b){var c=b.clone(!0,!0);this.eachContentClone(c,this.proxy(function(b){var c=[];this.eachElementControls(b,function(a){can.isFunction(a.clone)?
c.push(a.clone(b)):c.push(a)});a.removeData(b,"controls");b.data("controls",c)}),this.proxy(function(a){can.isFunction(a.clone)&&a.clone(c)}));return c},eachElementControls:function(a,c){for(var d=a.controls(),f=0;f<d.length;f++)c(d[f])},eachContentClone:function(b,c,e){var f=this.getControlsSelector();b.find(f).addBack().each(function(){c(a(this))});d.each([IframeCE.Resizer.myThis],function(){e(this)})},getControlsSelector:function(){null===this.controlsSelector&&(this.controlsSelector="."+d.map([IframeCE.Controls,
IframeCE.DroppableZone,IframeCE.Panels.WidgetHelper,IframeCE.Panels.RowHelper,IframeCE.Panels.AddSectionPanel],function(a){return a._fullName}).join(",."));return this.controlsSelector}})})(jQuery);(function(d){var a;can.Component.extend({tag:"local-revision-list",viewModel:{revisions:void 0,selected:null,buttons:{undo:!1,redo:!1},init:function(){a=CE.LocalRevision.Manager.getInstance();this.revisions=a.getList();this._initialize();this._registerRevisionEvents();this._registerKeypressEvents()},displayList:function(){return this.revisions},
apply:function(a,c,d,f){this.select(a)},move:function(b){switch(b){case "undo":a.undo();break;case "redo":a.redo()}},updateButtonsState:function(){this.attr("buttons.undo",!a.isOldest());this.attr("buttons.redo",!a.isLatest())},select:function(b,c){a.pick(b,c)&&this.attr("selected",b)},_initialize:function(){var b=a.getByIndex(0);b&&!a.isPicked(b)&&this.select(b,!0)},_registerRevisionEvents:function(){CE.EventDispatcher.Dispatcher.addListener(CE.LocalRevision.Events.RevisionPicked.NAME,this.proxy(this.updateButtonsState))},
_registerKeypressEvents:function(){d(document).keydown(this.proxy(function(b){90===b.which&&b.ctrlKey&&b.shiftKey?a.redo():90===b.which&&b.ctrlKey&&a.undo()}))}},events:{"{revisions} add":function(a,c,d){d.forEach(this.proxy(function(a){this.viewModel.select(a,!0)}))}}})})(jQuery);CE.WPRevision={};CE.WPRevision.Events={};CE.WPRevision.Events.RevisionPicked=CE.EventDispatcher.Event.extend({NAME:"wp_revision.revision.picked"},{});can.view.stache("wpRevisionList","<wp-revision-list><button class='motopress-btn-default' ($click)='discard' id='mpce-revision-discard' disabled>Discard</button>&nbsp;<button class='motopress-btn-blue' ($click)='apply' id='mpce-revision-apply' disabled>Apply</button><ul class='mpce-revision-list'>{{#each displayList}}<li ($click)='preview' class='mpce-revision-item'><button ($click)='remove(., @element, @event, @index)' class='mpce-revision-delete motopress-btn-default'>x</button><b>{{date}}</b><br/><i>{{type}} by {{author}}</i></li>{{/each}}</ul></wp-revision-list>");
(function(d){var a;CE.WPRevision.SceneManager=can.Construct({},{$sceneContent:null,$container:null,$currentContent:null,$originalStyles:null,init:function(){CE.Iframe.runAndSetAsDependent(this.proxy(function(b){a=CE.Iframe.$;this.$sceneContent=a(CE.Iframe.myThis.sceneContent);this.$container=this.$sceneContent.parent()}))},requestRevision:function(a,c){void 0===c&&(c="raw");return d.ajax({type:"post",dataType:"json",url:motopress.ajaxUrl,data:{action:"motopress_ce_get_revision_data",nonce:motopressCE.nonces.motopress_ce_get_revision_data,
id:a,content_type:c},success:function(a){},error:function(a){MP.Flash.setFlash(a.responseJSON.message,"error");MP.Flash.showMessage()}})},requestDeleteRevision:function(a){return d.ajax({type:"post",dataType:"json",url:motopress.ajaxUrl,data:{action:"motopress_ce_delete_revision",nonce:motopressCE.nonces.motopress_ce_delete_revision,id:a},success:function(a){},error:function(a){MP.Flash.setFlash(a.responseJSON.message,"error");MP.Flash.showMessage()}})},setPreview:function(b){this.hideOriginalContent();
this.removeOriginalStyles();this.removePreview();b.styles&&a("body").append(a(b.styles));this.$container.append(b.content)},removePreview:function(){a(".motopress-content-wrapper-preview").remove();a(".motopress-ce-private-styles-wrapper-preview").remove()},hideOriginalContent:function(){this.$sceneContent.hide()},showOriginalContent:function(){this.$sceneContent.show()},removeOriginalStyles:function(){null===this.$originalStyles&&(this.$originalStyles=IframeCE.ShortcodePrivateStyle.stylesWrapper.children().detach())},
returnOriginalStyles:function(){IframeCE.ShortcodePrivateStyle.stylesWrapper.append(this.$originalStyles);this.resetOriginalStyles()},resetOriginalStyles:function(){this.$originalStyles=null},removeOriginalContent:function(){IframeCE.Scene.myThis.removeContent();this.resetOriginalStyles()},insertOriginalContent:function(b){this.removeOriginalContent();IframeCE.ShortcodePrivateStyle.addRenderedStyleTags(a(b.other_styles).filter("style"));IframeCE.StyleEditor.myThis.initPrivateStyles(b.post_styles);
b.content&&IframeCE.Scene.myThis.insertContent(b.content);CE.EventDispatcher.Dispatcher.dispatch(CE.WPRevision.Events.RevisionPicked.NAME,new CE.WPRevision.Events.RevisionPicked);CE.Save.changeContent()}})})(jQuery);(function(d){can.Component.extend({tag:"wp-revision-list",viewModel:{revisions:new can.List(motopressCE.revisions),sceneManager:null,saveManager:null,selectedItem:null,$selectedEl:null,init:function(){this.sceneManager=new CE.WPRevision.SceneManager;this.saveManager=CE.Save;MP.Editor.on("AfterUpdate",
this.proxy("onContentSaved"))},onContentSaved:function(a,b){b.last_revision&&this._addRevisionItem(b.last_revision);d.isArray(b.revisions_ids)&&this.revisions.replace(this.revisions.filter(function(a){return-1!==b.revisions_ids.indexOf(a.id)}))},displayList:function(){return this.revisions},preview:function(a,b,c){this._isSelectedByElement(b)||(c=this.sceneManager.requestRevision(a.id,"raw"),c.success(this.proxy(function(c){this.sceneManager.setPreview(c.data);this._select(a,b);this._enableControls()})),
c.error(this.proxy(function(a){})),c.complete(this.proxy(function(a){})))},apply:function(a,b,c){CE.Saving.save()},discard:function(a,b,c){this._discard();this._resetSelected()},remove:function(a,b,c,d){c.stopPropagation();confirm("Are you sure ?")&&this.sceneManager.requestDeleteRevision(a.id).success(this.proxy(function(){this._isSelectedByItem(a)&&(this._discard(),this._resetSelected());this._deleteRevisionItem(d)}))},_enableControls:function(){d("#mpce-revision-apply").removeAttr("disabled");
d("#mpce-revision-discard").removeAttr("disabled")},_disableControls:function(){d("#mpce-revision-apply").attr("disabled","");d("#mpce-revision-discard").attr("disabled","")},_discard:function(){this.sceneManager.removePreview();this.sceneManager.returnOriginalStyles();this.sceneManager.showOriginalContent()},_resetSelected:function(){this._disableControls();null!==this.$selectedEl&&this.$selectedEl.removeClass("selected");this.$selectedEl=this.selectedItem=null},_isSelectedByElement:function(a){return a.hasClass("selected")},
_isSelectedByItem:function(a){return!(!this.selectedItem||this.selectedItem.id!==a.id)},_select:function(a,b){null!==this.$selectedEl&&this.$selectedEl.removeClass("selected");this.selectedItem=a;this.$selectedEl=b;b.addClass("selected")},_isPreview:function(){return null!==this.selectedItem},_addRevisionItem:function(a){var b=!0;this.revisions.forEach(function(c){c.id===a.id&&(b=!1)});b&&this.revisions.unshift(a)},_deleteRevisionItem:function(a){this.revisions.splice(a,1)},_save:function(){var a=
this.selectedItem.id;IframeCE.SceneState.isContentChanged()?this.saveManager.saveAJAX().success(this.proxy(this._applyRevision,a)):this._applyRevision(a);this._resetSelected()},_applyRevision:function(a){a=this.sceneManager.requestRevision(a,"editor");a.success(this.proxy(function(a){this.sceneManager.removePreview();this.sceneManager.resetOriginalStyles();this.sceneManager.insertOriginalContent(a.data);this.sceneManager.showOriginalContent();this.saveManager.saveAJAX()}));a.error(this.proxy(function(a){}));
a.complete(this.proxy(function(a){}));return a}},events:{inserted:function(){var a=this.viewModel;MP.Editor.triggerIfr("WPRevision.Init",{control:{save:a.proxy("_save"),isPreview:a.proxy("_isPreview")}})}}})})(jQuery);can.view.stache("historyDialogTabs",'<div class="motopress-dialog-tabs" id="mpce-history-dialog-tabs"><ul>{{#each tabs}}<li><a href="#{{id}}" class="motopress-text-no-color-text">{{title}}<i class="{{icon_class}}"></i></a></li>{{/each}}</ul>{{#each tabs}}<div id="{{id}}"></div>{{/each}}</div>');
(function(d){CE.Panels.AbstractDialog.extend("CE.Panels.HistoryDialog",{myThis:null,NAME:"history"},{dialog:null,wpRevisionsRenderer:can.view("wpRevisionList"),localRevisionsRenderer:can.view("localRevisionList"),tabsRenderer:can.view("historyDialogTabs"),tabsViewData:new can.Map({tabs:[{id:"mpce-history-dialog-wp-tab",title:"Revisions",icon_class:""}]}),setup:function(a,b){this._super(a,b);this.buildDialogElement()},init:function(a,b){this._super(a,b);this.constructor.myThis=this;this.initDialog();
this.initTabs()},buildDialogElement:function(){this.element.append(this.tabsRenderer(this.tabsViewData));this.element.find("#mpce-history-dialog-local-tab").html(this.localRevisionsRenderer());this.element.find("#mpce-history-dialog-wp-tab").html(this.wpRevisionsRenderer());this.element.appendTo("body")},initDialog:function(){this.element.dialog({position:{my:"left top",at:"left+10 top+50",of:window.top},autoOpen:!1,closeOnEscape:!0,closeText:"",title:"History",dialogClass:"motopress-dialog",draggable:!0,
modal:!1,resizable:!0,width:332,height:400,create:this.proxy(function(a){}),close:function(a){},beforeClose:function(a,b){},open:function(a){}})},initTabs:function(){this.element.find("#mpce-history-dialog-tabs").tabs({})}})})(jQuery);(function(d){d.hasOwnProperty("fn")&&d.fn.hasOwnProperty("button")&&d.fn.button.hasOwnProperty("noConflict")&&(d.fn.btn=d.fn.button.noConflict());new MP.Editor})(jQuery)})()}catch(v){MP.Error.log(v)}};
